function getData(a,b,c){$.ajax({url:b.url,data:{id:b.id,idHabitacion:b.idHabitacion,idEstablecimiento:b.idEstablecimiento},dataType:"json",success:function(b){$(a).html(""),c(a,b)}})}function CurrencySettings(a,b,c,d){this.defaultCurrency=a,this.currentCurrency=b,this.conversionRate=c,this.rates=d}function getAgent(){var a,b=navigator.userAgent,c=b.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(c[1])?(a=/\brv[ :]+(\d+)/g.exec(b)||[],["IE",a[1]||""]):"Chrome"===c[1]&&(a=b.match(/\bOPR\/(\d+)/),null!==a)?["Opera",a[1]]:(c=c[2]?[c[1],c[2]]:[navigator.appName,navigator.appVersion,"-?"],null!==(a=b.match(/version\/(\d+(\.\d{1,2}))/i))&&c.splice(1,1,a[1]),c)}function addEvent(a,b,c,d){d=d||a;var e;a.addEventListener?(e=function(a){c.call(d,a)},a.addEventListener(b,e,!1)):a.attachEvent&&(e=function(){var a=window.event;a.preventDefault=function(){window.event.returnValue=!1},c.call(d,a)},a.attachEvent("on"+b,e)),eventCache.push([a,b,c,e])}function removeEvent(a,b,c){var d,e,f;for(f=0;f<eventCache.length;f++)e=eventCache[f],e[0]==a&&e[1]==b&&e[2]==c&&(d=e[3],d&&(a.removeEventListener?a.removeEventListener(b,d,!1):a.detachEvent&&a.detachEvent("on"+b,d)))}!function(a){"use strict";angular.module("tmh.dynamicLocale",[]).provider("tmhDynamicLocale",function(){function a(a,b,c){var d=document.createElement("script"),e=document.getElementsByTagName("body")[0];d.type="text/javascript",d.readyState?d.onreadystatechange=function(){("complete"===d.readyState||"loaded"===d.readyState)&&(d.onreadystatechange=null,c(b,30,!1))}:d.onload=function(){b()},d.src=a,d.async=!1,e.appendChild(d)}function b(b,c,f,g,j,k,l){function m(a,b){e===f&&(angular.forEach(a,function(c,d){b[d]?angular.isArray(b[d])&&(a[d].length=b[d].length):delete a[d]}),angular.forEach(b,function(c,d){angular.isArray(b[d])||angular.isObject(b[d])?(a[d]||(a[d]=angular.isArray(b[d])?[]:{}),m(a[d],b[d])):a[d]=b[d]}))}if(i[f])return i[f];var n,o=j.defer();return f===e?o.resolve(c):(n=k.get(f))?(e=f,g.$evalAsync(function(){m(c,n),g.$broadcast("$localeChangeSuccess",f,c),d.put(h,f),o.resolve(c)})):(e=f,i[f]=o.promise,a(b,function(){var a=angular.injector(["ngLocale"]),b=a.get("$locale");m(c,b),k.put(f,b),delete i[f],g.$apply(function(){g.$broadcast("$localeChangeSuccess",f,c),d.put(h,f),o.resolve(c)})},l)),o.promise}var c,d,e,f="angular/i18n/angular-locale_{{locale}}.js",g="tmhDynamicLocaleStorageCache",h="tmhDynamicLocale.locale",i={};this.localeLocationPattern=function(a){return a?(f=a,this):f},this.useStorage=function(a){g=a},this.useCookieStorage=function(){this.useStorage("$cookieStore")},this.defaultLocale=function(a){c=a},this.$get=["$rootScope","$injector","$interpolate","$locale","$q","tmhDynamicLocaleCache","$timeout",function(a,e,i,j,k,l,m){var n=i(f);return d=e.get(g),a.$evalAsync(function(){var e;(e=d.get(h)||c)&&b(n({locale:e}),j,e,a,k,l,m)}),{set:function(c){return b(n({locale:c}),j,c,a,k,l,m)}}}]}).provider("tmhDynamicLocaleCache",function(){this.$get=["$cacheFactory",function(a){return a("tmh.dynamicLocales")}]}).provider("tmhDynamicLocaleStorageCache",function(){this.$get=["$cacheFactory",function(a){return a("tmh.dynamicLocales.store")}]}).run(["tmhDynamicLocale",angular.noop])}(window);var graphMaker=function(a){if(!a.wrapper||!a.values)return!1;var b=new google.visualization.DataTable;b.addColumn("string",a.values[0][0]),b.addColumn("number",a.values[0][1]),b.addColumn({type:"string",role:"tooltip"}),b.addColumn({type:"string",role:"style"}),b.addColumn({type:"string",role:"class"}),b.addRows(a.values.slice(1,a.values.length));var c,d,e={animation:{duration:1e3,easing:"easyOut"},bar:{groupWidth:"75%"},hAxis:{baselineColor:"#dcdcdc",format:"#",gridlines:{color:"#E4E4E4",count:5},textStyle:{color:"#565656",fontSize:10}},chartArea:{width:"85%",height:"80%"},vAxis:{baselineColor:"#dcdcdc",format:"#"+a.coin,gridlines:{color:"#E4E4E4",count:5},textStyle:{color:"#565656",fontSize:12}},colors:["green","green"],legend:{position:"none"}},f={tooltip:{trigger:"selection"},animation:{duration:1e3,easing:"easyOut"},bar:{groupWidth:"75%"},hAxis:{baselineColor:"#dcdcdc",format:"#",gridlines:{color:"#E4E4E4",count:5},textStyle:{color:"#565656",fontSize:6}},chartArea:{width:"85%",height:"80%"},vAxis:{baselineColor:"#dcdcdc",format:"#"+a.coin,gridlines:{color:"#E4E4E4",count:5},textStyle:{color:"#565656",fontSize:10}},colors:["green","green"],legend:{position:"none"}};a.maxValue&&(e.vAxis.maxValue=a.maxValue),a.minValue&&(e.vAxis.minValue=a.minValue);var g=function(){d?d.clearChart():void 0,500>c?h():i()},h=function(){$(a.wrapper).height(600),d=new google.visualization.BarChart(a.wrapper),d.draw(b,f)},i=function(){$(a.wrapper).height(200),d=new google.visualization.ColumnChart(a.wrapper),d.draw(b,e)},j=function(){d.clearChart(),c=void 0},k=function(){var b=$(a.wrapper).width();c!==b&&(c=b,g())};return{init:function(){function a(a){var c=d.getSelection()[0],e=b.getDistinctValues(4),f=e[c.row],g={};g.actionType="getAvailabilityChart",g.startDate=f;var h=angular.element("#ng-app").scope();h.$apply(function(){h.externalData=g})}k(),$("window").on("resize",function(a){k()}),google.visualization.events.addListener(d,"select",a)},clear:function(){j()}}},witPlotter=function(a){var b=a.current,c=(a.wrapper,$('<span class="text"></span>').appendTo(a.wrapper)),d=$("<div></div>").appendTo(a.wrapper)[0],e=c.parents(".chartContainer").find(".prevMonth"),f=c.parents(".chartContainer").find(".nextMonth"),g=c.parents(".chartContainer").find(".textMonth");e.show(),f.show();var h=function(a){g.html(a)},i=function(){e.show()},j=function(){f.show()},k=function(){e.hide()},l=function(){f.hide()},m=function(){a.data[b].graph.clear()},n=function(){a.data[b].graph||(a.data[b].graph=graphMaker({wrapper:d,values:a.data[b].values,maxValue:a.data[b].maxValue,minValue:a.data[b].minValue,coin:a.data[b].coin})),a.data[b].graph.init(),0===b?k():1===b?i():b===a.data.length-2?j():b===a.data.length-1&&l(),h(a.data[b].date.monthname+" "+a.data[b].date.year)},o=function(){b!==b.length-1&&(m(),b+=1,n())},p=function(){0!==b&&(m(),b-=1,n())};return e.on("click",p),f.on("click",o),n(),{getCurrent:function(){return b},getData:function(){return a.data},showCurrent:n,showNext:o,showPrevious:p}},Constants={};Constants.mealPlan={},Constants.mealPlan.breakfast={ticker:"HD",name:"With breakfast"},Constants.messages={type:{},position:{}},Constants.messages.type.success="SUCCESS",Constants.messages.type.notice="NOTICE",Constants.messages.type.info="INFO",Constants.messages.type.error="ERROR",Constants.messages.position.top_inventory_step_1="TOP_INVENTORY_STEP_1",Constants.messages.position.below_logo_step_1="BELOW_LOGO_STEP_1",Constants.messages.position.below_personal_info_step_2="BELOW_PERSONAL_INFO_STEP_2",Constants.messages.position.top_method_payment_step_2="TOP_METHOD_PAYMENT_STEP_2",Constants.messages.position.modal_step_1="MODAL_STEP_1",Constants.messages.position.modal_step_2="MODAL_STEP_2",Constants.markups={phase:{},position:{}},Constants.markups.phase.step1="STEP1",Constants.markups.phase.step2="STEP2",Constants.markups.phase.step3="STEP3",Constants.markups.phase.all="ALL",Constants.markups.position.afterbeginbody="FIRST_BODY",Constants.markups.position.beforeendbody="END_BODY",Constants.markups.position.beforeendhead="HEAD",Constants.panel={},Constants.panel.type={carousel:"carousel",description:"description",map:"map",discounts:"discounts",conditions:"conditions",chart:"chart"},Constants.assetsDir=ASSETS_DIR,Constants.imgDir="/WitBooker/img/",Constants.translationURL="/WitBooker/img/",Constants.dateFormat="dd-MM-yyyy",Constants.datePickerFormat="dd-mm-yyyy",Constants.cart={smallSize:"SMALL",largeSize:"LARGE"},Constants.serviceType={room:"ROOM",person:"PERSON",units:"UNIT"},Constants.popover={discount:{background:"ad0303"},reservationButton:{background:"000000"}},Constants.localeFilesDir="/WitBooker/i18n/",Constants.filters={minStay:"minStay",minNotice:"minNotice",maxNotice:"maxNotice",maxStay:"maxStay",closed:"closed",visible:"visible",occupationType:"occupationType",checkInCheckOut:"checkInCheckOut",checkIn:"checkIn",checkOut:"checkOut",validity:"validity",availability:"availability",reservationClosed:"reservationClosed",filterPrefix:"filterBy",restricted:"restricted"},Constants.occupant={restriction:{TAKE_ADULT_TEENAGER_CHILD:"TAKE_ADULT_TEENAGER_CHILD",TAKE_ADULT_TEENAGER_CHILD_BABY:"TAKE_ADULT_TEENAGER_CHILD_BABY",TAKE_SENIOR_ADULT_TEENAGER_CHILD_BABY:"TAKE_SENIOR_ADULT_TEENAGER_CHILD_BABY",TAKE_ADULT_CHILD_BABY:"TAKE_ADULT_CHILD_BABY",TAKE_ADULT_CHILD:"TAKE_ADULT_CHILD",TAKE_ALL_PEOPLE:"TAKE_ALL_PEOPLE",NONE:"NONE"}},Constants.payment={type:{creditCard:"tcgarantia",tctoken:"tctoken",tpvtoken:"tpvtoken",transfer:"tr",pointOfSale:"tpv",creditCardOrTransfer:"TC_TR",paypal_ec:"paypal_ec",paypal_std:"paypal_std"},sipay:{timeoutInterval:300}};var Events={};Events.UPDATE_AVAILABILITY="update_availability",Events.QUERY_AVAILABILITY="query_availability",Events.ADDED_TO_CART="added_to_cart",Events.UPDATE_INVENTORIES_BY_CART="done_added_to_cart",Events.CHANGE_LANGUAGE="change_language",Events.CHANGE_LANGUAGE_DONE="change_language_done",Events.REMOVED_FROM_CART="removed_from_cart",Events.GO_TO_STEP1="go_to_step1",Events.TRANSITION_TO_STEP2="transition_to_step2",Events.UPDATE_SERVICE_RATE="update_service_rate",Events.SUBMIT_PAYMENT_DATA_FORM="submit_payment_data_form",Events.RESERVATION_DATA_UPDATE="reservation_data_update",Events.UPDATE_SERVICE_QUANTITY="update_service_quantity",Events.UPDATE_SERVICE_SELECTION="update_service_selection",Events.CHANGE_CURRENCY="change_currency",angular.module("witbooker",["ui.router","ui.bootstrap","ngSanitize","pascalprecht.translate","tmh.dynamicLocale","witbooker.filters","witbooker.directives","witbooker.controllers","witbookerServices","paymentServices","ngCacheBuster","angular-md5"]).constant("constants",Constants).constant("events",Events).config(["$stateProvider","$urlRouterProvider","constants",function(a,b,c){a.state("stepOne",{url:"/stepOne",templateUrl:c.assetsDir+"partials/step_one.html",controller:"StepOne"}).state("stepOne.list",{url:"/list?allreservationsinvalid&error",templateUrl:c.assetsDir+"partials/step_one/stepOne.list.html"}).state("stepOne.map",{url:"/map",templateUrl:c.assetsDir+"partials/step_one/stepOne.map.html"}).state("stepTwo",{url:"/stepTwo/:establishment/",controller:"StepTwo",templateUrl:c.assetsDir+"partials/stepTwo.html"}).state("stepTwoPaypal",{url:"/stepTwo/:establishment/:paypalData",controller:"StepTwo",templateUrl:c.assetsDir+"partials/stepTwo.html"}),b.otherwise("/"),b.when("/","/stepOne/list")}]).config(["$translateProvider","tmhDynamicLocaleProvider","constants",function(a,b,c){var d=window.location.pathname.split("/")[5];a.translations(d,translation).preferredLanguage(d),a.useUrlLoader("/WitBooker/translation/index"),b.localeLocationPattern(c.localeFilesDir+"angular-locale_{{locale}}.js")}]).config(["currencySettingsProvider","constants",function(a,b){a.defaultCurrency(witbookerParams.representation.defaultCurrency),a.currentCurrency(witbookerParams.representation.currency),a.rates(witbookerParams.representation.conversionRate),a.conversionRate(witbookerParams.representation.conversionRate[witbookerParams.representation.currency])}]).config(["httpRequestInterceptorCacheBusterProvider",function(a){var b=[/.*\/WitBooker\/stepTwo\/obtainReservationInformation.*/,/.*\/WitBooker\/base\/addToCart.*/,/.*\/WitBooker\/base\/removeFromCart.*/,/.*\/WitBooker\/base\/calculateAvailability.*/,/.*\/WitBooker\/base\/updateSessionAsync.*/,/.*\/WitBooker\/stepTwo\/updateReservation.*/,/.*\/WitBooker\/stepTwo\/reservation.*/];a.setMatchlist(b,!0)}]).config(["$httpProvider",function(a){var b=["$q","$location","$injector","constants","$rootScope","events",function(a,b,c,d,e,f){return{request:function(a){var b;return b||(b=c.get("$state")),a.hasOwnProperty("data")&&(a.data.hasOwnProperty("regularParams")||a.data.hasOwnProperty("representation"))&&(a.data.representation||(a.data.representation={}),a.data.representation.currentState=-1!=b.current.name.indexOf("stepOne")?"StepOne":"StepTwo"),a},response:function(a){var b;if(a&&a.data&&a.data.hasOwnProperty("error")&&"EXPSESS"===a.data.error.code){b||(b=c.get("$modal"));var f,g;f=["$scope","$modalInstance",function(a,b){a.closeInfo=function(){b.close();var a=STEP1_URL.replace(new RegExp("TICKERPLACEHOLDER","g"),e.witbookerParams.representation.ticker).replace("LANGUAGEPLACEHOLDER",e.witbookerParams.representation.locale);window.location=a}}],e.message={body:"trans.session.expired"},g=b.open({templateUrl:d.assetsDir+"partials/step_one/misc/genericModal.html",controller:f,scope:e})}return a}}}];a.interceptors.push(b)}]).run(["$rootScope","util","events","$http","$templateCache","constants","$compile","tmhDynamicLocale","currencySettings","$sce","Api","tmhDynamicLocaleCache",function(a,b,c,d,e,f,g,h,i,j,k,l){b.loadLocales(l),Constants.markups={phase:{},position:{}},Constants.markups.phase.step1="STEP1",Constants.markups.phase.step2="STEP2",Constants.markups.phase.step3="STEP3",Constants.markups.phase.all="ALL",Constants.markups.position.afterbeginbody="FIRST_BODY",Constants.markups.position.beforeendbody="END_BODY",Constants.markups.position.beforeendhead="HEAD",a.customMarkupAdded={},a.constants=f,a.affectedAccommodations={},witbookerParams.regularParams.startDate=b.parseDate(witbookerParams.regularParams.startDate),witbookerParams.regularParams.endDate=b.parseDate(witbookerParams.regularParams.endDate),a.witbookerParams=witbookerParams,a.legacyParams=b.parseQueryString(window.location.search);var m=data.establishment;a.establishment=m,cartData&&"[object Array]"===Object.prototype.toString.call(cartData)&&(a.reservationData=cartData),a.cart={},a.cart.reservations=[],a.cart.processedReservations={},h.set(a.witbookerParams.representation.locale),a.$on(c.CHANGE_LANGUAGE,function(b,c){a.witbookerParams.representation.locale=c,h.set(c)});var n=function(a){var b={};angular.forEach(a.messages,function(a,c){a.hidden||(b[a.position]||(b[a.position]=[]),a.descriptionHtml=j.trustAsHtml(a.description),b[a.position].push(a))}),a.sortedMessages=b};n(m),a.$on(c.UPDATE_AVAILABILITY,function(c,d){a.witbookerParams.representation.activePromoCodes=d.activePromoCodes,a.witbookerParams.regularParams.discountPromoCodes=d.discountPromoCodes,a.witbookerParams.regularParams.inventoryPromoCodes=d.discountPromoCodes,a.affectedAccommodations={},d.messages&&angular.forEach(d.messages,function(b,c){b.show=!0,a.establishment.sortedMessages||(a.establishment.sortedMessages={}),a.establishment.sortedMessages.hasOwnProperty(b.position)||(a.establishment.sortedMessages[b.position]=[]);for(var d=0;d<a.establishment.sortedMessages[b.position].length;d++){var e=a.establishment.sortedMessages[b.position][d];if(b.title&&e.title===b.title)return}b.descriptionHtml=j.trustAsHtml(b.description),a.establishment.sortedMessages[b.position].push(b)}),b.setInventoryLinesGrouped(a.establishment,d);var e=[],f=a.witbookerParams.regularParams.startDate,g=a.witbookerParams.regularParams.endDate;angular.forEach(a.cart.reservations,function(c,d){var h=a.establishment.inventoryRelations.parentOfTicker[c.inventoryLine.ticker],i=a.establishment.inventoryRelations.childrenOfTicker[h];g>c.startDate&&f<c.endDate&&(e=e.concat(i)),b.updateChildrenAndParentInventories(a.witbookerParams.regularParams.startDate,a.witbookerParams.regularParams.endDate,a.establishment,c,"-1",!0,function(b){b&&(angular.extend(a.affectedAccommodations,b),a.affectedAccommodations.counter=a.affectedAccommodations.counter?a.affectedAccommodations.counter+1:1)}),a.cart.processedReservations[c.id]={type:"add"}}),b.changeAccommodationDisplayedPrice(b.removeDuplicatesFromSimpleArray(e),a.establishment,!1)}),a.$on(c.UPDATE_INVENTORIES_BY_CART,function(d,e,f){a.establishment.hasOwnProperty("establishments")||a.cart.processedReservations.hasOwnProperty(e.id)||(b.updateChildrenAndParentInventories(a.witbookerParams.regularParams.startDate,a.witbookerParams.regularParams.endDate,a.establishment,e,"-1",!0,function(b){b&&(angular.extend(a.affectedAccommodations,b),a.affectedAccommodations.counter=a.affectedAccommodations.counter?a.affectedAccommodations.counter+1:1)}),a.cart.processedReservations[e.id]={type:"add"}),1==a.cart.reservations.length&&null!=f&&a.$broadcast(c.TRANSITION_TO_STEP2,{establishment:e.establishment.ticker})}),a.$on(c.CHANGE_CURRENCY,function(a,b){b||(b=i),i.currentCurrency=b.newCurrency,i.conversionRate=i.rates[i.currentCurrency]}),a.$on(c.CHANGE_LANGUAGE,function(d,e,f){angular.forEach(a.establishment.languages,function(b,c){b.code==e&&(a.witbookerParams.representation.language=b)});var g=b.getInventoryLinesID(a.establishment),i=[],j=[],l=[],o={};o[a.establishment.ticker]=[];var p=function(b,c,d){angular.forEach(c.reservations,function(c,e){b[d.ticker].push(c.inventoryLine.ticker),i.push(c.inventoryLine),l.push(c.accommodation),angular.forEach(c.inventoryLine.services,function(b,c){o[a.establishment.ticker].push(b.ticker),j.push(b)})})};p(g,a.cart,a.establishment);var q=b.getDiscountsID(a.establishment),r={establishmentTicker:a.establishment.ticker,locale:e,language:f,inventories:g,discounts:q,services:o,hotels:a.witbookerParams.representation.hotels},s=k.LocalizedData.post(r,function(){jQuery.extend(!0,a.establishment,s.establishment),n(m);var d=function(c,d,e){if(d&&!(d.length<=0)){var f=[];angular.forEach(d,function(a,b){f.push(a.ticker)}),angular.forEach(e,function(a,b){f.push(a.ticker)}),angular.forEach(j,function(a,b){f.push(a.ticker)});var g=b.getInventoryLineByTicker(c,f),h=g.inventories,i=g.accommodation,k=g.services;angular.forEach(d,function(a,b){angular.forEach(h,function(b,c){angular.forEach(b,function(b,c){a.ticker===b.ticker&&(a.condition=b.condition,a.configuration=b.configuration,a.mealPlan=b.mealPlan)})})}),angular.forEach(e,function(a,b){angular.forEach(i,function(b,c){angular.forEach(b,function(b,c){a.ticker===b.ticker&&(a.description=b.description,a.name=b.name)})})}),angular.forEach(a.services,function(a,b){angular.forEach(k,function(b,c){angular.forEach(b,function(b,c){a.ticker===b.ticker&&(a.description=b.description,a.name=b.name)})})})}};d(a.establishment,i,l),h.set(e),$("#disableClick").removeClass("loading"),a.$broadcast(c.CHANGE_LANGUAGE_DONE,{})});"en"==e?($("#datepickerEntryDate").datepicker("option",$.datepicker.regional[""]),$("#datepickerExitDate").datepicker("option",$.datepicker.regional[""])):($("#datepickerEntryDate").datepicker("option",$.datepicker.regional[e]),$("#datepickerExitDate").datepicker("option",$.datepicker.regional[e])),$("#datepickerEntryDate").datepicker("option","dateFormat","dd-mm-yy"),$("#datepickerExitDate").datepicker("option","dateFormat","dd-mm-yy")}),a.cartInfoProcessed=!1,a.servicesProcessed={}}]).filter("range",function(){return function(a,b,c){b=parseInt(b),c=parseInt(c);for(var d=b;c>=d;d++)a.push(d);return a}}),angular.module("witbooker").run(["$templateCache",function(a){"use strict";a.put("js/partials/localized_menu.html",'<div><div class=menuConfiguracion><ul class="menuOpciones nav nav-pills"><li class="idiomasBoton dropdown selector" ng-if="languages.length>1"><a class=dropdown-toggle data-toggle=dropdown><b class=caret></b>&nbsp;&nbsp; <i class="flags lang-{{witbookerParams.representation.language.code}}"></i>{{witbookerParams.representation.language.name}}</a><ul class="dropdown-menu pull-right" ng-if=true><li ng-repeat="lang in languages" ng-if="lang.code!=witbookerParams.representation.language.code"><a ng-click=changeLanguage(lang.code,lang.locale)><i class="flags lang-{{lang.code}}"></i>{{lang.name}}</a></li></ul></li><li id=conversor-divisas class="divisaBoton dropdown selector conversor-divisas"><a class=dropdown-toggle data-toggle=dropdown href=#><b class=caret></b>&nbsp;&nbsp; <strong>{{witbookerParams.representation.currencySymbol}}</strong> {{witbookerParams.representation.currency}}</a><ul class="dropdown-menu pull-right"><li ng-repeat="currency in currencies" ng-if="currency.code!=witbookerParams.representation.currency"><a ng-click=changeCurrency(currency.code,currency.symbol)><strong>{{currency.symbol}}</strong> {{currency.code}}</a></li></ul></li></ul><ul class=menuPasos><li class="menuDispo menuSelected" style="color: rgb(14, 119, 187)"><span class=menuNumeros>❶&nbsp;</span><span translate="">trans.step1.stepLabel</span></li><li class=menuDatos style="color: rgb(113, 113, 113)"><span class=menuNumeros>❷&nbsp;</span><span translate="">trans.step2.stepLabel</span></li><li class=menuConfirm style="color: rgb(113, 113, 113)"><span class=menuNumeros>❸&nbsp;</span><span translate="">trans.step3.stepLabel</span></li></ul><div class=clearer></div></div></div>'),a.put("js/partials/state1.html",'<h1>State 1</h1><hr><a ui-sref=step1.list>Show List</a><div ui-view=""></div>'),a.put("js/partials/state2.html",'<h1>State 2</h1><hr><a ui-sref=step2.list>Show List</a><div ui-view=""></div>'),a.put("js/partials/state2.list.html",'<h3>List of State 2 Things</h3><ul><li ng-repeat="thing in things">{{ thing }}</li></ul>'),a.put("js/partials/stepTwo.html",'<!DOCTYPE html><html><head><title></title></head><body><script>ga(\'tgaown.send\', \'pageview\',document.location.pathname.replace("step1","step2"));\n	ga(\'tgaclient.send\', \'pageview\',document.location.pathname.replace("step1","step2"));</script><custom-markup ng-if="currentState.indexOf(\'stepTwo\')>=0" markups=establishment.markups[constants.markups.phase.step2] position=constants.markups.position.afterbeginbody phase=constants.markups.phase.step2></custom-markup><custom-markup ng-if="currentState.indexOf(\'stepTwo\')>=0" markups=establishment.markups[constants.markups.phase.all] position=constants.markups.position.afterbeginbody phase=constants.markups.phase.all></custom-markup><div class=logoMobileContainer><div class=logoMobile><div class=logoContainerMobile><a href={{util.generateHotelUrl(witbookerParams.representation.hotelSiteUrl,witbookerParams.representation.hotelLogoHasLink)}}><img ng-src={{util.generateLogoUrl(establishment)}} alt="" longdesc=""></a></div></div><div class=isDemo>&nbsp;</div></div><div class=clearer></div><div class=row><div class="col-md-8 mainStepContainer"><div witbooking-localization="" class=topRowContainer witbooker-params=witbookerParams languages=establishment.languages currencies=establishment.currencies></div><div witbooking-cart="" size=constants.cart.largeSize establishment=establishment></div><div class=clearer></div><div id=wrapList><div ui-view=""></div><div id=disableClick></div></div><form method=post name=form role=form class=css-form novalidate><div witbooking-customer-data-form="" form=form establishment=establishment id=customerDataForm customer-data=customerData class=customerFormContainer></div><div witbooking-payment-data-form="" form=form establishment=establishment id=paymentDataForm payment-data=paymentData reservations=cart.reservations class=paymentFormContainer></div></form></div><div class="col-md-4 promotionSideContainer"><div class=logo_hotel><style>.logo_hotel{\n				    padding-top: 55px;\n				    padding-bottom: 55px;\n				    display: table;\n				    margin-right: auto;\n				    margin-left: auto;\n			    }</style><div class=logoContainer style="display: table-cell"><a href={{util.generateHotelUrl(representation.hotelSiteUrl,representation.hotelLogoHasLink)}}><img ng-src={{util.generateLogoUrl(establishment)}} alt="" longdesc=""></a></div><div class=isDemo>&nbsp;</div></div><div class=clearer>&nbsp;</div></div></div><div witbooking-footer="" ng-if=" !witbookerParams.representation.iframeMode || (witbookerParams.representation.iframeMode  && witbookerParams.representation.showPromoCodeInputOnIframeMode )" witbookerparams=witbookerParams></div><custom-markup ng-if="currentState.indexOf(\'stepTwo\')>=0" markups=establishment.markups[constants.markups.phase.step2] position=constants.markups.position.beforeendbody phase=constants.markups.phase.step2></custom-markup><custom-markup ng-if="currentState.indexOf(\'stepTwo\')>=0" markups=establishment.markups[constants.markups.phase.all] position=constants.markups.position.beforeendbody phase=constants.markups.phase.all></custom-markup></body></html>'),a.put("js/partials/step_one.html","<!DOCTYPE html><html><head><title></title></head><body><script>ga('tgaown.send', 'pageview',document.location.pathname);\n    ga('tgaclient.send', 'pageview',document.location.pathname);\n"+'    console.log("page view step1 set");</script><custom-markup ng-if="currentState.indexOf(\'stepOne\')>=0" markups=establishment.markups[constants.markups.phase.step1] position=constants.markups.position.afterbeginbody phase=constants.markups.phase.step1></custom-markup><custom-markup ng-if="currentState.indexOf(\'stepOne\')>=0" markups=establishment.markups[constants.markups.phase.all] position=constants.markups.position.afterbeginbody phase=constants.markups.phase.all></custom-markup><div witbooking-modal-messages="" messages=establishment.sortedMessages[constants.messages.position.modal_step_1] establishment=establishment></div><div class=logoMobileContainer><div class=logoMobile><div class=logoContainerMobile><a href={{util.generateHotelUrl(witbookerParams.representation.hotelSiteUrl,witbookerParams.representation.hotelLogoHasLink)}}><img ng-src={{util.generateLogoUrl(establishment)}} alt="" longdesc=""></a></div></div><div class=isDemo>&nbsp;</div></div><div class=clearer></div><div class=row><div class=col-md-8><div witbooking-localization="" ng-if=!witbookerParams.representation.iframeMode class=topRowContainer witbooker-params=witbookerParams languages=establishment.languages currencies=establishment.currencies></div><div class=promotionTopContainer ng-if=!witbookerParams.representation.hidePromos ng-show="util.countOwnProperties(establishment.discounts)-1>0"><div accordion="" class=promotionsAccordion><div accordion-group=""><div accordion-heading=""><div class=headerSpecials ng-class={&quot;open&quot;:panelPromotionMobileOpen} ng-click="panelPromotionMobileOpen=!panelPromotionMobileOpen"><div><div class=pull-left><span class="sprite specials"></span>  <span class=title><span translate="">trans.step1.discounts</span> ({{ util.countOwnProperties(establishment.discounts)!= 0 ? util.countOwnProperties(establishment.discounts) -1 : 0 }})</span></div><div class=pull-right><span class="sprite arrowPromotionMobile">&nbsp;</span></div><div class=clearer></div></div></div></div><div witbooking-discounts="" class=discountsMobile discounts=establishment.discounts></div></div></div></div><div witbooking-front-end-messages="" messages=establishment.sortedMessages[constants.messages.position.top_inventory_step_1] establishment=establishment class=messagesContainer></div><div witbooking-cart=""></div><div witbooking-error-alert="" ng-repeat="errorMessage in establishment.errorMessages " error-message=errorMessage></div><div id=booking-form witbooking-booking-form="" representation=representation witbooker-params=witbookerParams></div><div witbooking-availability="" establishment=establishment witbooker-params=witbookerParams></div><div class=menuPortal ng-if=showMapButton><span class=textoMenuPortal><span translate="">trans.view</span>:</span><div class=btn-group ng-controller=viewButtoms><a ui-sref=stepOne.list id=listStepOne class="btn viewButton" ng-model=radioModel btn-radio="\'list\'"><i class="sprite listPortal"></i></a> <a ui-sref=stepOne.map id=mapStepOne class="btn viewButton" ng-model=radioModel btn-radio="\'map\'"><i class="sprite mapPortal"></i></a></div></div><div class=clearer></div><div id=wrapList><div ui-view=""></div><div id=disableClick></div></div></div><div class="col-md-4 promotionSideContainer"><div class=logo_hotel><style>.logo_hotel{\n                    padding-top: 55px;\n                    padding-bottom: 55px;\n                    display: table;\n                    margin-right: auto;\n                    margin-left: auto;\n                }</style><div class=logoContainer style="display: table-cell"><a href={{util.generateHotelUrl(witbookerParams.representation.hotelSiteUrl,witbookerParams.representation.hotelLogoHasLink)}}><img ng-src={{util.generateLogoUrl(establishment)}} alt="" longdesc=""></a></div><div class=isDemo>&nbsp;</div></div><div class=clearer>&nbsp;</div><div witbooking-front-end-messages="" messages=establishment.sortedMessages[constants.messages.position.below_logo_step_1] establishment=establishment class=messagesContainer></div><div witbooking-promotions="" ng-if=!witbookerParams.representation.hidePromos discounts=establishment.discounts class=messagesContainer toggle-accordion=toggleAccordion></div></div></div><div witbooking-footer="" ng-if=" !witbookerParams.representation.iframeMode || (witbookerParams.representation.iframeMode  && witbookerParams.representation.showPromoCodeInputOnIframeMode )" witbookerparams=witbookerParams></div><div witbooking-tracking-pixels=""></div><custom-markup ng-if="currentState.indexOf(\'stepOne\')>=0" markups=establishment.markups[constants.markups.phase.step1] position=constants.markups.position.beforeendbody phase=constants.markups.phase.step1></custom-markup><custom-markup ng-if="currentState.indexOf(\'stepOne\')>=0" markups=establishment.markups[constants.markups.phase.all] position=constants.markups.position.beforeendbody phase=constants.markups.phase.all></custom-markup></body></html>'),a.put("js/partials/step_one/availability.html",'<div class="alert availabilityMessages" ng-class="{\'alert-success\':!establishment.allFiltered,\'alert-danger\':establishment.allFiltered}"><span class=sprite ng-class="{\'ok\':!establishment.allFiltered,\'error\':establishment.allFiltered}"></span> <span class=textDispo><span class=pull-left ng-show="!establishment.allFiltered && !establishment.allRestricted">&nbsp;<span translate="">trans.step1.availabilitymessage</span>:</span> <span class=pull-left ng-show=establishment.allRestricted>&nbsp;<span translate="">trans.step1.availabilitymessage</span>:</span> <span class=pull-left ng-show=establishment.allFiltered>&nbsp;<span translate="">trans.step1.unavailabilitymessage</span>:</span> <span class="pull-left firstDate"><span class="str strmonth">&nbsp;{{witbookerParams.regularParams.startDate | date : \'d MMM\'}}</span>&nbsp;{{witbookerParams.regularParams.startDate | date : \'yyyy\'}}&nbsp;</span> <span class=pull-left>-</span> <span class=pull-left><span class="str strmonth">&nbsp;{{witbookerParams.regularParams.endDate | date : \'d MMM\'}}</span>&nbsp;{{witbookerParams.regularParams.endDate | date : \'yyyy\'}}&nbsp;</span> <span class="pull-left textNights">(<span class=str>{{(witbookerParams.regularParams.endDate-witbookerParams.regularParams.startDate)/(1000*60*60*24) | number:0 }} <span translate="">trans.step1.inventoryline.nights</span></span>)</span></span><div class=clearer></div></div>'),a.put("js/partials/step_one/booking_form.html",'<div class=bookingFormContainer><form class=bookingForm method=post><div class=form-left><div class="bookingFormDays input-daterange" id=datepicker><div class=icon-label><span class="widget-icon calendarForm"></span></div><div class=checkin><input class=form-control id=datepickerEntryDate readonly ng-change=formChanged() ng-model=entryDate name=start></div><span>&nbsp;-&nbsp;</span><div class=checkout><input class=form-control id=datepickerExitDate readonly ng-change=formChanged() ng-model=exitDate name=end></div><div class=nights><span>{{(util.parseDate(exitDate)-util.parseDate(entryDate))/(1000*60*60*24) | number:0 }}</span><i class=icon-night></i></div></div><div class=bookingFormPeople><div class="bookAdults peopleSelect" ng-show=!hideSeniorSelector><div class=icon-label><span class="widget-icon pers"></span> <span class=icon-label-text>+{{witbookerParams.representation.adultMaxAge+1}}}</span></div><select class=bookAdultsSelector name=seniors ng-model=seniors ng-change=formChanged() ng-options="option.availability for option in seniorSelectorOptions"></select></div><div class="bookAdults peopleSelect" ng-show=!hideAdultSelector><div class=icon-label><span class="widget-icon pers"></span> <span ng-if="!hideSeniorSelector && !hideAgeIndicator" class=icon-label-text>{{adultMinAge}}-{{witbookerParams.representation.adultMaxAge}}</span> <span ng-if="hideSeniorSelector  && !hideAgeIndicator" class=icon-label-text>+{{adultMinAge}}</span></div><select class=bookAdultsSelector name=adults ng-model=adults ng-change=formChanged() ng-options="option.availability for option in adultSelectorOptions"></select></div><div class="bookKids peopleSelect" ng-show=!hideTeenagerSelector><div class=icon-label><span class="widget-icon ninos"></span> <span class=icon-label-text>{{witbookerParams.representation.childrenMaxAge+1}}-{{witbookerParams.representation.teenagerMaxAge}}</span></div><select class=bookAdultsSelector name=teenagers ng-model=teenagers ng-change=formChanged() ng-options="option.availability for option in teenagerSelectorOptions"></select></div><div class="bookKids peopleSelect" ng-show=!hideChildSelector><div class=icon-label><span class="widget-icon ninos"></span> <span ng-if=!witbookerParams.representation.filterGuestsByAge class=icon-label-text>{{witbookerParams.representation.childrenMinAge}}-{{witbookerParams.representation.childrenMaxAge}}</span> <span ng-if=witbookerParams.representation.filterGuestsByAge class=icon-label-text>{{childrenFilterMinAge}}-{{childrenFilterMaxAge}}</span></div><select class=bookKidsSelector name=children ng-model=children ng-change=formChanged();formKidsChanged(); ng-options="option.availability for option in childSelectorOptions"></select></div><div class="bookBaby peopleSelect" ng-show=!hideBabySelector><div class=icon-label><span class="widget-icon bebes" ng-class="{\'ninos\': witbookerParams.representation.occupancyWithJunior, \'bebes\': !witbookerParams.representation.occupancyWithJunior}"></span> <span class=icon-label-text>{{witbookerParams.representation.babyMinAge}}-{{witbookerParams.representation.childrenMinAge-1}}</span></div><select class=bookBabySelector name=babies ng-model=babies ng-change=formChanged() ng-options="option.availability for option in babySelectorOptions"></select></div></div><div class=bookingFormAgeOfChildren ng-if="witbookerParams.representation.filterGuestsByAge && witbookerParams.regularParams.occupants.guestAges.length>0"><span class=ageOfChildren translate="">trans.step1.ageofchildren</span><br><span ng-repeat="guest in witbookerParams.regularParams.occupants.guestAges track by $index"><select ng-model=witbookerParams.regularParams.occupants.guestAges[$index] ng-change=formChanged()><option value={{option.id}} ng-repeat="option in guestAgesSelectorOptions" ng-selected="{{guest == option.id}}">{{option.text}}</option></select></span></div></div><div class=form-right><div class=container-right><div class=advancedFilter><div ng-show="util.countOwnProperties(witbookerParams.representation.activeExtraFilters)>0"><span translate="">trans.step1.bookingform.advancedfilter</span>: <span class=filter ng-repeat="filter in witbookerParams.representation.activeExtraFilters.il_equal">"{{filter}}"{{$last ? \'\' : \',\'}}</span> <span class=filter ng-repeat="filter in witbookerParams.representation.activeExtraFilters.il_like">"{{filter}}"{{$last ? \'\' : \',\'}}</span> <i class=icon-deleteFilter ng-click=cleanFilters()></i></div></div><div class=promotionCode><div ng-show=witbookerParams.representation.showPromoCode><a class=promoToggle ng-model=promoToggle ng-click="promotionCodeOpen=!promotionCodeOpen;$(\'#promotionCode\').focus();alert(\'H\');"><span translate="">trans.step1.form.promotionalcode</span></a><input ng-show=promotionCodeOpen id=promotionCode ng-model=promoCode name=prom></div></div><div class=bookingFormButton><button type=submit class="btn sendBookingForm" ng-click=getAvailability();><span translate="">trans.step1.bookingform.getavailability</span>&nbsp;<span class=forwardIcon>»</span></button></div></div></div></form></div>'),
a.put("js/partials/step_one/errorAlert.html",'<div ng-if=alert.show><div alert="" type=alert.alertType close=alert.close(show) class=messages><span ng-if="alert.errorType==constants.filters.occupationType "><strong><span translate="">trans.step1.unavailable.{{constants.filters.occupationType}}.generalErrorMessage</span> : {{alert.value.adults}}&nbsp; <span translate="">trans.step1.occupant.adults</span> , {{alert.value.children}}&nbsp;<span translate="">trans.step1.occupant.children</span>, {{alert.value.babies}}&nbsp;<span translate="">trans.step1.occupant.babies</span>.<div translate="">trans.step1.unavailable.tryAgain</div></strong></span></div></div>'),a.put("js/partials/step_one/establishment.html",'<div ng-repeat="establishment in establishment.establishments" ng-include="\'partials/step_one/establishment.html\'"></div><div accordion="" class=hotelAccordion ng-if="!(establishment && establishment.hasOwnProperty(&quot;establishments&quot;) && establishment.establishments.length>0)"><div accordion-group="" is-open=true><div accordion-heading=""><div witbooking-establishment="" show-extra-desc=showExtraDesc util=util establishment=establishment ng-click=toggleAccordion(establishment)></div><div witbooking-info-panel-static="" ng-click=interceptClick($event) establishment=establishment title="\'description\'" type=establishment.visualState.panelType></div></div><div class=accommodation_list ng-include="constants.assetsDir+\'partials/step_one/establishment/accommodation_list.html\'"></div></div></div>'),a.put("js/partials/step_one/establishment/accommodation.html",'<div class="row accordeonElem accommodationRow" id={{accommodation.accommodation.ticker}} ng-class="{panelChildActive:hoverChild, panelChildOpen:accommodation.isOpen}" ng-mouseenter="hoverChild=true" ng-mouseleave="hoverChild=false" ng-click="accommodation.accommodation.visualState.showPanel=false"><div class=hotelInfo><div class=accommodationImageContainer ng-click=showExtraDesc(accommodation.accommodation,constants.panel.type.carousel,$event) ng-class="{hoverImage: hoverHotelImage}" ng-mouseenter="hoverHotelImage=true" ng-mouseleave="hoverHotelImage=false"><img class=accommodationImage ng-src="{{util.generateImgUrl(establishment,accommodation.accommodation,&quot;accommodation&quot;,accommodation.accommodation.media[0].path,{width:125,height:77}) }}" fallback-src=""> <span class=icon-zoom-cont>&nbsp;</span></div><div class=hotelDesc><div><p ng-bind-html=accommodation.accommodation.name class=accommodationName></p><p class=bookedDate>{{ witbookerParams.regularParams.startDate| date : "dd MMM" | uppercase}} - {{ witbookerParams.regularParams.endDate| date : "dd MMM" | uppercase}}</p></div><div class=icons><div><span class="sprite pictures" ng-class="{selectedIcon:(accommodation.accommodation.visualState.showPanel && accommodation.accommodation.visualState.panelType==constants.panel.type.carousel)}" ng-click=showExtraDesc(accommodation.accommodation,constants.panel.type.carousel,$event)>&nbsp;</span> <span class="sprite infoNew" ng-class="{selectedIcon:(accommodation.accommodation.visualState.showPanel && accommodation.accommodation.visualState.panelType==constants.panel.type.description)}" ng-click=showExtraDesc(accommodation.accommodation,constants.panel.type.description,$event)>&nbsp;</span></div></div></div></div><div class=reservationInfo ng-if=accommodation.accommodation.cheapestRate><div class=hotelPrice ng-if=!isCollapsed><span class=priceContainer><p class=fromText translate="">trans.step1.hotel.priceFrom</p><p class=amountContainer><span class=integer>{{(accommodation.accommodation.cheapestRate) | currencyConverter : establishment | integerDigits }}</span> <span class=decimalSeparator>,</span> <span class=decimal>{{(accommodation.accommodation.cheapestRate) | currencyConverter : establishment | fractionalDigits | number:2 | limitTo:-2}}</span></p><p class=priceOptionsContainer><span class=currency>{{witbookerParams.representation.currency}}</span> <span class=perNightText>&nbsp;/<span translate="">trans.step1.hotel.night</span></span></p><span class=reservationLink style="text-decoration: underline" translate="">trans.step1.hotel.bookOnline</span></span></div><div class=hotelArr><i class="sprite arrowRoom" ng-class="{ \'open\': accommodation.isOpen }">&nbsp;</i></div></div><div class=errorContainer ng-if=!accommodation.accommodation.cheapestRate><div class=inventoryError><span class=locked ng-if="errorType!=constants.filters.restricted"><span translate="">trans.closed</span><br></span> <span class=alternateAction ng-if="errorType==constants.filters.closed" translate="">trans.changeDates</span> <span class=alternateAction ng-if="errorType==constants.filters.restricted" translate="">trans.step1.inventoryline.viewoptions</span></div><div class=hotelArr><i class="sprite arrowRoom" ng-class="{ \'open\': accommodation.isOpen }">&nbsp;</i></div></div></div>'),a.put("js/partials/step_one/establishment/accommodation_list.html",'<div accordion="" class=accommodationAccordion ng-repeat="accommodation in establishment.inventoryLinesGrouped | orderBy:\'accommodation.order\':false"><div accordion-group="" is-open={{accommodation.isOpen}}><div accordion-heading=""><div witbooking-accommodation="" show-extra-desc=showExtraDesc accommodation=accommodation establishment=establishment witbooker-params=witbookerParams representation=representation ng-click=toggleAccordion(accommodation)></div><div witbooking-info-panel-static="" ng-click=interceptClick($event) establishment=accommodation.accommodation type=accommodation.accommodation.visualState.panelType></div></div><div class=configuration_list ng-include="constants.assetsDir+\'partials/step_one/establishment/inventoryLine_list.html\'"></div></div></div>'),a.put("js/partials/step_one/establishment/hotel.html",'<div class="row accordeonElem hotelRow" id={{establishment.ticker}} ng-class="{panelActive:hover, panelOpen:establishment.isOpen}" ng-mouseenter="hover=true" ng-mouseleave="hover=false" ng-click="establishment.visualState.showPanel=false"><div class=hotelInfo><div class=hotelImageContainer ng-click=showExtraDesc(establishment,constants.panel.type.carousel,$event) ng-class="{hoverImage: hoverHotelImage}" ng-mouseenter="hoverHotelImage=true" ng-mouseleave="hoverHotelImage=false"><img class=hotelImage ng-src="{{util.generateImgUrl(establishment,establishment,&quot;hotel&quot;,establishment.media[0].path,{width:170,height:105}) }}" fallback-src=""> <span class=icon-zoom-cont>&nbsp;</span></div><div class=hotelDesc><div><p class=hotelName>{{establishment.name | uppercase}}</p><p class=cityName>{{ establishment.contactInfo.city }}</p></div><div class=icons><span class="sprite pictures" ng-class="{selectedIcon:(establishment.visualState.showPanel && establishment.visualState.panelType==constants.panel.type.carousel)}" ng-click=showExtraDesc(establishment,constants.panel.type.carousel,$event)>&nbsp;</span> <span class="sprite infoNew" ng-class="{selectedIcon:(establishment.visualState.showPanel && establishment.visualState.panelType==constants.panel.type.description)}" ng-click=showExtraDesc(establishment,constants.panel.type.description,$event)>&nbsp;</span> <span class="sprite maps" ng-if="establishment.contactInfo.hasOwnProperty(\'latitude\')" ng-class="{selectedIcon:(establishment.visualState.showPanel && establishment.visualState.panelType==constants.panel.type.map)}" ng-click=showExtraDesc(establishment,constants.panel.type.map,$event)>&nbsp;</span> <span class="sprite discounts" ng-show="util.countOwnProperties(establishment.discounts)>0" ng-class="{selectedIcon:(establishment.visualState.showPanel && establishment.visualState.panelType==constants.panel.type.discounts)}" ng-click=showExtraDesc(establishment,constants.panel.type.discounts,$event)>&nbsp;</span></div></div></div><div class=reservationInfo ng-if=establishment.cheapestRate><div class=hotelPrice ng-if=!isCollapsed><span class=priceContainer ng-if="establishment.errorMessages.length==0"><p class=fromText translate="">trans.step1.hotel.priceFrom</p><p class=amountContainer><span class=integer>{{establishment.cheapestRate | currencyConverter : establishment | integerDigits}}</span> <i class=decimalSeparator>,</i> <span class=decimal>{{(establishment.cheapestRate) | currencyConverter : establishment | fractionalDigits | number:2 | limitTo:-2}}</span></p><p class=priceOptionsContainer><span class=currency>{{witbookerParams.representation.currency}}</span> <span class=perNightText>&nbsp;/<span translate="">trans.step1.hotel.night</span></span></p><span class=reservationLink style="text-decoration: underline" translate="">trans.step1.hotel.bookOnline</span></span> <span class=priceContainer ng-if="establishment.errorMessages.length>0"><span class=reservationLink style="text-decoration: underline" translate="">trans.checkAvailability</span></span></div><div class=hotelArr><i class="sprite arrowHotel" ng-class="{ \'open\': establishment.isOpen }">&nbsp;</i></div></div><div class=errorContainer ng-if=!establishment.cheapestRate><div class=inventoryError><span class=locked ng-if="errorType!=constants.filters.restricted"><span translate="">trans.closed</span><br></span> <span class=alternateAction ng-if="errorType==constants.filters.closed" translate="">trans.changeDates</span> <span class=alternateAction ng-if="errorType==constants.filters.restricted" translate="">trans.step1.inventoryline.viewoptions</span></div><div class=hotelArr><i class="sprite arrowHotel" ng-class="{ \'open\': establishment.isOpen }">&nbsp;</i></div></div></div>'),a.put("js/partials/step_one/establishment/inventoryLine.html",'<div class=inventoryLine data-ticker={{inventoryLine.ticker}}><div class=infoContainer><div class=infoDetails><div class=configuration>{{ inventoryLine.configuration.name }}</div><div><span class=mealPlan><i class="sprite breakfast"></i> {{ inventoryLine.mealPlan.name | uppercase}}</span> - <span title="{{\'trans.step1.condition.title\'|translate}}" class=condition style="{{inventoryLine.condition.color!=\'\'?\'color:#\'+inventoryLine.condition.color :\'\' }}" ng-click=showExtraDesc(inventoryLine,constants.panel.type.conditions,$event)>{{ inventoryLine.condition.name | uppercase }}</span></div><div class=displayChart><span class="sprite calendar">&nbsp;</span>  <span class=toggle_comparison ng-click=showExtraDesc(inventoryLine,constants.panel.type.chart,$event)><span ng-show="!(inventoryLine.visualState.showPanel && inventoryLine.visualState.panelType==constants.panel.type.chart)" translate="">trans.step1.inventoryline.showPriceCalendar</span> <span ng-show="(inventoryLine.visualState.showPanel && inventoryLine.visualState.panelType==constants.panel.type.chart)" translate="">trans.step1.inventoryline.hidePriceCalendar</span></span></div></div></div><div class=errorContainer ng-if="inventoryLine.errorMessage.length>0"><div class=inventoryError><div ng-repeat="errorMessage in inventoryLine.displayErrorMessages"><span ng-if="(errorMessage.errorType==constants.filters.closed || errorMessage.errorType==constants.filters.availability)" class=locked><span class=lockedOrRestrict translate="">trans.{{errorMessage.errorType}}</span></span> <span class=lockedOrRestrict ng-if="(errorMessage.errorType==constants.filters.checkIn || errorMessage.errorType==constants.filters.checkOut)"><span translate="">trans.{{errorMessage.errorType}}</span>: <span ng-repeat="day in errorMessage.value">{{ day| date : "EEE" | uppercase}}{{$last ? \'\' : \',\'}}</span></span> <span class=lockedOrRestrict ng-if=(errorMessage.otherError)><span translate="">trans.{{errorMessage.errorType}}</span> <span><span class=lockedOrRestrict ng-if="errorMessage.errorType==constants.filters.minNotice || errorMessage.errorType==constants.filters.maxNotice">: <span ng-if="errorMessage.value>=24">{{errorMessage.value/24 | number:0}}</span> <span ng-if="errorMessage.value<24">{{errorMessage.value}}</span> <span ng-if="errorMessage.value>=24" translate="">trans.step1.inventoryline.unavailable.value.days</span> <span ng-if="errorMessage.value<24" translate="">trans.step1.inventoryline.unavailable.value.hours</span></span> <span class=lockedOrRestrict ng-if="errorMessage.errorType!=constants.filters.minNotice && errorMessage.errorType!=constants.filters.maxNotice">: {{errorMessage.value}} <span translate="">trans.step1.inventoryline.unavailable.value.days</span></span></span></span></div><span class=alternateAction ng-if=isLocked ng-click=showExtraDesc(inventoryLine,constants.panel.type.chart,$event) translate="">trans.checkAvailability</span> <span class=alternateAction ng-if=!isLocked ng-click=showExtraDesc(inventoryLine,constants.panel.type.chart,$event) title="{{\'trans.step1.changeDates.title\'|translate}}" translate="">trans.changeDates</span></div></div><div class=inventoryLineRight><div class=reservationFormContainer ng-if="!inventoryLine.errorMessage.length>0"><div class=reservationForm><div class=unitQuanitySelectContainer><select title="{{\'trans.step1.availabilitySelect.title\'|translate}}&nbsp;{{\'trans.step1.\'+witbookerParams.representation.roomDenomination | translate}}" ng-model=inventoryLine.reservation.units ng-change=updatePrice() class="form-control unitQuantitySelection" ng-options="option.availability for option in unitSelectorOptions"></select><div class=unitText translate="">trans.step1.{{witbookerParams.representation.roomDenomination}}</div></div><button class="btn btn-success reservationButton" type=button ng-click=redirectToStep2() popover-template={{constants.assetsDir+&quot;partials/step_one/misc/reservation_button_popover.html&quot;}} popover-placement=bottom popover-append-to-body=true><div class=bookText translate="">trans.step1.inventoryline.booking</div><div class=nightsText>{{(witbookerParams.regularParams.endDate-witbookerParams.regularParams.startDate)/(1000*60*60*24) | number:0 }}&nbsp;<span translate="">trans.step1.inventoryline.nights</span></div><div ng-if=showRoomsLeftMessage class=reservationLimitAlertText><span ng-if="inventoryLine.availability!=1">{{ \'trans.step1.inventoryline.reservationLimitAlertText\' | translate:\'{ value: \'+inventoryLine.availability+\' }\' }}</span> <span translate="" ng-if="inventoryLine.availability==1">trans.step1.inventoryline.reservationLimitAlertLastText</span></div></button></div></div><div class=rateContainer ng-if="!inventoryLine.errorMessage.length>0"><div class=rate><div class=amount><span class=integerInventoryLine>{{(inventoryLine.totalRate*inventoryLine.reservation.units.availability) | currencyConverter : establishment | integerDigits }}</span> <span class=decimalSeparator>,</span> <span class=decimalInventoryLine>{{(inventoryLine.totalRate*inventoryLine.reservation.units.availability) | currencyConverter : establishment | fractionalDigits | number:2 | limitTo:-2}}</span> <span class=currencyInventoryLine>{{witbookerParams.representation.currency}}</span></div><div class=amountPerNight ng-if="(witbookerParams.regularParams.endDate-witbookerParams.regularParams.startDate)/(1000*60*60*24) >1"><span class=integerInventoryLine>{{(inventoryLine.averageRate*inventoryLine.reservation.units.availability) | currencyConverter : establishment | integerDigits }}</span> <span class=decimalSeparator>,</span> <span class=decimalInventoryLine>{{(inventoryLine.averageRate*inventoryLine.reservation.units.availability) | currencyConverter : establishment | fractionalDigits | number:2 | limitTo:-2}}</span> <span class=perNightText translate="">trans.step1.inventory.perNight</span></div><div class=discount ng-if="inventoryLine.discountPercentage>0"><span class=fullAmount><span>{{(inventoryLine.originalRate) | currencyConverter : establishment | integerDigits}}, {{(inventoryLine.originalRate) | currencyConverter : establishment | fractionalDigits | number:2 | limitTo:-2}}</span></span> &nbsp; <span popover-append-to-body=true popover-template={{constants.assetsDir+&quot;partials/step_one/misc/discount_popover.html&quot;}} popover-placement=bottom class="discountPercentage info label label-important">{{inventoryLine.discountPercentage*100 | number:0}}%</span></div></div></div></div><div class=clearer></div></div><div class=inventoryLineMobile data-ticker={{inventoryLine.ticker}}><div class=infoContainer><div class=infoDetails><div class=configuration>{{ inventoryLine.configuration.name }}</div><div class=mealPlan>{{ inventoryLine.mealPlan.name | uppercase}}</div><div title="{{\'trans.step1.condition.title\'|translate}}" class=condition style="{{inventoryLine.condition.color!=\'\'?\'color:#\'+inventoryLine.condition.color :\'\' }}" ng-click=showExtraDesc(inventoryLine,constants.panel.type.conditions,$event)>{{ inventoryLine.condition.name | uppercase }}</div></div><div class=rateContainer ng-if="!inventoryLine.errorMessage.length>0"><div class=rate><div class=amount><span class=integerInventoryLine>{{(inventoryLine.totalRate*inventoryLine.reservation.units.availability) | currencyConverter : establishment | integerDigits }}</span> <span class=decimalSeparator>,</span> <span class=decimalInventoryLine>{{(inventoryLine.totalRate*inventoryLine.reservation.units.availability) | currencyConverter : establishment | fractionalDigits | number:2 | limitTo:-2}}</span> <span class=currencyInventoryLine>{{witbookerParams.representation.currency}}</span></div><div class=amountPerNight ng-if="(witbookerParams.regularParams.endDate-witbookerParams.regularParams.startDate)/(1000*60*60*24) >1"><span class=integerInventoryLine>{{(inventoryLine.averageRate*inventoryLine.reservation.units.availability) | currencyConverter : establishment | integerDigits }}</span> <span class=decimalSeparator>,</span> <span class=decimalInventoryLine>{{(inventoryLine.averageRate*inventoryLine.reservation.units.availability) | currencyConverter : establishment | fractionalDigits | number:2 | limitTo:-2}}</span> <span class=perNightText translate="">trans.step1.inventory.perNight</span></div><div class=discount ng-if="inventoryLine.discountPercentage>0"><span class=fullAmount><span>{{(inventoryLine.originalRate) | currencyConverter : establishment | integerDigits}}, {{(inventoryLine.originalRate) | currencyConverter : establishment | fractionalDigits | number:2 | limitTo:-2}}</span></span> &nbsp; <span popover-append-to-body=true popover-template={{constants.assetsDir+&quot;partials/step_one/misc/discount_popover.html&quot;}} popover-placement=bottom class="discountPercentage info label label-important">{{inventoryLine.discountPercentage*100 | number:0}}%</span></div></div></div><div class=errorContainer ng-if="inventoryLine.errorMessage.length>0"><div class=inventoryError><div ng-repeat="errorMessage in inventoryLine.displayErrorMessages"><span ng-if="(errorMessage.errorType==constants.filters.closed || errorMessage.errorType==constants.filters.availability)" class=locked><span class=lockedOrRestrict translate="">trans.{{errorMessage.errorType}}</span></span> <span class=lockedOrRestrict ng-if="(errorMessage.errorType==constants.filters.checkIn || errorMessage.errorType==constants.filters.checkOut)"><span translate="">trans.{{errorMessage.errorType}}</span>: <span ng-repeat="day in errorMessage.value">{{ day| date : "EEE" | uppercase}}{{$last ? \'\' : \',\'}}</span></span> <span class=lockedOrRestrict ng-if=(errorMessage.otherError)><span translate="">trans.{{errorMessage.errorType}}</span> <span><span class=lockedOrRestrict ng-if="errorMessage.errorType==constants.filters.minNotice || errorMessage.errorType==constants.filters.maxNotice">: <span ng-if="errorMessage.value>=24">{{errorMessage.value/24 | number:0}}</span> <span ng-if="errorMessage.value<24">{{errorMessage.value}}</span> <span ng-if="errorMessage.value>=24" translate="">trans.step1.inventoryline.unavailable.value.days</span> <span ng-if="errorMessage.value<24" translate="">trans.step1.inventoryline.unavailable.value.hours</span></span> <span class=lockedOrRestrict ng-if="errorMessage.errorType!=constants.filters.minNotice && errorMessage.errorType!=constants.filters.maxNotice">: {{errorMessage.value}} <span translate="">trans.step1.inventoryline.unavailable.value.days</span></span></span></span></div><span class=alternateAction ng-if=isLocked ng-click=showExtraDesc(inventoryLine,constants.panel.type.chart,$event) translate="">trans.checkAvailability</span> <span class=alternateAction ng-if=!isLocked ng-click=showExtraDesc(inventoryLine,constants.panel.type.chart,$event) title="{{\'trans.step1.changeDates.title\'|translate}}" translate="">trans.changeDates</span></div></div></div><div class=reservationFormContainer ng-if="!inventoryLine.errorMessage.length>0"><div class=buttomsInfoMobile><span class="sprite infoMobile" ng-click=showExtraDesc(inventoryLine,constants.panel.type.conditions,$event)>&nbsp;</span> <span class="sprite calendarMobile" ng-click=showExtraDesc(inventoryLine,constants.panel.type.chart,$event)>&nbsp;</span></div><div class=buttomsBookingMobile><div class=selectUnityContainer><div class=unitText translate="">trans.step1.{{witbookerParams.representation.roomDenomination}}</div><select title="{{\'trans.step1.availabilitySelect.title\'|translate}}&nbsp;{{\'trans.step1.\'+witbookerParams.representation.roomDenomination | translate}}" ng-model=inventoryLine.reservation.units ng-change=updatePrice() class="form-control unitQuantitySelection" ng-options="option.availability for option in unitSelectorOptions"></select></div><button class="btn btn-success reservationButton" type=button ng-click=redirectToStep2() popover-template={{constants.assetsDir+&quot;partials/step_one/misc/reservation_button_popover.html&quot;}} popover-placement=bottom popover-append-to-body=true><div class=bookText translate="">trans.step1.inventoryline.booking</div><div class=nightsText>{{(witbookerParams.regularParams.endDate-witbookerParams.regularParams.startDate)/(1000*60*60*24) | number:0 }}&nbsp;<span translate="">trans.step1.inventoryline.nights</span></div><div ng-if=showRoomsLeftMessage class=reservationLimitAlertText><span ng-if="inventoryLine.availability!=1">{{ \'trans.step1.inventoryline.reservationLimitAlertText\' | translate:\'{ value: \'+inventoryLine.availability+\' }\' }}</span> <span translate="" ng-if="inventoryLine.availability==1">trans.step1.inventoryline.reservationLimitAlertLastText</span></div></button><div class=clearer></div></div><div class=clearer></div></div><div class=clearer></div></div><div witbooking-info-panel-static="" ng-click=interceptClick($event) establishment=inventoryLine root-establishment=establishment type=inventoryLine.visualState.panelType></div>'),a.put("js/partials/step_one/establishment/inventoryLine_list.html","<div ng-repeat=\"inventoryLine in accommodation.inventoryLine | orderBy:['configuration.name' ,'mealPlan.order' ,'condition.order'] \"><div witbooking-inventory-line=\"\" show-extra-desc=showExtraDesc line=inventoryLine witbooker-params=witbookerParams representation=representation establishment=establishment accommodation=accommodation></div></div>"),a.put("js/partials/step_one/establishment/map.html",'<div id=map-canvas-{{mapid}} style="height: 100%;width: 100%;margin: 0px;padding: 0px"></div>'),a.put("js/partials/step_one/footer.html",'<div class=col-md-8><div class=footer><div class=footerContainer><div ng-class="{footerText: showPromoCodeInputOnIframeMode && iframeMode}"><span class=footerSpanText><a href=http://www.witbooking.es target=_blank>Witbooking</a> <span>&#40;v.</span> <span class=releaseVersion>{{releaseVersion}}</span> <span>&#41; &copy;</span> <span>2015</span></span></div><div ng-if="showPromoCodeInputOnIframeMode && iframeMode" witbooking-iframe-promo-code=""></div></div></div></div>'),a.put("js/partials/step_one/mapView.html",'<div id=map-canvas style="height: 100%;width: 100%;margin: 0px;padding: 0px"></div>'),a.put("js/partials/step_one/messages.html",'<div class=messagesContainer><div alert="" class="messages {{message.style}}" ng-repeat="message in messages" ng-show=message.show type=messageAlertClassDict[message.type] close=closeAlert($index)><span ng-bind-html=message.descriptionHtml></span></div></div>'),a.put("js/partials/step_one/misc/cartInfo.html",'<div class=modal-header><h3 class=modal-title ng-bind-html=info.name></h3></div><div class=modal-body><div ng-if="info.media.length>0"><img ng-src={{info.image}} class="infoImage img-rounded" fallback-src=""></div><div class="{{info.rate>0?\'infoText\':\'infoTextWithoutImg\'}}"><div ng-bind-html=info.description></div><div ng-if="info.rate>0"><strong><span>{{(info.rate) | currencyConverter : establishment | integerDigits }}</span> <span class=separator>,</span> <span>{{(info.rate) | currencyConverter : establishment | fractionalDigits | number:2 | limitTo:-2}}</span> <span>&nbsp;{{info.specification}}&nbsp;{{currency}}</span></strong></div></div><div class=clearer></div></div><div class=modal-footer><button class="btn btn-danger" ng-click=closeInfo() translate="">trans.step2.close</button></div>'),a.put("js/partials/step_one/misc/cartNotification.html",'<div class=modal-header></div><div class=modal-body><span translate="">trans.step1.cart.deletedReservations</span><ul><li ng-repeat="reservation in deletedReservations"><span class=name>{{reservation.quantity}}</span> <span class=por>x</span> <span class=name ng-bind-html=reservation.accommodation.name>&nbsp;</span> <span class="config block">{{ reservation.startDate| date : "dd MMM" | uppercase}}&nbsp;» &nbsp;{{ reservation.endDate| date : "dd MMM" | uppercase}}&nbsp;» &nbsp;{{(reservation.endDate-reservation.startDate)/(1000*60*60*24) | number:0 }} <span translate="">trans.step1.inventoryline.nights</span></span></li></ul><div></div></div><div class=modal-footer><button class="btn btn-primary" ng-click=ok()>OK</button></div>'),a.put("js/partials/step_one/misc/chart.html",'<div class=chartContainer><div class=header><div class=title><span class=prevMonth ng-if=!isLoading>◄</span> <span class=textMonth translate="">trans.step1.inventory.chart.title</span> <span class=nextMonth ng-if=!isLoading>►</span></div><div class="sprite closeW closeInfoH" ng-click="close(inventoryLine,constants.panel.type.chart ,$event)">&nbsp;</div></div><div class=content id=chart-canvas-{{chartid}}><div class=wraploader ng-if=isLoading><img class=loader ng-src=/WitBooker/img/ajax-loader.gif></div></div></div>'),a.put("js/partials/step_one/misc/conditionsModal.html",'<div class=modal-header><h3 class=modal-title translate="">trans.step2.conditions</h3></div><div class=modal-body><div ng-repeat="condition in conditions" class=conditionsModal><div class=content><span class=condition style="text-decoration: none; font-weight: bold{{condition.color!=\'\'?\';color:#\'+condition.color:\'\'}}">{{ condition.name | uppercase }}</span><br><br><div ng-if=condition.cancellation><div class=textCond ng-bind-html=condition.cancellation></div></div><div ng-if="condition.entry || condition.exit"><span class=titleCond translate="">trans.step1.inventoryline.condition.timetable</span><table><tbody><tr><td ng-if=condition.entry style="padding-right:10px;vertical-align: top"><span class=title translate="">trans.step1.inventoryline.condition.entry</span>:&nbsp;<p ng-bind-html=condition.entry></p></td><td ng-if=condition.exit style="vertical-align: top"><span class=title translate="">trans.step1.inventoryline.condition.exit</span>:&nbsp;<p ng-bind-html=condition.exit></p></td></tr></tbody></table></div><div ng-if=condition.children><span class=titleCond translate="">trans.step1.inventoryline.condition.children</span><div class=textCond ng-bind-html=condition.children></div></div><div ng-if=condition.pets><span class=titleCond translate="">trans.step1.inventoryline.condition.pets</span><div class=textCond ng-bind-html=condition.pets></div></div><div ng-if=condition.groups><span class=titleCond translate="">trans.step1.inventoryline.condition.groups</span><div class=textCond ng-bind-html=condition.groups></div></div><div ng-if=condition.additionalInfo><div alert="" class="messages alert-info" ng-click=toggleAdditionalInfo() type=" \'info\' "><span class=moreInfo ng-if=isAdditionalInfoVisible class=pointer>[-]&nbsp;<span class=titleCond translate="">trans.step2.info</span></span> <span class=moreInfo ng-if=!isAdditionalInfoVisible class=pointer>[+]&nbsp;<span class=titleCond translate="">trans.step2.info</span></span></div><br><br><div class=textCond ng-if=isAdditionalInfoVisible ng-bind-html=condition.additionalInfo></div></div></div></div><div class=clearer></div></div><div class=modal-footer><button class="btn btn-danger" ng-click=closeInfo() translate="">trans.step2.close</button></div>'),a.put("js/partials/step_one/misc/discount_popover.html",'<span class=nombreDescuentoTooltip><div ng-repeat="(discount,amount) in inventoryLine.discounts"><span class=tickTooltip>✓</span> &nbsp; <span class=tickTooltip></span> <span ng-bind-html=establishment.discounts[discount].name></span></div></span>'),a.put("js/partials/step_one/misc/genericModal.html",'<div class=modal-header><h3 class=modal-title ng-bind-html=message.title></h3></div><div class=modal-body><div translate="">{{message.body}}</div><div class=clearer></div></div><div class=modal-footer><button class="btn btn-danger" ng-click=closeInfo() translate="">trans.step2.close</button></div>'),a.put("js/partials/step_one/misc/info_discounts.html",'<div><div class=promotionHotelContainer ng-repeat="discount in discounts | orderObjectBy:\'order\' " ng-if=discount.active><div class=title><span ng-bind-html=discount.name></span></div><span ng-bind-html=discount.description class=description></span><div class=promoCodeLabelContainer><span ng-if=discount.promoCode class="label label-success promoCodeLabel">{{discount.promoCode}}</span></div><div><p ng-if="discount.reduction && (discount.reduction*-1)>0"><span class="labelText discount" translate="">trans.step1.promotions.reduction</span>: <span class=discount>{{discount.reduction | number:2 }}{{discount.percentage? \'%\':\'\'}}</span></p><p ng-if="discount.reduction && (discount.reduction*-1)>0"><span class=labelText translate="">trans.step1.conditions</span>:</p><ul><li ng-if=discount.minStay class=valid ng-class="{invalid: discount.failedMinStay}"><span translate="">trans.minStay</span>:<span>{{discount.minStay}}</span></li><li ng-if=discount.maxStay class=valid ng-class="{invalid: discount.failedMaxStay}"><span translate="">trans.maxStay</span>:<span>{{discount.maxStay}}</span></li><li ng-if=discount.minNotice class=valid ng-class="{invalid: discount.failedMinNotice}"><span translate="">trans.minNotice</span>:<span>{{discount.minNotice}}</span></li><li ng-if=discount.maxNotice class=valid ng-class="{invalid: discount.failedMaxNotice}"><span translate="">trans.maxNotice</span>:<span>{{discount.maxNotice}}</span></li><li ng-if=discount.validPeriod class=valid ng-class="{invalid: discount.failedValid}"><span translate="">trans.validity</span>:<span>{{discount.validPeriod}}</span></li><li ng-if=discount.contractPeriod class=valid ng-class="{invalid: discount.failedContract}"><span translate="">trans.contract</span>:<span>{{discount.contractPeriod}}</span></li><li ng-if="discount.reduction && (discount.reduction*-1)>0"><span translate="">trans.accumulated</span>:<span translate="">trans.no</span></li></ul></div></div></div>'),a.put("js/partials/step_one/misc/info_panel.html",'<div ng-if=" !(establishment && establishment.hasOwnProperty(&quot;establishments&quot;) && establishment.establishments.length>0) && establishment.visualState.showPanel && establishment.visualState.panelType==constants.panel.type.description " class=hotelExtraDesc><div class=header><span class=title translate="">trans.step1.description</span> <span class="sprite closeW closeInfoH" ng-click=close(elementType,constants.panel.type.description,$event)>&nbsp;</span></div><div class=content><span ng-bind-html=establishment.description></span></div></div><div ng-if=" !(establishment && establishment.hasOwnProperty(&quot;establishments&quot;) && establishment.establishments.length>0) && establishment.visualState.showPanel && establishment.visualState.panelType==constants.panel.type.conditions " class=hotelExtraDesc><div class=header><span class=title translate="">trans.step1.conditions</span> <span class="sprite closeW closeInfoH" ng-click=close(establishment,constants.panel.type.conditions,$event)>&nbsp;</span></div><div class=content><span ng-bind-html=establishment.description></span> <span style="color: #894400; font-weight: bold" class=mealPlan>{{ establishment.mealPlan.name | uppercase}}</span><br><br><span class=condition style="text-decoration: none; font-weight: bold{{establishment.condition.color!=\'\'?\';color:#\'+establishment.condition.color:\'\'}}">{{ establishment.condition.name | uppercase }}</span><br><br><div ng-if=establishment.condition.cancellation><div class=textCond ng-bind-html=establishment.condition.cancellation></div></div><div ng-if="establishment.condition.entry || establishment.condition.exit"><span class=titleCond translate="">trans.step1.inventoryline.condition.timetable</span><table><tbody><tr><td ng-if=establishment.condition.entry style="padding-right:10px;vertical-align: top"><span class=title translate="">trans.step1.inventoryline.condition.entry</span>:&nbsp;<p ng-bind-html=establishment.condition.entry></p></td><td ng-if=establishment.condition.exit style="vertical-align: top"><span class=title translate="">trans.step1.inventoryline.condition.exit</span>:&nbsp;<p ng-bind-html=establishment.condition.exit></p></td></tr></tbody></table></div><div ng-if=establishment.condition.children><span class=titleCond translate="">trans.step1.inventoryline.condition.children</span><div class=textCond ng-bind-html=establishment.condition.children></div></div><div ng-if=establishment.condition.pets><span class=titleCond translate="">trans.step1.inventoryline.condition.pets</span><div class=textCond ng-bind-html=establishment.condition.pets></div></div><div ng-if=establishment.condition.groups><span class=titleCond translate="">trans.step1.inventoryline.condition.groups</span><div class=textCond ng-bind-html=establishment.condition.groups></div></div><div ng-if=establishment.condition.additionalInfo><div alert="" class="messages alert-info" ng-click=toggleAdditionalInfo() type=" \'info\' "><span class=moreInfo ng-if=isAdditionalInfoVisible class=pointer>[-]&nbsp;<span class=titleCond translate="">trans.step2.info</span></span> <span class=moreInfo ng-if=!isAdditionalInfoVisible class=pointer>[+]&nbsp;<span class=titleCond translate="">trans.step2.info</span></span></div><br><br><div class=textCond ng-if=isAdditionalInfoVisible ng-bind-html=establishment.condition.additionalInfo></div></div></div></div><div ng-if=" !(establishment && establishment.hasOwnProperty(&quot;establishments&quot;) && establishment.establishments.length>0) && establishment.visualState.showPanel && establishment.visualState.panelType==constants.panel.type.chart "><div witbooking-chart="" establishment=rootEstablishment inventory-line=establishment chartid="establishment.ticker | lowercase"></div></div><div ng-if=" !(establishment && establishment.hasOwnProperty(&quot;establishments&quot;) && establishment.establishments.length>0) && establishment.visualState.showPanel && establishment.visualState.panelType==constants.panel.type.carousel " class="hotelExtraDesc box"><div class=caruContent witbooking-carousel=""></div></div><div ng-if=" !(establishment && establishment.hasOwnProperty(&quot;establishments&quot;) && establishment.establishments.length>0) && establishment.visualState.showPanel && establishment.visualState.panelType==constants.panel.type.map " class="hotelExtraDesc mapBox"><div class=header><span class=title translate="">trans.step1.location</span> <span class="sprite closeW closeInfoH" ng-click="close(elementType,constants.panel.type.map ,$event)">&nbsp;</span></div><div class=boxContent witbooking-map="" establishment=establishment mapid="establishment.name | lowercase"></div></div><div ng-if=" !(establishment && establishment.hasOwnProperty(&quot;establishments&quot;) && establishment.establishments.length>0) && establishment.visualState.showPanel && establishment.visualState.panelType==constants.panel.type.discounts " class=hotelExtraDesc><div class=header><span class=title translate="">trans.step1.discounts</span> <span class="sprite closeW closeInfoH" ng-click="close(elementType,constants.panel.type.discounts ,$event)">&nbsp;</span></div><div witbooking-discounts="" discounts=establishment.discounts></div></div>'),
a.put("js/partials/step_one/misc/info_panel_carousel.html",'<div style="height: 100%"><div carousel="" interval=myInterval><div slide="" ng-repeat="slide in slides" active=slide.active><span class="sprite closeW" ng-click=slide.close(slide.elementType,constants.panel.type.carousel,$event)>&nbsp;</span><div class=pic><img class=carouselImg ng-src={{slide.image}} style="margin: auto" fallback-src=""><div class=carousel-caption ng-show="slide.title || slide.text"><h4>{{slide.title}}</h4><p>{{slide.text}}</p></div></div></div></div></div>'),a.put("js/partials/step_one/misc/info_panel_text.html",'<div ng-if=" !(establishment && establishment.hasOwnProperty(&quot;establishments&quot;) && establishment.establishments.length>0) && establishment.visualState.showPanel" class=hotelExtraDesc><div class=header><span class=title>{{title}}</span> <span class="sprite closeW closeInfoH">&nbsp;</span></div><div class=content><span ng-bind-html=establishment.description></span></div></div>'),a.put("js/partials/step_one/misc/modalMessage.html",'<div class=modal-body><div ng-repeat="message in messages" ng-show=message.show close=closeAlert($index)><span ng-bind-html=message.descriptionHtml></span></div></div><div class=modal-footer><button class="btn btn-primary" ng-click=ok()>OK</button></div>'),a.put("js/partials/step_one/misc/popover.html",'<div class="popover {{placement}}" ng-class="{ in: isOpen(), fade: animation() }" data-container=body><div class=arrow></div><div class=popover-inner style="background-color: #{{background}} !important"><h3 class=popover-title ng-bind=title ng-show=title></h3><div class=popover-content></div></div></div>'),a.put("js/partials/step_one/misc/reservation_button_popover.html",'<span class=nombreTooltip ng-bind-html=accommodation.accommodation.name></span> <span class=condicionesTooltip>{{ inventoryLine.configuration.name }} , {{ inventoryLine.mealPlan.name }} , {{ inventoryLine.condition.name }}</span> <span class=fechaTooltip>→{{ witbookerParams.regularParams.startDate| date : "dd MMM yy, EEE" | uppercase}}</span> <span class=fechaTooltip>←{{ witbookerParams.regularParams.endDate | date : "dd MMM yy, EEE" | uppercase}}</span> <span class=nocheTooltip>{{(witbookerParams.regularParams.endDate-witbookerParams.regularParams.startDate)/(1000*60*60*24) | number:0 }}&nbsp;<span translate="">trans.step1.inventoryline.nights</span></span>'),a.put("js/partials/step_one/misc/tracking_pixels.html","<script ng-if=isTripAdvisorActive>if (TAPixel !== null && typeof TAPixel === 'object') {\n	    TAPixel.impressionWithReferer(\"001F000000ukweA\");\n    }</script>"),a.put("js/partials/step_one/promotions_accordion.html",'<div><div accordion="" class="promotionsAccordion inner" ng-repeat="discount in discounts | orderObjectBy:\'order\' " ng-if=discount.active><div accordion-group=""><div accordion-heading=""><div class=entry-title ng-click=toggleAccordion(discount) ng-class={panelPromotionActive:hoverPromotion} ng-mouseenter="hoverPromotion=true" ng-mouseleave="hoverPromotion=false"><div class="title mainFontColor1"><span ng-bind-html=discount.name></span><div class=promoCodeLabelContainer><div ng-if=discount.promoCode ng-repeat="code in util.getDiscountActiveDiscountCodes(discount.promoCode,givenDiscounts)" style="display: inline"><span class="label label-success promoCodeLabel">{{code}}</span></div></div></div><div class=arrow-wrapper><i class="sprite arrowPromotion" ng-class="{ \'open\': discount.isOpen }">&nbsp;</i></div></div></div><div class=entry-content><p ng-if="discount.reduction && (discount.reduction*-1)>0"><span class=labelText translate="">trans.step1.promotions.reduction</span>: <span class=discount>{{discount.reduction | number:2}}{{discount.percentage? \'%\':\'\'}}</span></p><p ng-if="discount.reduction && (discount.reduction*-1)>0"><span class=labelText translate="">trans.step1.conditions</span>:</p><ul><li ng-if=discount.minStay class=valid ng-class="{invalid: discount.failedMinStay}"><span translate="">trans.minStay</span>:<span>{{discount.minStay}}</span></li><li ng-if=discount.maxStay class=valid ng-class="{invalid: discount.failedMaxStay}"><span translate="">trans.maxStay</span>:<span>{{discount.maxStay}}</span></li><li ng-if=discount.minNotice class=valid ng-class="{invalid: discount.failedMinNotice}"><span translate="">trans.minNotice</span>:<span>{{discount.minNotice}}</span></li><li ng-if=discount.maxNotice class=valid ng-class="{invalid: discount.failedMaxNotice}"><span translate="">trans.maxNotice</span>:<span>{{discount.maxNotice}}</span></li><li ng-if=discount.validPeriod class=valid ng-class="{invalid: discount.failedValid}"><span translate="">trans.validity</span>:<span>{{discount.validPeriod}}</span></li><li ng-if=discount.contractPeriod class=valid ng-class="{invalid: discount.failedContract}"><span translate="">trans.contract</span>:<span>{{discount.contractPeriod}}</span></li><li ng-if="discount.reduction && (discount.reduction*-1)>0"><span translate="">trans.accumulated</span>:<span translate="">trans.no</span></li></ul><span ng-bind-html=discount.description class=description></span></div></div></div></div>'),a.put("js/partials/step_one/result_list_tree.html",'<div accordion="" ng-if=isChain><div accordion-group=""><div accordion-heading=""><div ng-include="\'partials/step_one/establishment/hotel.html\'"></div></div><div ng-repeat="childEstablishment in establishment.establishments" ng-include="\'partials/step_one/result_list.html\'" ng-controller=establishmentCtrl></div></div></div><div accordion="" ng-if=!isChain><div accordion-group=""><div accordion-heading=""><div ng-include="\'partials/step_one/establishment/hotel.html\'" ng-controller=establishmentCtrl></div></div><div class=accommodation_list ng-include="constants.assetsDir+\'partials/step_one/establishment/accommodation_list.html\'"></div></div></div>'),a.put("js/partials/step_one/shopping_cart.html",'<div class=cartContainer><div class=addBook ng-show="size==constants.cart.largeSize" ng-click=goToStepOne()>«&nbsp;<span translate="">trans.step2.addAnotherBooking</span></div><div class="tabcart reservas holding right selected" title="{{\'trans.step1.cart.title\'|translate}}" style="display: block"><div class=cartQuantity><span class=reservasCarrito>{{cart.reservations.length}}</span><span class="sprite carrito"></span></div></div><div class=borderTab></div><div ng-if="size!=constants.cart.largeSize" ng-repeat="reservation in cart.reservations" class=reservationsList><div class=bookList ng-if="size!=constants.cart.largeSize"><div class=data><span class=name>{{reservation.quantity}}</span> <span class=por>x</span> <span class=name ng-bind-html=reservation.accommodation.name>&nbsp;</span> <span class="config block"><span>{{ reservation.startDate | date : "dd MMM" | uppercase}}</span> <span>&nbsp;>></span> <span>&nbsp;</span> <span>{{ reservation.endDate | date : "dd MMM" | uppercase}}</span> <span>&nbsp;>>&nbsp;</span> <span>{{(reservation.endDate-reservation.startDate)/(1000*60*60*24) | number:0 }}</span> <span translate="">trans.step1.inventoryline.nights</span></span></div><div class=actions><span class=rate><span class=amount><span class=integer>{{(reservation.rate+reservation.serviceRate) | currencyConverter : establishment | integerDigits}}</span> <span class=separator>,</span> <span class=decimal>{{(reservation.rate+reservation.serviceRate) | currencyConverter : establishment | fractionalDigits| number:2 | limitTo:-2}}</span></span></span> <span id=editbookingbutton_0 class="sprite close boton-eliminar" title="{{\'trans.step2.deleteBooking\'|translate}}" ng-click=removeReservation($index)>&nbsp;</span></div></div></div><div id=bookings_list ng-if="size==constants.cart.largeSize"><div ng-repeat="reservation in cart.reservations"><div class=reserva-carrito-paso2><table class="table table-reserva-carrito-paso2 es-carrito" cellpadding=0 cellspacing=0><tbody><tr class=fila-1><td><div class="celda1-paso2 datos-alojamiento"><span class="nombrehabitacion dp-bloque bookList"><span class=multiplicador></span> <span class=quantity>{{reservation.quantity}}</span> <span class=por>x</span> <span class=nombre-linea-1 ng-bind-html=reservation.accommodation.name>&nbsp;</span> <span class=noches><span>&nbsp;/&nbsp;</span> <span>{{(reservation.endDate-reservation.startDate)/(1000*60*60*24) | number:0 }}</span> <span translate="">trans.step1.inventoryline.nights</span></span> <span class=nombre-linea-2>{{ reservation.inventoryLine.configuration.name }}</span><div class=entrada><span class="arrival dp-bloque" translate="">trans.step2.entry</span>: <span>{{ reservation.startDate| date : "dd MMM yy, EEE" | uppercase}}</span></div><div class=salida><span class="departure dp-bloque" translate="">trans.step2.exit</span>: <span>{{ reservation.endDate| date : "dd MMM yy, EEE" | uppercase}}</span></div></span></div><div class="celda2-paso2 datos-rct"><div class=regimen><span translate="">trans.step2.mealPlan</span>: <span>{{ reservation.inventoryLine.mealPlan.name}}</span></div><div class=condic><span translate="">trans.step2.conditions</span>: <span>{{ reservation.inventoryLine.condition.name}}</span></div><div class=personas><span translate="">trans.step2.totalPersons</span>: <span>{{reservation.inventoryLine.capacity * reservation.quantity}}</span></div></div><div class=clearer></div></td><td class=celda3-paso2><i class="sprite close boton-eliminar" title="{{\'trans.step2.deleteBooking\'|translate}}" ng-click=removeReservation($index)></i></td></tr><tr class=fila-2><td class=celda1-paso2 colspan=4><div id=selectorextras__0_5 class="selectorextras selectorextras-0"><div class="ficha-config-v6 es-ficha es-ficha-disponible"><div class=ficha-config-der><table class=config-detalles><tbody><tr class="linea-precio-sin-descuento cuerpoContenedor {status-clase}"><td colspan=3 class=col1><table class=table-no-bordered><tbody><tr><td><span class=alojamientotxt translate="">trans.step2.accommodation</span></td></tr></tbody></table></td><td class="col3 totalSinDescuento"><span>{{((reservation.originalRate>0?reservation.originalRate:reservation.rate) | currencyConverter : establishment | integerDigits )}}</span><span class=separator>,</span><span>{{((reservation.originalRate>0?reservation.originalRate:reservation.rate)) | currencyConverter : establishment | fractionalDigits | number:2 | limitTo:-2}}</span></td></tr><tr ng-repeat="(discountTicker,amount) in reservation.inventoryLine.discounts" ng-if="discountTicker!=\'rackRate\'" ng-init="discount = establishment.discounts[discountTicker]" class="linea-promo cuerpoContenedor unicoCuerpoContenedor promo-seleccionada"><td colspan=3 class="col2 extraname extranopaddingbottom"><table class=table-no-bordered><tbody><tr><td><span class="extranametxt promocionesTexto" ng-bind-html=discount.name></span></td><td><span class="questioncontainer witbooker-tooltip-top"><span class="infoTooltip glyphicon glyphicon-info-sign" ng-click=openInfo(discount)></span>&nbsp;&nbsp;</span> <span class=enteros>-{{((amount*reservation.quantity/reservation.originalRate)*100) | number:2}}%</span></td></tr></tbody></table></td><td class="col3 extravalue"><span class=integer>-{{amount*reservation.quantity | currencyConverter : establishment | integerDigits }}</span> <span class=separator>,</span> <span class=decimal>{{amount*reservation.quantity | currencyConverter : establishment | fractionalDigits | number:2 | limitTo:-2}}</span></td></tr><tr class="linea-precio-sin-descuento cuerpoContenedor show-more-extras" ng-show="reservation.inventoryLine.services.length>0" ng-click="extrasFolded=!extrasFolded"><td colspan=3 class=col1><table class=table-no-bordered><tbody><tr><td><span class="sprite arrowExtras {{extrasFolded?\'open\':\'\'}}"></span> <span class=show-more-extras-txt translate="">trans.step2.extras</span></td></tr></tbody></table></td><td class="col3 extravalue totalSinDescuento"><span class="extrasPlegar importe-valor" ng-if="reservation.serviceRate>=0"><span class=integer>{{(reservation.serviceRate) | currencyConverter : establishment | integerDigits }}</span> <span class=separator>,</span> <span class=decimal>{{(reservation.serviceRate) | currencyConverter : establishment | fractionalDigits | number:2 | limitTo:-2}}</span></span></td></tr><tr ng-show=extrasFolded ng-repeat="serviceObject in reservation.inventoryLine.services  | orderBy:\'order\' " ng-init="service = services[serviceObject.ticker]" ng-if=services.hasOwnProperty(serviceObject.ticker) class="linea-extra cuerpoContenedor primerCuerpoContenedor" witbooking-service="" service=services[serviceObject.ticker] inventory-line=reservation.inventoryLine reservation=reservation establishment=establishment></tr></tbody></table></div></div></div></td></tr><tr class=fila-3><td colspan=4><div class=contenidoTotal><span class="total dp-bloque"><span class=importe-valor><span class=integer>{{(reservation.rate + reservation.serviceRate) | currencyConverter : establishment | integerDigits}}</span> <span class=separator>,</span> <span class=decimal>{{(reservation.rate + reservation.serviceRate) | currencyConverter : establishment | fractionalDigits | number:2 | limitTo:-2}}</span></span></span></div><div class=clearer></div></td></tr></tbody></table></div></div></div><div class=borderTab></div><div ng-show="cart.reservations.length>0" class="tabcart totalReservas reservas right selected" title="{{\'trans.step1.cart.title\'|translate}}" style="display: block"><div class=cartQuantity><div class=totalAmountTxtContainer><div class=totalTxt translate="">trans.step2.totalBooking</div><div class=taxTxt translate="">trans.step2.withTaxes</div></div><div class=totalAmountContainer><span class=rate><span class=amount><span class=integer>{{(cart.total) | currencyConverter : establishment | integerDigits}}</span> <span class=separator>,</span> <span class=decimal>{{(cart.total) | currencyConverter : establishment | fractionalDigits | number:2 | limitTo:-2}}</span></span></span> <span class=currency>{{witbookerParams.representation.currency}}</span></div></div></div><div ng-show="cart.reservations.length>0" class=clearer></div><div ng-if="size!=constants.cart.largeSize" ng-show="cart.reservations.length>0" class="btnCarritoReservar btn btn-success" ng-click=goToStepTwo() title="{{\'trans.step1.cart.title\'|translate}}"><span style="float: left">{{\'trans.step1.cart.title\'|translate}}&nbsp;<span class=forwardIcon>»</span></span></div></div>'),a.put("js/partials/step_one/stepOne.list.html",'<div ng-repeat="establishment in establishment.establishments | orderBy:[\'cheapestRate\',\'name\' ]:false" ng-include="constants.assetsDir+\'partials/step_one/stepOne.list.html\'"></div><div accordion="" class=hotelAccordion ng-if="!(establishment && establishment.hasOwnProperty(&quot;establishments&quot;) && establishment.establishments.length>0)\n && !(establishment.allFiltered && witbookerParams.representation.hideLocked &&  witbookerParams.representation.hideRestricted ) "><div accordion-group="" ng-class="{noHeader: !witbookerParams.representation.showEstablishmentAccordionHeader}" is-open={{establishment.isOpen}} ng-mouseenter="hover = true" ng-mouseleave="hover = false"><div accordion-heading="" ng-if=witbookerParams.representation.showEstablishmentAccordionHeader><div witbooking-establishment="" show-extra-desc=showExtraDesc witbooker-params=witbookerParams representation=representation util=util establishment=establishment ng-click=toggleAccordion(establishment)></div><div witbooking-info-panel-static="" ng-click=interceptClick($event) establishment=establishment title="\'description\'" type=establishment.visualState.panelType></div></div><div class=accommodation_list ng-include="constants.assetsDir+\'partials/step_one/establishment/accommodation_list.html\'"></div></div></div>'),a.put("js/partials/step_one/stepOne.map.html",'<div class=mainMapContainer><div class=mainMap witbooking-map="" establishment=establishment pins=pins mapid="\'main\'"></div></div>'),a.put("js/partials/step_two/customer_data_form.html",'<fieldset style=display:none><input type=hidden name=_method value=POST></fieldset><div class="headerDataForm letraColorOpuesto" translate="">trans.step2.personalData</div><div class=clearer></div><div witbooking-front-end-messages="" messages=establishment.sortedMessages[constants.messages.position.below_personal_info_step_2] establishment=establishment class=messagesContainer></div><div class=inputsForm><div class=form-group><input name=name class=form-control ng-class="{ \'input-error\' : form.submitted && form.name.$error.required }" ng-keydown=$parent.activateWithDummyData($event) id=reservationsName ng-model=customerData.name placeholder="* {{\'trans.step2.name\'|translate}}" required></div><div class=form-group><input name=surname class=form-control ng-class="{ \'input-error\' : form.submitted && form.surname.$error.required }" id=reservationsSurname ng-model=customerData.lastName placeholder="* {{\'trans.step2.surname\'|translate}}" required></div><div class=form-group><input type=email ng-pattern="/^[_a-z0-9]+(\\.[_a-z0-9]+)*@[a-z0-9-]+(\\.[a-z0-9-]+)*(\\.[a-z]{2,4})$/" ng-class="{ \'input-error\' : form.submitted &&(form.email.$error.required || form.email.$error.email  || form.email.$error.pattern)}" name=email class=form-control id=reservationsEmail ng-model=customerData.email placeholder="* {{\'trans.step2.email\'|translate}}" required></div><div class=form-group ng-if=bookingFormRepeatEmail><input type=email ng-pattern="/^[_a-z0-9]+(\\.[_a-z0-9]+)*@[a-z0-9-]+(\\.[a-z0-9-]+)*(\\.[a-z]{2,4})$/" ng-class="{ \'input-error\' : form.submitted &&(form.email2.$error.required || form.email2.$error.email  || form.email2.$error.pattern )}" name=email2 class=form-control id=reservationsEmail2 ng-model=customerData.confirmationMail placeholder="* {{\'trans.step2.repeatMail\'|translate}}" required></div><div class=form-group><input ng-if=bookingFormArrivalTime name=arrivalTime class=form-control ng-class="{ \'input-error\' : form.submitted && form.arrivalTime.$error.required }" id=reservationsArrivalTime ng-model=customerData.arrivalTime placeholder="* {{\'trans.step2.arrivalTime\'|translate}}" required></div><div class=checkbox ng-if=bookingFormNewsletter><input type=checkbox name=subscription ng-model=customerData.receiveOffers><strong translate="">trans.step2.receiveOffers</strong></div><div class=form-group ng-if=bookingFormDni><input name=passport class=form-control ng-class="{ \'input-error\' : form.submitted && form.passport.$error.required }" id=reservationsDNI ng-model=customerData.passport placeholder="* {{\'trans.step2.passport\'|translate}}" required></div><div class=form-group ng-if=bookingFormAddress><input name=address class=form-control ng-class="{ \'input-error\' : form.submitted && form.address.$error.required }" id=reservationsAddress ng-model=customerData.address placeholder="* {{\'trans.step2.address\'|translate}}" required></div><select ng-options="c.name for c in countries track by c.id" name=country default class=form-control initialvalue=País ng-model=customerData.country ng-class="{ \'input-error\' : form.submitted && form.country.$error.required }" ng-if=bookingFormCountry required><option value="" translate="">trans.step2.country</option></select><div class=form-group ng-if=bookingFormPhone><input name=phone class=form-control ng-class="{ \'input-error\' : form.submitted && form.phone.$error.required }" id=reservationsPhone placeholder="* {{\'trans.step2.phone\'|translate}}" ng-model=customerData.phone required></div><label for=reservationsComments translate="">trans.step2.comments</label><textarea class=form-control name=comments id=reservationsComments rows=5 ng-model=customerData.comments></textarea></div>'),a.put("js/partials/step_two/misc/modalOkClose.html",'<div class=modal-body><div translate="">{{message.body}}</div><div class=clearer></div></div><div class=modal-footer><button class="btn btn-success" ng-click=follow() translate="">ok</button> <button class="btn btn-danger" ng-click=closeInfo() translate="">trans.step2.close</button></div>'),a.put("js/partials/step_two/misc/popover_ccv.html",'<div class="creditcards ccv"></div>hola'),a.put("js/partials/step_two/payment/payment_type_form.html",'<div class=inputsForm><div ng-if="type==constants.payment.type.creditCard"><div class=textTopPaymentMethod translate="">trans.step2.ccCardText</div><br><div class=form-group><input name=ccholder class=form-control ng-class="{ \'input-error\' : form.submitted && form.ccholder.$error.required }" id=reservationsName placeholder="* {{\'trans.step2.cCHolder\'|translate}}" ng-model=paymentData.creditCardData.ccholder required></div><div class=row><select name=cckind class=form-control ng-options="c.name for c in creditCards track by c.id" id=reservationsCckind ng-model=paymentData.creditCardData.cckind ng-change=changePattern(paymentData.creditCardData.cckind)></select><div class="creditcards {{paymentData.creditCardData.cckind.id}}"></div></div><div class=form-group><input name=numbercard class=form-control ng-class="{ \'input-error\' : form.submitted && (form.numbercard.$error.required || form.numbercard.$error.pattern ) }" id=reservationsNumberCard placeholder="* {{\'trans.step2.cCNumber\'|translate}}" ng-model=paymentData.creditCardData.ccnumber ng-pattern=ccPattern required></div><div class=form-group ng-if=bookingFormCcv><input name=ccvcard class=form-control ng-class="{ \'input-error\' : form.submitted && form.ccvcard.$error.required }" id=reservationsCcvCard placeholder="* CCV/CCV2" ng-model=paymentData.creditCardData.ccsecuritycode required><button popover-placement=right popover-template={{constants.assetsDir+&quot;partials/step_two/misc/popover_ccv.html&quot;}} popover-append-to-body=true class="btn btn-xs">info</button></div><label class=validTo>*<span translate="">trans.step2.validUntil</span></label><div class=form-group><select name=ccvalidtomonth ng-options="item.Value as item.Name for item  in months" class=form-control ng-class="{ \'input-error\' : form.submitted && form.ccvalidtomonth.$error.required }" id=reservationsCcvalidMoth ng-model=paymentData.creditCardData.ccvalidtomonth required><option value="">-{{\'trans.step2.month\'|translate}}-</option></select><select name=ccvalidtoyear ng-options="item.Value as item.Name for item in years" class=form-control ng-class="{ \'input-error\' : form.submitted && form.ccvalidtoyear.$error.required }" id=reservationsCcvalidYear ng-model=paymentData.creditCardData.ccvalidtoyear required><option value="">-{{\'trans.step2.year\'|translate}}-</option></select></div></div><div ng-if="type==constants.payment.type.transfer"><div class=textTopPaymentMethod>{{transferData.message}}</div><br><div ng-if="witbookerParams.representation.transferAvailabilityHold>0"><span translate="">trans.step2.bankTransferDescription1</span> <span translate="">{{witbookerParams.representation.transferAvailabilityHold}}</span> <span translate="">trans.step1.inventoryline.unavailable.value.hours</span>.<br><span translate="">trans.step2.bankTransferDescription2</span>.<span translate="">trans.step2.bankTransferDescription1NoHold</span></div><div ng-if="witbookerParams.representation.transferAvailabilityHold<=0"><span translate="">trans.step2.bankTransferDescription1NoHold</span></div></div><div ng-if="type==constants.payment.type.tctoken||type==constants.payment.type.tpvtoken"><div class=textTopPaymentMethod translate="">trans.step2.tctokenText</div></div><div ng-if="type==constants.payment.type.paypal_ec"><div class=textTopPaymentMethod translate="">trans.step2.paypalText</div></div><div ng-if="type==constants.payment.type.pointOfSale"><span translate="">trans.step2.pointOfSaleDescription</span>&nbsp;<span ng-repeat="card in creditCards">{{card.name}}{{$last ? \'.\' : \', \'}}</span></div></div>'),a.put("js/partials/step_two/payment/payment_type_header.html",'<div ng-if="type==constants.payment.type.creditCard"><div class="alert alert-info messagesTwo"><button type=button class=close data-dismiss=alert>×</button><p><span translate="">trans.step2.creditCardHeader1</span>.&nbsp;</p></div><div class=mensajeverdeTC><p><span translate="">trans.step2.creditCardHeader2</span> <a href=http://micho.local/v6/select/hoteldemo.com.v6/es/reservationsv6/generalconditions target=_blank id=legalterms3><span translate="">trans.step2.serviceConditions2</span></a></p></div></div><div ng-if="type==constants.payment.type.transfer"></div><div ng-if="type==constants.payment.type.pointOfSale"><span translate="">trans.step2.pointOfSaleHeader1</span> <span>100.00%</span> <span translate="">trans.step2.pointOfSaleHeader2</span></div>'),a.put("js/partials/step_two/payment_data_form.html",'<div class="headerDataForm letraColorOpuesto" translate="">trans.step2.paymentMethod</div><div class=clearer></div><div witbooking-front-end-messages="" messages=establishment.sortedMessages[constants.messages.position.top_method_payment_step_2] establishment=establishment class=messagesContainer></div><div witbooking-payment-type-header="" type=type></div><div ng-repeat="availablePaymentType in availablePaymentTypes"><div class=radioPayment ng-class="{ \'justOne\' : availablePaymentTypes.length==1 }"><label><input type=radio ng-model=$parent.ptype ng-value=availablePaymentType><span ng-if="availablePaymentType!=constants.payment.type.paypal_ec && availablePaymentType!=constants.payment.type.paypal_std" translate="">trans.step2.{{availablePaymentType}}</span> <img ng-if="availablePaymentType==constants.payment.type.paypal_ec" src=https://www.paypalobjects.com/webstatic/mktg/logo/pp_cc_mark_37x23.jpg border=0 alt="PayPal Logo"></label></div><div ng-if="availablePaymentType==$parent.ptype" witbooking-payment-type-form="" form=form payment-data=paymentData type=$parent.ptype></div></div><div class=inputsForm><div class=form-group><div class=acceptConditions ng-class="{\'input-error\': form.submitted  && form.acceptconditions.$error.required}" required><div class=checkbox><input type=checkbox name=acceptconditions ng-model=paymentData.acceptconditions required><span class=checkboxTxt><strong><span translate="">trans.step2.acceptConditions</span> <a ng-click=openInfo() class=legalTerm><span translate="">trans.step2.conditionsOfService</span></a></strong></span></div></div><div class=checkFieldsRed ng-class="{\'input-error\': form.submitted && !form.$valid}" ng-if="form.submitted && !form.$valid"><i class="glyphicon glyphicon-info-sign"></i>&nbsp;<span translate="">trans.step2.checkFieldsRed</span></div><div class="paymentDetails defaultCurrency" ng-if="witbookerParams.representation.currency!==witbookerParams.representation.defaultCurrency"><div class=prePay><span translate="">trans.step2.deposit</span>&nbsp;(<span class=percentPrePay>{{cart.depositPercentage | number:2}}</span>%):&nbsp;<span class=pricePrePay>{{cart.depositAmount | currencyConverter : establishment | number:2}}</span>&nbsp;<span class=coin>{{witbookerParams.representation.currency}}</span></div><div class=totalPay><span translate="">trans.step2.totalTaxesIncluded</span>:&nbsp;<span class=totelPrice>{{cart.total | currencyConverter : establishment | number:2}}</span>&nbsp;<span class=coin>{{witbookerParams.representation.currency}}</span></div><span class=message>*<span translate="">trans.step2.merelyInformative</span>&nbsp;{{witbookerParams.representation.defaultCurrency}}</span></div><div class=paymentDetails><div class=prePay><span translate="">trans.step2.deposit</span>&nbsp;(<span class=percentPrePay>{{cart.depositPercentage | number:2}}</span>%):&nbsp;<span class=pricePrePay>{{cart.depositAmount | number:2}}</span>&nbsp;<span class=coin>{{witbookerParams.representation.defaultCurrency}}</span></div><div class=totalPay><span translate="">trans.step2.totalTaxesIncluded</span>:&nbsp;<span class=totelPrice>{{cart.total | number:2}}</span>&nbsp;<span class=coin>{{witbookerParams.representation.defaultCurrency}}</span></div></div><input type=hidden name=data[Reservations][reservationType] value=1 id=ReservationsReservationType><input type=hidden name=data[Reservations][ccCiCreditCard] value=0 id=ReservationsCcCiCreditCard><input type=hidden name=data[Reservations][ccpin] value=0 id=ReservationsCcpin><input type=hidden name=data[Reservations][confirmBooking] value=1 id=ReservationsConfirmBooking><input type=hidden name=data[Reservations][stage] value=3 id=ReservationsStage><div id=finalBookingBtns><div class=confirm><button id=confirmButton class="btn btn-succes" type=submit ng-click="form.submitted=true;submitPaymentDataForm()"><span translate=trans.step2.confirm></span></button></div><div class=addBooking><button class="btn btn-default" type=button ng-click=goToStepOne()><span class="glyphicon glyphicon-plus-sign"></span></button> <span class=help-block translate="">trans.step2.addAnotherBooking</span></div></div><div class=clearer></div></div><script>$(document).ready(function() {\n            $(\'#button_confirm_booking\').click(function(){\n                $(\'.formulario_datos form\').submit();\n            });\n        });</script></div>'),a.put("js/partials/step_two/service_row.html",'<td class="col0 serviceImage" ng-class="{\'serviceSelected\':isSelected}"><div ng-if="service.media.length>0" class=extraImg ng-click=openInfo(service)><img ng-src={{service.thumbnail}} fallback-src=""><div class=extraImgHover></div></div></td><td class="col1 extraname extracontrol" ng-class="{\'serviceSelected\':isSelected}"><input ng-if="service.type!=constants.serviceType.units && service.obligatory==false" ng-model=inventoryLine.selectedServices[service.ticker].selected type=checkbox><select ng-if="service.type==constants.serviceType.units" ng-model=inventoryLine.selectedServices[service.ticker].units ng-options="option.availability for option in unitSelectorOptions"></select></td><td class="col2 extraname extranopadding" ng-class="{\'serviceSelected\':isSelected}"><table class=table-no-bordered><tbody><tr><td><span class=extranametxt>{{service.name}}</span></td><td><span class="questioncontainer witbooker-tooltip-top"><span class="infoTooltip glyphicon glyphicon-info-sign" ng-click=openInfo(service)></span>&nbsp;&nbsp;</span> <span class=precioUnitario ng-if="service.rate>0"><span class=integer>{{(service.rate) | currencyConverter : establishment | integerDigits }}</span> <span class=separator>,</span> <span class=decimal>{{(service.rate) | currencyConverter : establishment | fractionalDigits | number:2 | limitTo:-2}}</span> <span>&nbsp;{{service.specification}}</span></span></td></tr></tbody></table></td><td class="col3 extravalue" ng-class="{\'serviceSelected\':isSelected}"><span class=importe-valor><span class=integer>{{(rate) | currencyConverter : establishment | integerDigits }}</span> <span class=separator>,</span> <span class=decimal>{{(rate) | currencyConverter : establishment | fractionalDigits | number:2 | limitTo:-2}}</span></span></td>')}]);var witbookerServices=angular.module("witbookerServices",["ngResource"]),ESTABLISHMENT_RESOURCE_URL="/WitBooker/base/getEstablishmentData",ESTABLISHMENT_LOCALIZED_RESOURCE_URL="/WitBooker/base/createEstablishmentLocalizedData",UPDATE_SESSION_URL="/WitBooker/base/updateSessionAsync",AVAILABILITY_RESOURCE_URL="/WitBooker/base/calculateAvailability",CURRENCY_CONVERSION_RATE="/WitBooker/base/updateCurrencyConversionRate",CHART_RESOURCE_URL="/WitBooker/base/chart",STATIC_ROOT_URL=MAIN_STATIC_ROOT_URL,LEGACY_BOOKING_URL=URL_WITBOOKER_V6+"select/",SHOPPING_CART_URL="/WitBooker/base/addToCart",REMOVE_SHOPPING_CART_URL="/WitBooker/base/removeFromCart",STEP1_URL=URL_WITBOOKER_V6+"select/TICKERPLACEHOLDER/LANGUAGEPLACEHOLDER/reservationsv6/step1",STEP2_URL=URL_WITBOOKER_V6+"select/TICKERPLACEHOLDER/LANGUAGEPLACEHOLDER/reservationsv6/step2#/stepTwo/TICKERPLACEHOLDER/",SHOPPING_CART_DATA_URL="/WitBooker/stepTwo/obtainReservationInformation",UPDATE_CART_DATA_URL="/WitBooker/stepTwo/updateReservation",STEP2_CREDITCARD_URL=URL_WITBOOKER_V6+"select/TICKERPLACEHOLDER/es/reservationsv6/step2",STEP2_POINTOFSALE_URL=URL_WITBOOKER_V6+"select/TICKERPLACEHOLDER/es/reservationsv6/step2",STEP2_PROCESS_RESERVATION_URL="/WitBooker/stepTwo/reservation",STEP2_PAYPAL_EXPRESS_CHECKOUT="/WitBooker/payment/payPalExpressCheckout",STEP2_SIPAY="/WitBooker/payment/sipay?ticker=TICKERPLACEHOLDER#/main/LANGUAGEPLACEHOLDER/",STEP2_SIPAY_INIT="/WitBooker/payment/sipayInit",STEP2_SIPAY_CHECK_RESERVATION_STATUS="/WitBooker/payment/sipayReservationStatus",STEP3_TPV_URL=URL_WITBOOKER_V6+"select/TICKERPLACEHOLDER/LANGUAGEPLACEHOLDER/reservationsv6/procesarpago/IDPLACEHOLDER/java",STEP3_CONFIRMATION_URL=URL_WITBOOKER_V6+"select/TICKERPLACEHOLDER/LANGUAGEPLACEHOLDER/reservationsv6/confirmation/IDPLACEHOLDER/java",STEP2_RESERVATION_URL=URL_WITBOOKER_V6+"select/TICKERPLACEHOLDER/LANGUAGEPLACEHOLDER/reservationsv6/step2#/stepTwo/TICKERPLACEHOLDER",BookingFormExtraFilter=function(a){
angular.extend(this,a)};BookingFormExtraFilter.prototype.getLocalizedData=function(a){var b=this.localization.hasOwnProperty(a)?this.localization[a]:this.localization.defaultLocale;return b};var api=function(a){var b=a(ESTABLISHMENT_RESOURCE_URL,{},{get:{method:"GET",cache:!0},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},"delete":{method:"DELETE"}}),c=a(ESTABLISHMENT_LOCALIZED_RESOURCE_URL,{},{get:{method:"GET",cache:!0},save:{method:"POST"},post:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},"delete":{method:"DELETE"}}),d=a(CHART_RESOURCE_URL,{},{get:{method:"GET",cache:!0},save:{method:"POST"},post:{method:"POST",cache:!0},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},"delete":{method:"DELETE"}}),e=a(AVAILABILITY_RESOURCE_URL,{},{get:{method:"GET"},save:{method:"POST"},post:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},"delete":{method:"DELETE"}});return b.prototype.testMethod=function(){return""},{Establishment:b,Chart:d,ARI:e,LocalizedData:c}};witbookerServices.factory("Api",["$resource",api]);var util=function(a,b,c){var d={};return d.entityLevel={},d.entityLevel.hotel="establecimientos",d.entityLevel.accommodation="tiposalojamiento",d.entityLevel.extra="extras",d.addLoading=function(a){var b=$(a),c=document.createElement("div");c.setAttribute("id","spinnerContainer"),c.setAttribute("class","spinnerContainer"),b.append(c);(new Spinner).spin(c)},d.removeLoading=function(a){var b=document.getElementById("spinnerContainer");b&&b.parentNode&&b.parentNode.removeChild(b)},d.intersectSimpleArrays=function(a,b,c){c||(c=function(a){return a});for(var d=[],e=a.slice(0),f=b.slice(0),g=e.length-1,h=f.length-1;g>=0&&h>=0;)c(e[g])>c(f[h])?(e.pop(),g--):c(e[g])<c(f[h])?(f.pop(),h--):(d.push(e.pop()),f.pop(),g--,h--);return d},d.generateStep3URL=function(a,b,c,d){var e=a;return e=e.replace(new RegExp("TICKERPLACEHOLDER","g"),b),e=e.replace(new RegExp("LANGUAGEPLACEHOLDER","g"),c),e=e.replace(new RegExp("IDPLACEHOLDER","g"),d)},d.getDiscountActiveDiscountCodes=function(a,b){if("undefined"==typeof a)return[];var c=[];return angular.forEach(b,function(b,d){-1!=a.indexOf(b)&&c.push(b)}),c},d.isCodeActive=function(a,b){var c=[];return angular.forEach(givenCodes,function(a,d){1!=b.indexOf(a)&&c.push(a)}),c},d.generateImgUrl=function(a,b,c,e,f){if("undefined"==typeof e||!e)return STATIC_ROOT_URL+"NoPhoto.jpg";var g=e.lastIndexOf("."),h=e.substr(0,g),i=e.substr(g),j="";if(f&&(f.width||f.height)){var k=f.height?f.height:f.width,l=f.width?f.width:f.height;j=STATIC_ROOT_URL+a.ticker+"/"+d.entityLevel[c]+"/"+b.id+"/"+h+"_"+l+"x"+k+i}else j=STATIC_ROOT_URL+a.ticker+"/"+d.entityLevel[c]+"/"+b.id+"/"+e;return j},d.removeDuplicatesFromSimpleArray=function(a){for(var b=[],c=0,d=a.length;d>c;c++)-1===b.indexOf(a[c])&&b.push(a[c]);return b},d.imgError=function(a){console.log(a.attr("src")),console.log(a),console.log(this)},d.generateConditionsUrl=function(a){return LEGACY_BOOKING_URL+"select/"+a.ticker+"/es/reservationsv6/generalconditions"},d.generateLogoUrl=function(a){return STATIC_ROOT_URL+a.ticker+"/logo/"+a.id+"/"+a.logo.path},d.generateHotelUrl=function(a,b){return a&&b?a:""},d.generateLegacyBookingUrl=function(a,b,c){var d=LEGACY_BOOKING_URL+a.ticker+"/"+b+"/reservationsv6/addToCart?";return angular.forEach(c,function(a,b){d+=encodeURIComponent(b)+"="+encodeURIComponent(a)+"&"}),d},d.attachGetParams=function(a,b){var c=a.substring(-1===a.indexOf("#")?a.length:a.indexOf("#"),a.length);a=a.substring(0,-1===a.indexOf("#")?a.length:a.indexOf("#")),a+=a.indexOf("?")<0?"?":"";var d=!0;return angular.forEach(b,function(b,c){d=!1,a+=encodeURIComponent(c)+"="+encodeURIComponent(b)+"&"}),d?a+c:a.slice(0,-1)+c},d.createLegacyParamsObject=function(a){var b={};return a.channel&&(b.channel=a.channel),a.tracking_id&&(b.tracking_id=a.tracking_id),a.view&&(b.view=a.view),a.iframeMode&&(b.witif=a.iframeMode?1:0),a.iframeResizeDomain&&(b.d=a.iframeResizeDomain),a.witaffiliate&&(b.witaffiliate=a.witaffiliate),a.affiliate&&(b.affiliate=a.affiliate),b},d.getIntegerDigits=function(a){return 0>a?Math.ceil(a):Math.floor(a)},d.getFractionalDigits=function(a){return a-d.getIntegerDigits(a)},d.parseDate=function(a){var b=a.split("-");return new Date(b[2],b[1]-1,b[0])},d.formatDate=function(b,c){return a("date")(b,c)},d.setEstablishmentsProperties=function(a,b){a.hasOwnProperty("establishments")?angular.forEach(a.establishments,function(a,c){d.setEstablishmentsProperties(a,b)}):angular.forEach(b,function(b,c){a[c]=b})},d.setAccommodationsIsOpenProperty=function(a,b,c){a.hasOwnProperty("establishments")?angular.forEach(a.establishments,function(a,e){d.setAccommodationsIsOpenProperty(a,b,c)}):angular.forEach(a.inventoryLinesGrouped,function(a,d){a.inventoryLine.length<=b?a.isOpen=!0&&c:a.isOpen=!1})},d.parseQueryString=function(a){var b=a.slice(1).split("&"),c={};return angular.forEach(b,function(a,b){a=a.split("="),c[a[0]]=decodeURIComponent(a[1]||"")}),JSON.parse(JSON.stringify(c))},d.countOwnProperties=function(a){var b=0;for(var c in a)a.hasOwnProperty(c)&&++b;return b},d.isNumber=function(a){return!isNaN(parseFloat(a))&&isFinite(a)},d.setInventoryLineRates=function(a,b,c,e){var f=["totalRate","averageRate","originalRate","rackRate","firstNightCost"],g=["cheapestRate"],h=["cheapestRate"],i=["reduction"],j=["rate"],k=["rate","originalRate"],l=["total"];if(a.hasOwnProperty("establishments"))angular.forEach(a.establishments,function(a,b){d.setInventoryLineRates(a)});else{if(angular.forEach(h,function(c,e){a.hasOwnProperty(c)&&d.isNumber(a[c])&&(a[c]*=b)}),angular.forEach(a.discounts,function(a,c){angular.forEach(i,function(c,e){a.hasOwnProperty(c)&&d.isNumber(a[c])&&a.percentage&&(a[c]*=b)})}),c&&angular.forEach(c,function(a,c){angular.forEach(j,function(c,e){a.hasOwnProperty(c)&&d.isNumber(a[c])&&(a[c]*=b)})}),e&&e.reservations){angular.forEach(l,function(a,c){e.hasOwnProperty(a)&&d.isNumber(e[a])&&(e[a]*=b)});var m=e.reservations;angular.forEach(m,function(a,c){angular.forEach(k,function(c,e){a.hasOwnProperty(c)&&d.isNumber(a[c])&&(a[c]*=b)})})}angular.forEach(a.inventoryLinesGrouped,function(a,c){var e=a.accommodation;angular.forEach(g,function(a,c){e.hasOwnProperty(a)&&d.isNumber(e[a])&&(e[a]*=b)}),angular.forEach(a.inventoryLine,function(a,c){angular.forEach(f,function(c,e){a.hasOwnProperty(c)&&d.isNumber(a[c])&&(a[c]*=b)})})})}},d.setInventoryLineProperty=function(a,b,c,e,f){a.hasOwnProperty("establishments")?angular.forEach(a.establishments,function(a,b){d.setInventoryLineProperty(a)}):angular.forEach(a.inventoryLinesGrouped,function(a,d){angular.forEach(a.inventoryLine,function(a,d){var g=function(a){var b=!1;return angular.forEach(a.errorMessage,function(a,c){"reservationClosed"==a.failedFilter&&(b=!0)}),b};a.ticker==b&&(a.errorMessage.length<=0||g(a))&&("+1"==e?(a[c]+=f.quantity,a.errorMessage=[]):"-1"==e?(a[c]-=f.quantity,a[c]<=0&&(a.errorMessage?a.errorMessage.push({failedFilter:"reservationClosed"}):a.errorMessage=[{failedFilter:"reservationClosed"}])):a[c]=e)})})},d.updateChildrenAndParentInventories=function(a,b,c,e,f,g,h){var i=c.inventoryRelations.parentOfTicker[e.inventoryLine.ticker],j=c.inventoryRelations.childrenOfTicker[i],k=c.inventoryLinesGrouped.filter(function(a){return a.accommodation.ticker===e.accommodation.ticker})[0].inventoryLine.map(function(a){return a.ticker});if(b>e.startDate&&a<e.endDate){if(angular.forEach(j,function(a,b){d.setInventoryLineProperty(c,a,"availability",f,e)}),!g)return;"-1"===f?h(d.changeAccommodationDisplayedPrice(k,c,!1)):"+1"===f&&h(d.changeAccommodationDisplayedPrice(k,c,!0))}},d.changeAccommodationDisplayedPrice=function(a,b,c){var d={},e=!1,f=0;return angular.forEach(a,function(g,h){angular.forEach(b.inventoryLinesGrouped,function(b,h){angular.forEach(b.inventoryLine,function(h,i){h.ticker==g&&h.availability<=0&&(f++,f===a.length&&(d[b.accommodation.ticker]=!0),e=!0),h.ticker==g&&1==h.availability&&c&&(d[b.accommodation.ticker]=!1,e=!0)})})}),e?d:null},d.setInventoryLinesGrouped=function(a,b){a.hasOwnProperty("establishments")?(angular.forEach(a.establishments,function(a,c){d.setInventoryLinesGrouped(a,b)}),a.errorMessages=b.errorMessages,a.discounts=b.discounts,a.allFiltered=b.allFiltered,a.allRestricted=b.allRestricted):(a.inventoryLinesGrouped=b[a.ticker].inventoryLinesGrouped,a.cheapestRate=b[a.ticker].cheapestRate,a.discounts=b[a.ticker].discounts,a.errorMessages=b[a.ticker].errorMessages,a.allFiltered=b[a.ticker].allFiltered,a.allRestricted=b[a.ticker].allRestricted,a.activeDiscounts=b[a.ticker].activeDiscounts)},d.getInventoryLineByTicker=function(a,b){var c={inventories:{},accommodation:{},services:{}};if(!a.hasOwnProperty("establishments")){var e=c.inventories,f=c.accommodation,g=c.services;return e[a.ticker]={},f[a.ticker]={},g[a.ticker]={},angular.forEach(a.services,function(c,d){"[object Array]"===Object.prototype.toString.call(b)?angular.forEach(b,function(b,e){b===d&&(g[a.ticker][d]=c)}):b===d&&(g[a.ticker][d]=c)}),angular.forEach(a.inventoryLinesGrouped,function(c,d){var g=c.accommodation;"[object Array]"===Object.prototype.toString.call(b)?angular.forEach(b,function(b,c){b===g.ticker&&(f[a.ticker][g.ticker]=g)}):b===g.ticker&&(f[a.ticker][g.ticker]=g),angular.forEach(c.inventoryLine,function(c,d){"[object Array]"===Object.prototype.toString.call(b)?angular.forEach(b,function(b,d){b===c.ticker&&(e[a.ticker][c.ticker]=c)}):b===c.ticker&&(e[a.ticker][c.ticker]=c)})}),c}return angular.forEach(a.establishments,function(a,b){angular.extend(c,d.getInventoryLineByTicker(a))}),c},d.getInventoryLinesID=function(a){var b={};return a.hasOwnProperty("establishments")?(angular.forEach(a.establishments,function(a,c){angular.extend(b,d.getInventoryLinesID(a))}),b):(b[a.ticker]=[],angular.forEach(a.inventoryLinesGrouped,function(c,d){angular.forEach(c.inventoryLine,function(c,d){b[a.ticker].push(c.ticker)})}),b)},d.getDiscountsID=function(a){var b={};return b[a.ticker]=[],angular.forEach(a.discounts,function(c,d){b[a.ticker].push(c.ticker)}),b},d.calculateServiceRate=function(a,b,c,d,e,f){var g=a.daily?e:1;return a.type==f.serviceType.units?a.rate*d*g:a.type==f.serviceType.room?a.rate*c*g:a.type==f.serviceType.person?a.rate*b*g*c:void 0},d.setGetParameter=function(a,c){var d=window.location.href,e="";if(d.indexOf("#")>=0&&(e=d.substring(d.indexOf("#")),d=d.substring(0,d.indexOf("#"))),d.indexOf(a+"=")>=0){var f=d.substring(0,d.indexOf(a)),g=d.substring(d.indexOf(a));g=g.substring(g.indexOf("=")+1),g=g.indexOf("&")>=0?g.substring(g.indexOf("&")):"",d=f+a+"="+c+g}else d+=d.indexOf("?")<0?"?"+a+"="+c:"&"+a+"="+c;return d+=e,b.location.href=d,!1},d.loadLocales=function(a){var b={ar:{DATETIME_FORMATS:{AMPMS:["ص","م"],DAY:["الأحد","الاثنين","الثلاثاء","الأربعاء","الخميس","الجمعة","السبت"],MONTH:["يناير","فبراير","مارس","أبريل","مايو","يونيو","يوليو","أغسطس","سبتمبر","أكتوبر","نوفمبر","ديسمبر"],SHORTDAY:["الأحد","الاثنين","الثلاثاء","الأربعاء","الخميس","الجمعة","السبت"],SHORTMONTH:["يناير","فبراير","مارس","أبريل","مايو","يونيو","يوليو","أغسطس","سبتمبر","أكتوبر","نوفمبر","ديسمبر"],fullDate:"EEEE، d MMMM، y",longDate:"d MMMM، y",medium:"dd‏/MM‏/yyyy h:mm:ss a",mediumDate:"dd‏/MM‏/yyyy",mediumTime:"h:mm:ss a","short":"d‏/M‏/yyyy h:mm a",shortDate:"d‏/M‏/yyyy",shortTime:"h:mm a"},NUMBER_FORMATS:{CURRENCY_SYM:"£",DECIMAL_SEP:"٫",GROUP_SEP:"٬",PATTERNS:[{gSize:0,lgSize:0,macFrac:0,maxFrac:3,minFrac:0,minInt:1,negPre:"",negSuf:"-",posPre:"",posSuf:""},{gSize:0,lgSize:0,macFrac:0,maxFrac:2,minFrac:2,minInt:1,negPre:"¤ ",negSuf:"-",posPre:"¤ ",posSuf:""}]},id:"ar",pluralCat:function(a){return 0==a?PLURAL_CATEGORY.ZERO:1==a?PLURAL_CATEGORY.ONE:2==a?PLURAL_CATEGORY.TWO:a==(0|a)&&a%100>=3&&10>=a%100?PLURAL_CATEGORY.FEW:a==(0|a)&&a%100>=11&&99>=a%100?PLURAL_CATEGORY.MANY:PLURAL_CATEGORY.OTHER}},ca:{DATETIME_FORMATS:{AMPMS:["a.m.","p.m."],DAY:["diumenge","dilluns","dimarts","dimecres","dijous","divendres","dissabte"],MONTH:["de gener","de febrer","de març","d’abril","de maig","de juny","de juliol","d’agost","de setembre","d’octubre","de novembre","de desembre"],SHORTDAY:["dg.","dl.","dt.","dc.","dj.","dv.","ds."],SHORTMONTH:["de gen.","de febr.","de març","d’abr.","de maig","de juny","de jul.","d’ag.","de set.","d’oct.","de nov.","de des."],fullDate:"EEEE d MMMM 'de' y",longDate:"d MMMM 'de' y",medium:"dd/MM/yyyy H:mm:ss",mediumDate:"dd/MM/yyyy",mediumTime:"H:mm:ss","short":"dd/MM/yy H:mm",shortDate:"dd/MM/yy",shortTime:"H:mm"},NUMBER_FORMATS:{CURRENCY_SYM:"€",DECIMAL_SEP:",",GROUP_SEP:".",PATTERNS:[{gSize:3,lgSize:3,macFrac:0,maxFrac:3,minFrac:0,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""},{gSize:3,lgSize:3,macFrac:0,maxFrac:2,minFrac:2,minInt:1,negPre:"(¤",negSuf:")",posPre:"¤",posSuf:""}]},id:"ca",pluralCat:function(a){return 1==a?PLURAL_CATEGORY.ONE:PLURAL_CATEGORY.OTHER}},de:{DATETIME_FORMATS:{AMPMS:["vorm.","nachm."],DAY:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],MONTH:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],SHORTDAY:["So.","Mo.","Di.","Mi.","Do.","Fr.","Sa."],SHORTMONTH:["Jan","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],fullDate:"EEEE, d. MMMM y",longDate:"d. MMMM y",medium:"dd.MM.yyyy HH:mm:ss",mediumDate:"dd.MM.yyyy",mediumTime:"HH:mm:ss","short":"dd.MM.yy HH:mm",shortDate:"dd.MM.yy",shortTime:"HH:mm"},NUMBER_FORMATS:{CURRENCY_SYM:"€",DECIMAL_SEP:",",GROUP_SEP:".",PATTERNS:[{gSize:3,lgSize:3,macFrac:0,maxFrac:3,minFrac:0,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""},{gSize:3,lgSize:3,macFrac:0,maxFrac:2,minFrac:2,minInt:1,negPre:"-",negSuf:" ¤",posPre:"",posSuf:" ¤"}]},id:"de",pluralCat:function(a){return 1==a?PLURAL_CATEGORY.ONE:PLURAL_CATEGORY.OTHER}},en:{DATETIME_FORMATS:{AMPMS:["AM","PM"],DAY:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],MONTH:["January","February","March","April","May","June","July","August","September","October","November","December"],SHORTDAY:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],SHORTMONTH:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],fullDate:"EEEE, MMMM d, y",longDate:"MMMM d, y",medium:"MMM d, y h:mm:ss a",mediumDate:"MMM d, y",mediumTime:"h:mm:ss a","short":"M/d/yy h:mm a",shortDate:"M/d/yy",shortTime:"h:mm a"},NUMBER_FORMATS:{CURRENCY_SYM:"$",DECIMAL_SEP:".",GROUP_SEP:",",PATTERNS:[{gSize:3,lgSize:3,macFrac:0,maxFrac:3,minFrac:0,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""},{gSize:3,lgSize:3,macFrac:0,maxFrac:2,minFrac:2,minInt:1,negPre:"(¤",negSuf:")",posPre:"¤",posSuf:""}]},id:"en",pluralCat:function(a){return 1==a?PLURAL_CATEGORY.ONE:PLURAL_CATEGORY.OTHER}},es:{DATETIME_FORMATS:{AMPMS:["a.m.","p.m."],DAY:["domingo","lunes","martes","miércoles","jueves","viernes","sábado"],MONTH:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],SHORTDAY:["dom","lun","mar","mié","jue","vie","sáb"],SHORTMONTH:["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"],fullDate:"EEEE, d 'de' MMMM 'de' y",longDate:"d 'de' MMMM 'de' y",medium:"dd/MM/yyyy HH:mm:ss",mediumDate:"dd/MM/yyyy",mediumTime:"HH:mm:ss","short":"dd/MM/yy HH:mm",shortDate:"dd/MM/yy",shortTime:"HH:mm"},NUMBER_FORMATS:{CURRENCY_SYM:"€",DECIMAL_SEP:",",GROUP_SEP:".",PATTERNS:[{gSize:3,lgSize:3,macFrac:0,maxFrac:3,minFrac:0,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""},{gSize:3,lgSize:3,macFrac:0,maxFrac:2,minFrac:2,minInt:1,negPre:"-",negSuf:" ¤",posPre:"",posSuf:" ¤"}]},id:"es",pluralCat:function(a){return 1==a?PLURAL_CATEGORY.ONE:PLURAL_CATEGORY.OTHER}},fr:{DATETIME_FORMATS:{AMPMS:["AM","PM"],DAY:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],MONTH:["janvier","février","mars","avril","mai","juin","juillet","août","septembre","octobre","novembre","décembre"],SHORTDAY:["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],SHORTMONTH:["janv.","févr.","mars","avr.","mai","juin","juil.","août","sept.","oct.","nov.","déc."],fullDate:"EEEE d MMMM y",longDate:"d MMMM y",medium:"d MMM y HH:mm:ss",mediumDate:"d MMM y",mediumTime:"HH:mm:ss","short":"dd/MM/yy HH:mm",shortDate:"dd/MM/yy",shortTime:"HH:mm"},NUMBER_FORMATS:{CURRENCY_SYM:"€",DECIMAL_SEP:",",GROUP_SEP:" ",PATTERNS:[{gSize:3,lgSize:3,macFrac:0,maxFrac:3,minFrac:0,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""},{gSize:3,lgSize:3,macFrac:0,maxFrac:2,minFrac:2,minInt:1,negPre:"(",negSuf:" ¤)",posPre:"",posSuf:" ¤"}]},id:"fr",pluralCat:function(a){return a>=0&&2>=a&&2!=a?PLURAL_CATEGORY.ONE:PLURAL_CATEGORY.OTHER}},it:{DATETIME_FORMATS:{AMPMS:["m.","p."],DAY:["domenica","lunedì","martedì","mercoledì","giovedì","venerdì","sabato"],MONTH:["gennaio","febbraio","marzo","aprile","maggio","giugno","luglio","agosto","settembre","ottobre","novembre","dicembre"],SHORTDAY:["dom","lun","mar","mer","gio","ven","sab"],SHORTMONTH:["gen","feb","mar","apr","mag","giu","lug","ago","set","ott","nov","dic"],fullDate:"EEEE d MMMM y",longDate:"dd MMMM y",medium:"dd/MMM/y HH:mm:ss",mediumDate:"dd/MMM/y",mediumTime:"HH:mm:ss","short":"dd/MM/yy HH:mm",shortDate:"dd/MM/yy",shortTime:"HH:mm"},NUMBER_FORMATS:{CURRENCY_SYM:"€",DECIMAL_SEP:",",GROUP_SEP:".",PATTERNS:[{gSize:3,lgSize:3,macFrac:0,maxFrac:3,minFrac:0,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""},{gSize:3,lgSize:3,macFrac:0,maxFrac:2,minFrac:2,minInt:1,negPre:"¤ -",negSuf:"",posPre:"¤ ",posSuf:""}]},id:"it",pluralCat:function(a){return 1==a?PLURAL_CATEGORY.ONE:PLURAL_CATEGORY.OTHER}},nl:{DATETIME_FORMATS:{AMPMS:["AM","PM"],DAY:["zondag","maandag","dinsdag","woensdag","donderdag","vrijdag","zaterdag"],MONTH:["januari","februari","maart","april","mei","juni","juli","augustus","september","oktober","november","december"],SHORTDAY:["zo","ma","di","wo","do","vr","za"],SHORTMONTH:["jan.","feb.","mrt.","apr.","mei","jun.","jul.","aug.","sep.","okt.","nov.","dec."],fullDate:"EEEE d MMMM y",longDate:"d MMMM y",medium:"d MMM y HH:mm:ss",mediumDate:"d MMM y",mediumTime:"HH:mm:ss","short":"dd-MM-yy HH:mm",shortDate:"dd-MM-yy",shortTime:"HH:mm"},NUMBER_FORMATS:{CURRENCY_SYM:"€",DECIMAL_SEP:",",GROUP_SEP:".",PATTERNS:[{gSize:3,lgSize:3,macFrac:0,maxFrac:3,minFrac:0,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""},{gSize:3,lgSize:3,macFrac:0,maxFrac:2,minFrac:2,minInt:1,negPre:"¤ ",negSuf:"-",posPre:"¤ ",posSuf:""}]},id:"nl",pluralCat:function(a){return 1==a?PLURAL_CATEGORY.ONE:PLURAL_CATEGORY.OTHER}},pl:{DATETIME_FORMATS:{AMPMS:["AM","PM"],DAY:["niedziela","poniedziałek","wtorek","środa","czwartek","piątek","sobota"],MONTH:["stycznia","lutego","marca","kwietnia","maja","czerwca","lipca","sierpnia","września","października","listopada","grudnia"],SHORTDAY:["niedz.","pon.","wt.","śr.","czw.","pt.","sob."],SHORTMONTH:["sty","lut","mar","kwi","maj","cze","lip","sie","wrz","paź","lis","gru"],fullDate:"EEEE, d MMMM y",longDate:"d MMMM y",medium:"d MMM y HH:mm:ss",mediumDate:"d MMM y",mediumTime:"HH:mm:ss","short":"dd.MM.yyyy HH:mm",shortDate:"dd.MM.yyyy",shortTime:"HH:mm"},NUMBER_FORMATS:{CURRENCY_SYM:"zł",DECIMAL_SEP:",",GROUP_SEP:" ",PATTERNS:[{gSize:3,lgSize:3,macFrac:0,maxFrac:3,minFrac:0,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""},{gSize:3,lgSize:3,macFrac:0,maxFrac:2,minFrac:2,minInt:1,negPre:"(",negSuf:" ¤)",posPre:"",posSuf:" ¤"}]},id:"pl",pluralCat:function(a){return 1==a?PLURAL_CATEGORY.ONE:a==(0|a)&&a%10>=2&&4>=a%10&&(12>a%100||a%100>14)?PLURAL_CATEGORY.FEW:1!=a&&(a%10==0||a%10==1)||a==(0|a)&&a%10>=5&&9>=a%10||a==(0|a)&&a%100>=12&&14>=a%100?PLURAL_CATEGORY.MANY:PLURAL_CATEGORY.OTHER}},pt:{DATETIME_FORMATS:{AMPMS:["AM","PM"],DAY:["domingo","segunda-feira","terça-feira","quarta-feira","quinta-feira","sexta-feira","sábado"],MONTH:["janeiro","fevereiro","março","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"],SHORTDAY:["dom","seg","ter","qua","qui","sex","sáb"],SHORTMONTH:["jan","fev","mar","abr","mai","jun","jul","ago","set","out","nov","dez"],fullDate:"EEEE, d 'de' MMMM 'de' y",longDate:"d 'de' MMMM 'de' y",medium:"dd/MM/yyyy HH:mm:ss",mediumDate:"dd/MM/yyyy",mediumTime:"HH:mm:ss","short":"dd/MM/yy HH:mm",shortDate:"dd/MM/yy",shortTime:"HH:mm"},NUMBER_FORMATS:{CURRENCY_SYM:"R$",DECIMAL_SEP:",",GROUP_SEP:".",PATTERNS:[{gSize:3,lgSize:3,macFrac:0,maxFrac:3,minFrac:0,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""},{gSize:3,lgSize:3,macFrac:0,maxFrac:2,minFrac:2,minInt:1,negPre:"(¤",negSuf:")",posPre:"¤",posSuf:""}]},id:"pt",pluralCat:function(a){return 1==a?PLURAL_CATEGORY.ONE:PLURAL_CATEGORY.OTHER}},ru:{DATETIME_FORMATS:{AMPMS:["до полудня","после полудня"],DAY:["воскресенье","понедельник","вторник","среда","четверг","пятница","суббота"],MONTH:["января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"],SHORTDAY:["вс","пн","вт","ср","чт","пт","сб"],SHORTMONTH:["янв.","февр.","марта","апр.","мая","июня","июля","авг.","сент.","окт.","нояб.","дек."],fullDate:"EEEE, d MMMM y 'г'.",longDate:"d MMMM y 'г'.",medium:"dd.MM.yyyy H:mm:ss",mediumDate:"dd.MM.yyyy",mediumTime:"H:mm:ss","short":"dd.MM.yy H:mm",shortDate:"dd.MM.yy",shortTime:"H:mm"},NUMBER_FORMATS:{CURRENCY_SYM:"руб.",DECIMAL_SEP:",",GROUP_SEP:" ",PATTERNS:[{gSize:3,lgSize:3,macFrac:0,maxFrac:3,minFrac:0,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""},{gSize:3,lgSize:3,macFrac:0,maxFrac:2,minFrac:2,minInt:1,negPre:"-",negSuf:" ¤",posPre:"",posSuf:" ¤"}]},id:"ru",pluralCat:function(a){return a%10==1&&a%100!=11?PLURAL_CATEGORY.ONE:a==(0|a)&&a%10>=2&&4>=a%10&&(12>a%100||a%100>14)?PLURAL_CATEGORY.FEW:a%10==0||a==(0|a)&&a%10>=5&&9>=a%10||a==(0|a)&&a%100>=11&&14>=a%100?PLURAL_CATEGORY.MANY:PLURAL_CATEGORY.OTHER}},zh:{DATETIME_FORMATS:{AMPMS:["上午","下午"],DAY:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],MONTH:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],SHORTDAY:["周日","周一","周二","周三","周四","周五","周六"],SHORTMONTH:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],fullDate:"y年M月d日EEEE",longDate:"y年M月d日",medium:"yyyy-M-d ah:mm:ss",mediumDate:"yyyy-M-d",mediumTime:"ah:mm:ss","short":"yy-M-d ah:mm",shortDate:"yy-M-d",shortTime:"ah:mm"},NUMBER_FORMATS:{CURRENCY_SYM:"¥",DECIMAL_SEP:".",GROUP_SEP:",",PATTERNS:[{gSize:3,lgSize:3,macFrac:0,maxFrac:3,minFrac:0,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""},{gSize:3,lgSize:3,macFrac:0,maxFrac:2,minFrac:2,minInt:1,negPre:"(¤",negSuf:")",posPre:"¤",posSuf:""}]},id:"zh",pluralCat:function(a){return PLURAL_CATEGORY.OTHER}}};for(var c in b)a.put(c,b[c])},d};witbookerServices.factory("util",["$filter","$window","md5",util]),witbookerServices.provider("currencySettings",function(){var a="EUR",b="EUR",c=1,d={};this.defaultCurrency=function(b){a=b},this.currentCurrency=function(a){b=a},this.conversionRate=function(a){c=a},this.rates=function(b){d=b,d[a]=1},this.$get=["$filter",function(e){return new CurrencySettings(a,b,c,d)}]});var eventCache=[];angular.module("paymentServices",[]).service("sipay",["$http","$window","$rootScope","util","$translate",function(a,b,c,d,e){function f(a){var b=!1;return a.match(/Android|webOS|iPhone|iPad|iPod|bada|Symbian|Palm|CriOS|BlackBerry|IEMobile|WindowsMobile|Opera Mini/i)&&(b=!0),b}function g(a){return/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(a)}function h(){var a=navigator.userAgent.toLowerCase();return r.isSmartPhone=f(a),r.isWebView=g(a),"object"==typeof r.currentAgent&&2===r.currentAgent.length&&parseFloat(r.currentAgent[1])<r.supportedAgents[r.currentAgent[0]]?(console.log("IC_ELIGIBLITY_BROWSER_NOT_SUPPORTED browser: "+r.currentAgent[0]+" browserversion: "+r.currentAgent[1]),!1):!(r.isSmartPhone||r.isWebView||r.oldIe)}function i(){window.orientation&&addEvent(window,"orientationchange",j,this),addEvent(window,"resize",j,this)}function j(){var a,b,c,d,e,f,g=document.documentElement?document.documentElement.clientWidth:window.innerWidth;window.innerHeight&&window.scrollMaxY?(c=g+window.scrollMaxX,d=window.innerHeight+window.scrollMaxY):document.body.scrollHeight>document.body.offsetHeight?(c=document.body.scrollWidth,d=document.body.scrollHeight):(c=document.body.offsetWidth,d=document.body.offsetHeight),window.innerHeight?(a=g,b=window.innerHeight):document.documentElement&&document.documentElement.clientHeight?(a=document.documentElement.clientWidth,b=document.documentElement.clientHeight):document.body&&(a=document.body.clientWidth,b=document.body.clientHeight),e=a>c?a:c,f=b>d?b:d,q.UI.mask.style.width=e+"px",q.UI.mask.style.height=f+"px",r.name&&-1===document.body.className.indexOf(r.name)&&(document.body.className+=" "+r.name)}function k(){window.orientation&&removeEvent(window,"orientationchange",j),removeEvent(window,"resize",j)}function l(){var e=q.UI;clearInterval(q.intVal),k(),q.win&&q.win.close&&q.win.close(),s&&e.wrapper&&e.wrapper.parentNode&&(e.wrapper.parentNode.removeChild(e.wrapper),document.body.className=document.body.className.replace(r.name,""),console.log({status:"IC_DESTROY_NO_CANCEL_RETURN_URL"})),s=!1,a.get(STEP2_SIPAY_CHECK_RESERVATION_STATUS,{params:{hotelTicker:c.establishment.ticker}}).success(function(a){a&&a.status&&a.id&&(b.location.href=d.generateStep3URL(STEP3_CONFIRMATION_URL,c.establishment.ticker,c.witbookerParams.representation.locale,a.id))}).error(function(){})}function m(a){var b=q.UI={};a=a||{},b.wrapper=document.createElement("div"),b.wrapper.id=r.name,b.panel=document.createElement("div"),b.panel.className="panel",b.panel.id="PPPanel",b.mask=document.createElement("div"),b.mask.className="mask",b.mask.id="mask",addEvent(b.mask,"click",q.startFlow,this),b.loading=document.createElement("div"),b.loading.className="ppmodal";var c=document.createElement("div");c.className="sipayLogo",b.loading.appendChild(c);var d=document.createElement("div");d.className="message",d.id="ppmsg",d.innerHTML=r.secureWindowmsg,b.loading.appendChild(d);var e=document.createElement("a");if(e.className="closeButton",e.role="button",e.innerText="Close Window",addEvent(e,"click",l,this),b.loading.appendChild(e),a.error){var f=document.createElement("div");f.className="text",f.innerText=a.error,b.loading.appendChild(f)}else b.loading.className=b.loading.className+" loading";b.wrapper.appendChild(b.mask),b.wrapper.appendChild(b.loading),document.body.className=document.body.className+" "+r.name,document.body.appendChild(b.wrapper)}function n(a){var b=a.split("EC-");return b.length>1?"EC-"+b[1].split("&")[0]:null}function o(){var a,b,c,d=r.mbWidth,e=r.mbHeight,f=!1,g=document.querySelector("#PPFrame .ppmodal.loading");if(window.outerWidth?(a=Math.round((window.outerWidth-d)/2)+window.screenX,b=Math.round((window.outerHeight-e)/2)+window.screenY):window.screen.width&&(a=Math.round((window.screen.width-d)/2),b=Math.round((window.screen.height-e)/2)),c=window.open("about:blank",r.name,"top="+b+", left="+a+", width="+d+", height="+e+", location=1, status=1, toolbar=0, menubar=0, resizable=1, scrollbars=1"),q.win=c,"undefined"==typeof c)return console.log({status:"IC_CLICK_OPEN_MB_FAILED"}),window;u&&console.log({status:"IC_CLICK_OPEN_MB_SUCCESS"}),c&&c.focus&&c.focus(),g&&(g.className="ppmodal");try{c.document.write('<!DOCTYPE html><html lang="en"><head><title>Sipay</title><style>.mask{z-index: 20001;position: absolute;top: 0;left: 0;background-color: black;opacity: 0.54;filter: alpha(opacity=54);}.ppmodal{display: none;z-index: 20003;-webkit-box-sizing: border-box;-moz-box-sizing: border-box;-ms-box-sizing: border-box;box-sizing: border-box;width: 100%;height: 100%;top: 0;left: 0;overflow: hidden;background-color: #EFEFEF;-moz-background-clip: padding-box;-webkit-background-clip: padding-box;background-clip: padding-box;padding: 2em;font-family: "helvetica heue", arial, helvetica, sans-serif;position: fixed;}.minibrowser .ppmodal{display: block;}.loading .mask{height: 30px;width: 30px;position: absolute;left: 48%;top: 50%;margin: -15px auto auto -15px;opacity: 1;filter: alpha(opacity=100);background-color: rgba(255, 255, 255, 0.701961);}.loading .mask{height: 48px;width: 48px;border: none;background: url(data:image/gif;base64,R0lGODlhMAAwAPcAAP////f39/H39/Pz8+/z9+vz9+/v7+vv8+fv9+fv8+Lv9+Pv8+vr69/r8+Pr89vr8d/r7+fn59vn79fn79Xn8+Pj49fj79Lj787j79Lj69/f38/f68rf68rf78Xf79fX18Pb7Mjb58fY48La5rvX677W5rrX57TU67XS58zMzMzMzLPO36rO467K38LGyqrK377GzKbK36rG26bG36bG26LG37rCxqHG27O+xp7C26LC266+xprC25rA15O+26e6xpO+16K3xpK61562yI6615i2yYq214620oq20oa21payxo+yxoKy0oay0n2y0oiuxnqu0nuuznWu0H6qxnWqznGqznmnxm2oznWmxnGmxmmmzmmmym6ixmmgxmWiymGiymWexF2fymGewlieyluawlWayFGaylGZxlOWwk2Wxk2WwkmWxkmSxUWSwkWSxkGSxj2SwkGRwj2OwjmOwjWOwjGKwjWKwi2Kwi2GwiiGwiSGwiSCwiCCwhyCwhx9whh9wv///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh+QQJBwCAACwAAAEALwAuAAAI/wABCRxIsKDABjWomJGDp06KFB8+VGAQwKDFixgJ8DDD549Hj3weinz4gQEAjCgNEkhS56PLP3tGykwRIaXNF3Nevow5c+QHAzYtCriiUyfPniM1BCUowU1Ro0hnfqgY9AKdpzpDRpU51WaDllg/9uFzZ6tUqhcFvAn7J4+WFxsaFAAQIIABDWYhotQSFo+TBygDVDCr1OKLsFokLA2ANyrQggKuFu1DZCnBCFE/GEzylM8LywUNRK05kMCdp5VBF8SMlCCPp1pUW2w8k8FAM0XzOJBtMABSzYAadNTphLfFwT0r1sjdwHhvpLapFI3t3CDtkRUA4dbJorpB0VIB5dx82WeD94K+w+fJ2vz8wPQzAdXZQ7/+nQLuBwJojfRkfkD79QQIUmi5B59MgHyQ3H+AHCiSZgrO9Fh+4HEFCHIyFZbfdSJlxwCB+Tkokm0iPpSdexjKRFWEMxVoXIl6CfRhTxo6x+GIBI1WHWs9+ScQjxIaV+FMpBHEIpGyAWnhd1tp4CJGjG01YUE3ylTBkwQJRhhKRyKlgQF1AUCXXVUuCWWXeaVJEpbooanmVl0FFYCbb56lWpl1PlQjaAbQqeZP3in5ZpHeAcCAn1yZxKBAATBQQUQ+SUQRaAEBACH5BAkHAIAALAAAAQAvAC4AAAj/AAEJHEiwoEAJM6SYkVMHT547ctJIuXHBoMWLGBHwMJPnj8ePID3uSTMDAMaTBgsksROyZUswKSKgnBljjsubH/nsSJHig4GZFglo6YOz6BmeSDUAJSjBTdGnRZAi/RBg6QWbT3HOcSF1alWUEuhk/dNnT56Gej5a6SqV6kkCa57mGeOjxIUGCBJciBGmjg22bU9qKYqHyYOTCSoAlqrUYouiWiQsDaBhMc+fBQvIucmHyFKCESx/MJiEc43PBQ1YlkmwY0s+N1AbDL2YIAMsLENKkW2xMmAGAz+kcLEkDdE/dRDwNhhg8WhAzaX+6JLHyXKLigFXVc12yITrzBcD6c/etTH4gr67VgAknC3m8wS5dx3dvutX+AOjzwe0+D5+6LUtZtJ/AgEQIGADEmggYPxpR6BA+nXFnoMPRjjVhO49CIh8gZHHmIbpSbUeA/0RaCFSwJ3I03r/eSjVV/XZh5+KPQ1EImDmgReiVMANtNp5tCEImmXvycZhV6wRFCOSvAXJ1nOpWZaCBv6dRJmURRK0I1sVVFlQAC6ylaNBS+JoQAABAAAAmgZs+SRKAZQp5ZzzecmcnHTO6RZQcebpZ092nuTmnx8uZwCefvoEn5OEJgkfAAwgOh8DCVbIQAUfxJhpBQwEelFAACH5BAkHAIAALAAAAAAvAC8AAAj/AAEJHEiwoEFAChQ0QCDgoMOHEAdOeKHFjJs7dTDCMXOFB4aIIA828DGmzp+TKFOe3JOGSIOQIAkYmaOyps07Tl7CPBjjjc2fNuv42EmQQJU+QJPW/KKA6AQ3SqOqnMMBZgA4UrOizFMCZIAPWKLu0WOnTh4+UcHACBDxQ4oUU37mMeODQ4cCCiaAqPHlzs8ubz9A1PD2bdyUdJh8fChBiM+UgAtrcGigcOHDfajoBFmACdo/XCy/NXDQregUVvQQISpQRp4uLk4LLhjhdOEQrAeGiG07QkHbb33nHlgbOEEGwCcPJ0jYNoOBpk+zXT4wAPDZ1m1XoF6wAnC2lW1P9ecuMPvp595PKyc/sLno7dEtk2Y/MLxowfELj6dv3rLg7/RVZxxwAAQoEAAD2laggQjaBgiABvZnGSD5vbUfexIGRqFt8wVon3+ApCfaevS5Z9l2yIkXYIZvPcdiCtvRJ6Jo01VoIYbXDZSieuyZaNlzAwGXgnDLFacgQUae1iFrH4pGJHRCPglTkvcd1OSIFz4UgI+iLcmckG9VkCVBAcxoG4kG2TiiAQEEAAAAbRrApWwRfQXmnXd+MGZBduLpp397GtTnn3jqydqchFqG5k4GqPnnB17mRiWhUlIHAAOO3sfAggYCEgADFXwQn6gVMBDoQQEBACH5BAUHAIAALAAAAQAvAC4AAAj/AAEJHEiwoMALOaqkmYMnT547c8xcyTHBoMWLGAG8SMPnj8ePID3qSeNDAcaTFiOk4BKyZcs6TBCgRGngQ4oUOPa43PlxTo2ZFzXcHEqGp9E/X2QCFRjA5tCbQ44afXNhadOnT+NI5VmHw8yrWIc++ZinTp07evpsrVP1pNOwN23M+fLiQoECCyaAyBEGz9E3BTAKhTu0QmCMDYzUMRrmogHCNzUEWNqgitEYFt+GjbCUIJCOLumYJKiSsIHOBV/o2emkIGTOqFODDqmHIAPCGmJbdNLSDhYGAzU/nay7YAE6HvukWeIixQemhCsUt5gkT5cfWCc/hkt8OsEHQ+AC7K8AN7d3g4OxShd+8/T5gtuxPmefovt76GGfE7Z/PwBhQIQBcB9BAPwX4IADFQgXgNwhiF9YgNDH33v+5RchXO4hGN9Tz5EXlnkIpveUdLc1OGCFYQGHonoIehgWcfTV1x9hzwlU4of3ifgUcAO9dl5pcAk4EJBhZRjbhljBRlCMKSjZGZHyWYQkVpJZpSNWRhJ0pXoTEhSAi7i5BdlQGhgQQAAAAHCmAVtGeRJYY8YJ2QddFgSnnHjeRKdVTOYpX52C+RkniEf2KecHWeoGpZ9OngcAA4YO9QEDQjoISAAMVPCBZptWwACgFgUEACH5BAUHAIAALA8AAQAgABcAAAiuAAEBCsCgwocPKVLUEQhICqAGDCNKjMgAYcKLKfhMFEhg40SMIPd4HCkRJEaRJFOavIiSpBYBHlcmbJlSwkaZGVNGvPBRpk6JECNi1GAgQAAABRpseKHlp8cAKaGkvOK0qtWrDGFi1ZlkK0Mifzbe6egVUFOJf/7wKAvIQZ60cNOaYQvISVy4fIKWfXv3Tw26Wvr+cciWheC5bDf06TuHbgM+ffPQLXBnj+XLdQICACH5BAkHAIAALAAAAQAwAC4AAAjeAAEJHEiwoMGBKVJ8+FCBQYCDECNKPJiwYsIPDABM3MhRoEWLWQA56UgS4seELuqUXGnwZIolBb+wLOmSzcybgE7+wHnzZBeJE3hCBBAggAENKfgIFRogCR2JXpZuTABFqVScMq5q3cq1q9evYA8mCcsRAVmOYc5O5AHRrFoQECmoBRT0oIe5CgD92cs3D4m5Be7w7ftXbQE8g/feuav2gp7Ef+bIVfsC8h8zbs+GsVxlLiA7lm94tjElzuA9FzwPHEJmz581qgvi4CI6tu3buHPr3s27t+/fwIMLhxgQACH5BAkHAIAALAAAAQAwAC4AAAj/AAEJHEiwoMAADCp8+JCiYYqFFRgEMEixokVAABgwdMix40MGAC6KNBjBo0mTEUaONLDxpEuHHwyorKjhpc2OGmYSDNDyps8PE2fy9EkUZlCRQ4sWxVIHw8ieJzUYCBAAAACqBmqetPLnDx0FF7W6rHCUYoAKHrl2/TPGooGXGspeDCAWS5+1XX1UhMoxpU6BJbPcxfsnD9iCJU/K/DvQgB7Ca6UYdOmX8UAafCAXPiyQQVTLBpto/mOEIN+GckELeKPZzcAAJyuApthDc58LAt+aTD0bwR3NegGh9ZhzNsUvmrUIPL3YeMEYmt80AHSat/ELmQnfcXrS+uwEjwnr3CEB6GRI5wUF/CbM50R5k+fRD1QPeY/77vIJNtgDeTz13fkNtEF2eNXRwX8eNZcfdJC5AdZwOAUokBfJdYZffg3goRkPB8UWIBCa8YHbchc6J4Ab0RHkmUnFOefEaEQURJlzPBCI1x0IIOaSgn8ZYCNekhl0WkOV6VSSWoTVkaNBukXlXUF0OTQFZBzSZBNZc0EoJV5eiDQkR1JRZRVWYnk05R9ycFZRUkr5ZEUdIyL1ZZsdkSfUnHQCZVmZdIJpHEt9wsQjaInRWSR6GeEJE0gS7pTQQhxBJBFjAQEAIfkECQcAgAAsAAABADAALgAACP8AAQkcSLCgwAAMKnz4kKJhioUVGAQwSLGiRUAAGDB0yLHjQwYALoo0GMGjSZMRRo40sPGkS4cfDKisqOGlzY4aZhIM0PKmzw8TZ/L0SRRmUJFDiyoFOrLnSQ0GAgQAAECqgZo2P4jE6rLCUYoBKtjMWdHASw1fLwbgalImRaccU+oUWPKkVpIu3c4VaPakXIIu/+6l67Igg6eDDbJtuKNLDoJwG6ZNHMChCyVn+PxxM7CyyQqJKVawYUXOn9N/+Fzge3JyaAJ1UMu+IVCsR7KhDX6RjbqKwMh6cxN8wft0GgSAIrvOfUFP8TkUALUWbrAAnuJ3PEg3GZI6wQJ3iuftIbHdY3fvAhdc5z2+fMfloSfswa5dOfqBIPo8jw78vkAexf1hRgGA2IaTf4CMEaBvgBxmEnx7JZBHgLQB4plHoKHHRIB7PDBQZClAOJMDExZnBkEO3uadFwH+wUNBgQlHRIt1EEhQXW2FVoN+ASbxVox73aBZgHQIQFFfT4k40AJS8BjgCxYthiGEATgRW4t/aCESiBxBJRVVVtU0ZItvGKkWlz51gWUdEqiUlFIO7eCkbHSsJhSaNqVRnBtt7iUlUUvwpgUBobEEZwou2HHaHC14h2NRWdyRhI3eZYQnTCFoh+BBCS3EEUQS7RUQACH5BAUHAIAALAAAAQAvAC4AAAj/AAEJHEiwoMAADCp8+JCiYYqFFRgEMEixokUADBg63MjxIQMAFkNSjNCxZMkIIlMa0GiypcMPBlJW1OCyJkcNMgkGYGmz54eJMnf2HPoSaEihRJP+FMnTpAYDAQIAABDVAM2aH0JebVnBKMUAFWripGjApQavR7eWjGmw6UaUOQeSNJm14Ny1cQuWNQl3YMu+eeW2JMjAaWCKajcyGOi2IdrDgALQPWiyAmSKYUtO3Nvx8WXJJRdnvnl5ZknLjdmW1lsya2PPpUFzzGoS9meTgEyCXF0QAG7dvAsWuLOnuPE6uTUHJ9iAz5/n0PMAer184IY+0KHPmY63OiAW2aGb0wE0euPY6lrCP5cCqLDy5Q3yqP9TI3Ll6k7m82kgsHEK23E5IJ964wnkXkfnlZbefDwQ9NdqRMz3xx0EEHRXR6oF9oJz8yXR1oOBEYHdfHQIYBBnJZ2VkwQLSviCaS51FdIDTuAh4XNahOSfeVBJVUADG7ygxYA3vmGiRUgNdQcfI974XB38iZSkTRw6+RwdF+Q0pUt7WPmcGxIElphJXVp5xZGBrVRTmRLO8eJqF3bEZnh1JFFhcBg1VuVzfJjBw53eRZbQQg3VgcccZlBxQ5Q5BQQAIfkECQcAgAAsAAABAC8ALwAACM0AAQkcSLCgwYMIEypcyLChw4cQI0qcSLGixYsYM2rcyLGjx48gQ4ocSbKkyZMoU6pcybKlS5MAUsicKdNkAJo0beKU+cGkgZ0pepbUALRCyZtAGZRMokdMEJwBSBaoM5DNExdBS0IxeIeL0pE0+BzUA6ClE5cIXlJMsDDJwi8VbdQZU2PDAgUNLpTwMWbklD+A9+C5E3GCRTmAEysmOUTx4pJkHD8WiYOP5Mkgu1zG/LGFGT2bTU6YAcXMmzqEAb1BWeBBBw8gOlAoMDEgACH5BAkHAIAALAAAAQAvAC8AAAj/AAEJHEiwoMAADCp8+JCiYYqFFRgEMEixokUADBg63MjxIQMAFkNSjNCxZMkIIlMa0GiypcMPBlJW1OCyJkcNMgkGYGmz54eJMnf2HPoSaEihRJP+FMnTpAYDAQIAABDVAM2aH0JebVnBKMUAFWripGjApQavR7eWjGmw6UaUOQeSNJm14Ny1cQuWNQl3YMu+eeW2JMjAaWCKajcyGOi2IdrDgALQPWiyAmSKYUtO3Nvx8WXJJRdnvnl5ZknLjdmW1lsya2PPpUFzzGoS9meTgEyCXF0QAG7dvHv/1hxcJ+7XxQfK3ugab3JAnJkDGr1xbPLEDS0XJl58ueLIlZNT398ItHEK23G9vxy4vaP10tgbLvbLd/XdjrsF3uc44nKJv22VhMUeSRx2Ax9gtEZWR1b08ccfWjSQUwJQ8PFgFx2pVpBaVjzoIR1MYBDSBUS44eGF1YWkUYcnepjHGESY0EEDD2BQghFj3NGihxg+JNJOWOy4Yx981JFHHkLuKAYM6B0kR5JQRukiCTk9kIaUWLb4hohxESCFhVlG2YcWCkC2golhCjlHDKsJQMSTaT54BxQSBlfADGPgIWUfeazhQ53PAfLAC1CE4cYcddhBxxppODFDB4GGJAACCBRQWkAAIfkECQcAgAAsAAABAC8ALwAACP8AAQkcSLCgwAAMKnz4kKJhioUVGAQwSLGiRQAMGDrcyPEhAwAWQ1KM0LFkyQgiUxrQaLKlww8GUlbU4LImRw0yCQZgabPnh4kyd/Yc+hJoSKFEk/4UydOkBgMBAgAAENUAzZofQl5tWcEoxQAVauKkaMClBq9Ht5aMabDpRpQ5B5I0mbXg3LVxC5Y1CXdgy7555bYkyMBpYIpqNzIY6LYh2sOAAtA9aLICZIphS07c2/HxZcklF2e+eXlmScuN2ZbWWzJrY8+lQXPMahL2Z5OATIJcXRAAbt28e//WHFwn7tfFB8re6BpvckCcmQMavXFs8sQNLRcmXny54sgcg4jz0QMlOfWNQBm6eMKmz58/dxYE9/5yIAMud97r/1MlOPaGiw2Ux3769ZHDand1tJtARhCoHx88XBYdR4ABUgAcDr7XRxKHJTgbRStkqJ8XF+QUwH8OqVbQFSK+lwcUE4SUwHkdWWeQAGu0+J4eZhBhAgYPKLDABjWMcYcNLtVlUQNy6LgfH3ngkcce+lnR0lIiTTCHkzrO4UJrthXUQI5ciqhER1jmJEAVfJTp4BmkQdbCG27u18cODcG0mgBCbFnnH2CkUGFpBNxQxoBO5mHGCws+18ALUIzxBh113FHHG2ZAEUOMz1VEwAMYeOBBBw8UAFlAACH5BAUHAIAALAAAAQAvAC4AAAj/AAEJHEiwoMAADCp8+JCiYYqFFRgEMEixokUADBg63MjxIQMAFkNSjNCxZMkIIlMa0GiypcMPBlJW1OCyJkcNMgkGYGmz54eJMnf2HPoSaEihRJP+FMnTpAYDAQIAABDVAM2aH0JebVnBKMUAFWripGjApQavR7eWjGmw6UaUOQeSNJm14Ny1cQuWNQl3YMu+eeW2JMjAaWCKajcyGOi2IdrDgALQPWiyAmSKYUtO3Nvx8WXJJRdnvnl5ZknLjdmW1lsya2PPpUFzzGoS9meTgEyCXF0QAO46e4ILv1OAd2/cef4oX86ngXGduOcsX95nw/OBsjdmNTN9OYvrAjlr1wdEpbtyLeABJW5ouYb5P3mcP8+uGFADPu+dXB/NESh383k4YBx9Lw3Ew3t/oMfbeg0tJhABdyBIxGp3dbSbQEkg2McLl4nHEWCACFCHhhMGVuFsFL2A4HkS5BQAgw6pVtAVK/6BBxQPHMVfSWNRJMAbNcKnxQsbNFAAVQFYZVNdFjUwYpB/9MHHHUrZNtAFdECpHB9ELSWTBEBCucdQXuYkgBZi9tRjYC9It+KYLsG0GgFJPGkenHxdRwAPZuA3HZcdffBRegI1cIMUZsyBRx0NQSRRXgEBACH5BAkHAIAALAAAAQAvAC4AAAi8AAEJHEiwoMGDCBMqXMiwocOHECNKnEixosWLGDNq3Mixo8ePIEOKHOlxRpcdJBGa+cPnjBIXKQdKyPOn5h85VmzEjGGzZ50CKaH0tDkmZpmhNWvEfIOUD4eYdZDmSRDzjlQFVaU2gHrwwtKDJYwe9BFTZdmzaNNu/KI2LZG2DXPAFUhlwdy7AotoMBAgAICzYlykGEy47A/ChWO2QZw45RPGjUXeEQw5ZhfIkUGCEPEB89kADCp86JwZYkAAIfkECQcAgAAsAAABAC8ALgAACP8AAQkcSLCgwAAMKnz4kKJhioUVGAQwSLGiRQAMGDrcyPEhAwAWQ1KM0LFkyQgiUxrQaLKlww8GUlbU4LImRw0yCQZgabPnh4kyd/Yc+hJoyAt50rggSvRnSARz/vxRalKDgQABAADAaoBmzQ8hv0iVSnVjBaMUA1SoiZNijbFjzyxNoQFtyABeTcYsSKAO3LFpgqDMOZCkSbAFk/wd2ycH4YIGWg4WSADP4j98aDw2aLgkwRyX/zjZTDEvRwYDzVymQ4C0wQCHBS7Yc9mIa4prS058cXnPhNuvTaKGctkM8NIlKwASu9jHcYORO4J1c9nE84KwpQOK+rfPhes6TQLh8vuXDwLwAwGIt7OYzwL0AtV7hrO4Dwf4gLJ3BJTmMgv8+m0EFnN/QYFfdByBxcRlb+BnmkPKrXAZHyCgF+BGqBHA3mJaoJdbR0BpcVkevz134UsDtRDaGNc96BBqB1F3mRQNANdZRyANRENofxBxG4IdTXZQf4tN4YKQOd2YIEUh6PHXFA7VlRNeLu1l0BFwQcnRWXd9WJVFAYQhlZYlWYWVVly5qF1IBJyBBVNN2UURBnAO5VRQPNUpnZwiqalnW6StpOdLVt6mJFFIAodRni198BF+ByW0kIAfRMSnRQEBACH5BAkHAIAALAAAAQAvAC4AAAj/AAEJHEiwoMAADCp8+JCiYYqFFRgEMEixokUADBg63MjxIQMAFkMaRMAkT5eOKDlGEMnyxZw/f+64SEnzoQGWFAl4gcnzSc2aGnASlPCGJ884P2t+mIjzAh2jPPsESUpzKUsJdaAaJTOTKkqrFgUU1Rq1iAYDAQIAAJDWgIakH0JqIcuTThIJIQNU+BmUYgu6f/pASSA0wFuaNwsKeEmWDw2hBCNUNWiEbp8YkAsaoLlyYIGsZIlkNig5JcEcdL2Mpni4I4OBZsjmabDaYICUcQE12EOWSW2Ke1FOjEFWz4LftlO+lkK2DHLWKCsAKkPWx3ODmzvGHQt1xPWCt7UD4gJtlM+F7wTDdwR0R+ts9AMBmG4PNQ8C+ALloxzvnjB+9RwBwh1PfHCAHyAAOhQXdVrVcGB2HMXlBFlmHNjaRtK9QFYdBcCXoEOvPZCHUXFMYYN06AXXEVOx7UHGEBsx9dyHDeUGyAtc4NBRX89duNFrA3H2XGkogTQQkR0lthqEHXVGkEYoOQkZkhFSxOSOMopkWE1KFuRjRxVkaZuKKfFIEZQ0nZXWWm19KV5eaHrlFVhwyiknnVrGaedXYrLk5p4NmZmZAXra+UGXtVEpp5TPYVToVx8deFBCC20EkUSZBQQAOw==) no-repeat center center;}.ppmodal.loading{min-height: 160px;}.ppmodal .pplogo{background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGoAAAAdCAYAAABCBvnuAAAON2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS41LWMwMTIgMS4xNDk2MDIsIDIwMTIvMTAvMTAtMTg6MTA6MjQgICAgICAgICI+CiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iCiAgICB4bWxuczpkYW09Imh0dHA6Ly93d3cuZGF5LmNvbS9kYW0vMS4wIgogICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iCiAgICB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIKICAgIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIgogICAgeG1sbnM6UGF5UGFsPSJ3d3cucGF5cGFsLmNvbS9iYXNlL3YxIgogICAgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIgogICBkYzpmb3JtYXQ9ImltYWdlL3BuZyIKICAgZGM6bW9kaWZpZWQ9IjIwMTQtMDUtMDZUMTU6NTg6MzctMDc6MDAiCiAgIGRhbTpzaXplPSIxMjc1IgogICBkYW06UGh5c2ljYWx3aWR0aGluaW5jaGVzPSItMS4wIgogICBkYW06ZXh0cmFjdGVkPSIyMDE0LTA1LTA2VDE1OjU4OjMwLTA3OjAwIgogICBkYW06c2hhMT0iODViZjgxYTJmMzFkYmYzMDA1ZGU2OTJiODFiYThjNjNlZmJmNDA0ZCIKICAgZGFtOk51bWJlcm9mdGV4dHVhbGNvbW1lbnRzPSIwIgogICBkYW06UHJvZ3Jlc3NpdmU9Im5vIgogICBkYW06RmlsZWZvcm1hdD0iUE5HIgogICBkYW06UGh5c2ljYWxoZWlnaHRpbmRwaT0iLTEiCiAgIGRhbTpDb21tZW50cz0iWE1MOmNvbS5hZG9iZS54bXA6ICZsdDs/eHBhY2tldCBiZWdpbj0mcXVvdDvvu78mcXVvdDsgaWQ9JnF1b3Q7VzVNME1wQ2VoaUh6cmVTek5UY3prYzlkJnF1b3Q7PyZndDsmI3hBOyZsdDt4OnhtcG1ldGEgeG1sbnM6eD0mcXVvdDthZG9iZTpuczptZXRhLyZxdW90OyB4OnhtcHRrPSZxdW90O0Fkb2JlIFhNUCBDb3JlIDUuNS1jMDEyIDEuMTQ5NjAyLCAyMDEyLzEwLzEwLTE4OjEwOjI0ICAgICAgICAmcXVvdDsmZ3Q7JiN4QTsgJmx0O3JkZjpSREYgeG1sbnM6cmRmPSZxdW90O2h0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMmcXVvdDsmZ3Q7JiN4QTsgICZsdDtyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSZxdW90OyZxdW90OyYjeEE7ICAgIHhtbG5zOmRjPSZxdW90O2h0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvJnF1b3Q7JiN4QTsgICAgeG1sbnM6ZGFtPSZxdW90O2h0dHA6Ly93d3cuZGF5LmNvbS9kYW0vMS4wJnF1b3Q7JiN4QTsgICAgeG1sbnM6dGlmZj0mcXVvdDtodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyZxdW90OyYjeEE7ICAgIHhtbG5zOlBheVBhbD0mcXVvdDt3d3cucGF5cGFsLmNvbS9iYXNlL3YxJnF1b3Q7JiN4QTsgICBkYzpmb3JtYXQ9JnF1b3Q7aW1hZ2UvcG5nJnF1b3Q7JiN4QTsgICBkYzptb2RpZmllZD0mcXVvdDsyMDE0LTA1LTA2VDE1OjU4OjM3LjkwOS0wNzowMCZxdW90OyYjeEE7ICAgZGFtOnNpemU9JnF1b3Q7MTI3NSZxdW90OyYjeEE7ICAgZGFtOlBoeXNpY2Fsd2lkdGhpbmluY2hlcz0mcXVvdDstMS4wJnF1b3Q7JiN4QTsgICBkYW06ZXh0cmFjdGVkPSZxdW90OzIwMTQtMDUtMDZUMTU6NTg6MzAuNDMyLTA3OjAwJnF1b3Q7JiN4QTsgICBkYW06c2hhMT0mcXVvdDs4NWJmODFhMmYzMWRiZjMwMDVkZTY5MmI4MWJhOGM2M2VmYmY0MDRkJnF1b3Q7JiN4QTsgICBkYW06TnVtYmVyb2Z0ZXh0dWFsY29tbWVudHM9JnF1b3Q7MCZxdW90OyYjeEE7ICAgZGFtOkZpbGVmb3JtYXQ9JnF1b3Q7UE5HJnF1b3Q7JiN4QTsgICBkYW06UHJvZ3Jlc3NpdmU9JnF1b3Q7bm8mcXVvdDsmI3hBOyAgIGRhbTpQaHlzaWNhbGhlaWdodGluZHBpPSZxdW90Oy0xJnF1b3Q7JiN4QTsgICBkYW06TUlNRXR5cGU9JnF1b3Q7aW1hZ2UvcG5nJnF1b3Q7JiN4QTsgICBkYW06TnVtYmVyb2ZpbWFnZXM9JnF1b3Q7MSZxdW90OyYjeEE7ICAgZGFtOkJpdHNwZXJwaXhlbD0mcXVvdDszMiZxdW90OyYjeEE7ICAgZGFtOlBoeXNpY2FsaGVpZ2h0aW5pbmNoZXM9JnF1b3Q7LTEuMCZxdW90OyYjeEE7ICAgZGFtOlBoeXNpY2Fsd2lkdGhpbmRwaT0mcXVvdDstMSZxdW90OyYjeEE7ICAgdGlmZjpJbWFnZUxlbmd0aD0mcXVvdDsyOSZxdW90OyYjeEE7ICAgdGlmZjpJbWFnZVdpZHRoPSZxdW90OzEwNiZxdW90OyYjeEE7ICAgUGF5UGFsOnN0YXR1cz0mcXVvdDtTb3VyY2VBcHByb3ZlZCZxdW90OyYjeEE7ICAgUGF5UGFsOnNvdXJjZU5vZGVQYXRoPSZxdW90Oy9jb250ZW50L2RhbS9QYXlQYWxEaWdpdGFsQXNzZXRzL3NwYXJ0YUltYWdlcy9HbG9iYWxJbWFnZXMvY2hlY2tvdXQvaGVybWVzL2xvZ29fdjMucG5nJnF1b3Q7JiN4QTsgICBQYXlQYWw6aXNTb3VyY2U9JnF1b3Q7dHJ1ZSZxdW90OyZndDsmI3hBOyAgICZsdDtkYzpsYW5ndWFnZSZndDsmI3hBOyAgICAmbHQ7cmRmOkJhZy8mZ3Q7JiN4QTsgICAmbHQ7L2RjOmxhbmd1YWdlJmd0OyYjeEE7ICAmbHQ7L3JkZjpEZXNjcmlwdGlvbiZndDsmI3hBOyAmbHQ7L3JkZjpSREYmZ3Q7JiN4QTsmbHQ7L3g6eG1wbWV0YSZndDsmI3hBOyZsdDs/eHBhY2tldCBlbmQ9JnF1b3Q7ciZxdW90Oz8mZ3Q7JiN4QTsiCiAgIGRhbTpNSU1FdHlwZT0iaW1hZ2UvcG5nIgogICBkYW06TnVtYmVyb2ZpbWFnZXM9IjEiCiAgIGRhbTpCaXRzcGVycGl4ZWw9IjMyIgogICBkYW06UGh5c2ljYWxoZWlnaHRpbmluY2hlcz0iLTEuMCIKICAgZGFtOlBoeXNpY2Fsd2lkdGhpbmRwaT0iLTEiCiAgIHRpZmY6SW1hZ2VMZW5ndGg9IjI5IgogICB0aWZmOkltYWdlV2lkdGg9IjEwNiIKICAgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo3Mjg5NkM2OEU1MzExMUUxOUZDMTlFRTAyOEVGMjkzQyIKICAgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOkVGMjJBREYyMDkyMDY4MTE4RjYyQTdEMThDRTRDMEFBIgogICB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjcyODk2QzY3RTUzMTExRTE5RkMxOUVFMDI4RUYyOTNDIgogICBQYXlQYWw6c3RhdHVzPSJTb3VyY2VBcHByb3ZlZCIKICAgUGF5UGFsOnNvdXJjZU5vZGVQYXRoPSIvY29udGVudC9kYW0vUGF5UGFsRGlnaXRhbEFzc2V0cy9zcGFydGFJbWFnZXMvR2xvYmFsSW1hZ2VzL2NoZWNrb3V0L2hlcm1lcy9sb2dvLnBuZyIKICAgUGF5UGFsOmlzU291cmNlPSJ0cnVlIgogICB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDUzUuMSBNYWNpbnRvc2giPgogICA8eG1wTU06RGVyaXZlZEZyb20KICAgIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6MkE4RThGODIzMjIxNjgxMThBNkRGRTg2OEI5RUI5MjgiCiAgICBzdFJlZjpkb2N1bWVudElEPSIwIi8+CiAgPC9yZGY6RGVzY3JpcHRpb24+CiA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCjw/eHBhY2tldCBlbmQ9InIiPz7/o3JBAAAEwklEQVR4Ae3X7WuWfR3H8e85TYfNm+tm17IVKiV0qbmVrWwqnVhSYsUiC1JIWXkxsubSByVUiIOcFXMZzRvMHhRoElLWZQaZZWESpd2BmdOsmItsqSVt3sxP7wfHg4MPnDs4ThecF54HvH5/wO/NefL5xUvxq37Nu85DGe7jbziG96KAqFiHrj2FISjDCP6Er2Ep4v/kRSjl34hMHEDzrnqoDGcwvYJDrYLKcAg1iAl2C0oZzBuqCJXpQAWH6oTKtBkxgV4BmR/nDdUBlekepldoqP1QmS4hJtBKyOzNG2ovZC6iAc9gAToxAjm8uUJDnYXMETyN5/AG9EAlTEFMkM2Q6cgb6jRk9iLMVyC41goNdRMy7QjzMwju5YgJ8lXIFPOGGoRMB8LsgODmIVJejU34AvZjNz6EOgTehGLK6xCYjqJpQIyjCcWUliRSPQT3VoQ5DiFrkS3EFuxBP7rxbkzGJKxAMeVViMQZyNQjMiWRZkFwRYT5IWRuooDAK3EUjyCHf2EjZH6NwAbI/AFRwlrIjGJaclFymIVImYxByJxGJJrwE6iEAXwSMl9HJP4OpdxE5AnVCjnUI1I+ADl8A4G34J9QhjHIHEegAWOQeR5hGjEMmS2I5P9fGXO4Bjshh20IrMMolGEMMp9D4GnInM0bqh0yD9GHffgmfgOVsBTzcQcqU3fGr3Y7IqWAH0HmByggkkUlM4Q+HMQR/BlyuItnsNoD5LQWgWWQ2Z83VC9UpoMI/BQyd9GNZViCLtyGHNYjEhsgcx6R0gWZf6AhNSROQ2X6GOowCJkb6EILluLzeAA5LERgE2Q684Y6CZXhRdTibZC5g9cjTBFyaEYkZmAESnmE2Qgswihk1iAA2CXn0ItAJ2Quox5htkDmAV6GwB7IvCNvqOtQDgP4KAoI9ENmK6KEv8Aj1CJSjkHmBUzFbyHzZYs0C8rpl3gXIvFzyLwdAfdUxoP5FGQaEciWzGXB/Qp9iS/hM/gImlBApFyEzHxECUNQyjWEeR9kTuKLkPkdai1UKwR3Cn2J3diO9XgNImUS7kMp/0ENAu45yBxHJP4KpdxG5Am1BIKbgwAyDUKmEQH3RsicQJipuA2lPIDP/lEsQliodsgMowaBLM9COeZ0O2R2IlAHmV/kDfVhyNxB5HAFMl0IMxMXINODgDsEZfg4Ah6qN+8cNtMguCLCvBZDkFmHQAtkDucN1VNqYeXwbcjcRzdasBgvYACC24iAWwmN43solAh1spw5bAYgM4xPYDFa8GkMQ3DNCGyAzNa8ob4DmcOIHNqgx9CCgKvBDQhuCPWIEqGulzOHzQ6oTGOoRaAHMmvyhroCmW2IHOzxWdI9PIJMHaKEXgjuneNEqoPgViFymIGrUIYRyFxFJE5AZm7eUA8hU0TkNBPfgkq4gOWQ+SOihFr8HjJ7EOOEWgTBzUbkNA/noBK+jw9C5igicQk+Sgp5Q61AW0or4jEsxKfQjwP4LFpRQGAl2lIaESXsg8xFTM0INQmr0ZayHPEYlmMHDqAf27AAgSlYg7bEezATkWhCW8pcRC4cFYkLfz9k/ovnEU8cjko0B7cg04GoDNVQk3EOMt9FVI5qqMXwZXgZz1ZDVVVDVVVDPVH+B74slsxdvI/MAAAAAElFTkSuQmCC) no-repeat;position: relative;top: 33%;left: 38%;width: 106px;height: 29px;}.ppmodal .closeButton{width: 13px;height: 13px;padding: 8px;position: absolute;top: 4px;right: 4px;background: transparent url(https://www.paypalobjects.com/webstatic/checkout/hermes/mb_sprite.png) no-repeat center center;background-size: 13px;text-indent: -999em;-webkit-tap-highlight-color: rgba(0, 0, 0, 0.2);cursor: pointer;}</style></head><body><div><div class="ppmodal loading"><div class="pplogo"></div><div class="mask"></div></div></div></body></html>');
}catch(h){t="unable to write to minibrowser",console.log("unable to write to minibrowser")}return f=!0,f&&(q.intVal=setInterval(function(){return c&&c.closed?(clearInterval(q.intVal),f=!1,l()):void 0},500)),c}function p(){try{var a=window.event?window.event.currentTarget||window.event.target||window.event.srcElement:this;return window.event&&(event.ctrlKey||event.shiftKey||event.metaKey)?(console.log({status:"IC_RENDER_META_KEYPRESS"}),null):r.showMiniB===!1?null:(a&&a.form?a.form.target=r.name:a&&a.tagName&&"a"===a.tagName.toLowerCase()?a.target=r.name:a&&a.tagName&&("img"===a.tagName.toLowerCase()||"button"===a.tagName.toLowerCase())&&"a"===a.parentNode.tagName.toLowerCase()?a.parentNode.target=r.name:a&&a.tagName&&"button"===a.tagName.toLowerCase()&&"a"===a.parentNode.parentNode.tagName.toLowerCase()?a.parentNode.parentNode.target=r.name:this&&this.hasOwnProperty("target")&&"undefined"!=typeof this.target&&(this.target=r.name),document.querySelectorAll("#PPFrame").length||(m(),j(),i()),s=!0,o())}catch(b){console.log({status:"IC_RENDER_ERROR",error_msg:b},!0),t=b}}var q={},r={isSmartPhone:!1,isWebView:!1,currentAgent:getAgent(),showMiniB:!0,supportedAgents:{Chrome:27,IE:9,MSIE:9,Firefox:30,Safari:5.1,Opera:23},secureWindowmsg:e.instant("trans.step2.sipayMaskMessage"),oldIe:navigator.userAgent.match(/MSIE [87]\./i),loadingMsg:"Loading...",returnUrl:null,landingUrl:null,mbWidth:450,mbHeight:728,devMode:!1,name:"PPFrame"},s=!1,t=null,u=null;q.urlPrefix="",q.startFlow=this.startFlow=function(a){if(!q.win||(q.win.focus&&q.win.focus(),a)){a=a||r.landingUrl,a&&0===a.toLowerCase().indexOf("ec-")&&(a=q.urlPrefix+a),a&&(r.fromStartFlow=!0),a&&(a=a.replace(/\s+$/,""));try{u=n(a)}catch(b){console.log("EC Token is not passed in url passed by ajax response")}if(!h()||!r.showMiniB)return void(a?location.href=a:window.name=r.name);var c=r.win||p();c=c||window;try{c.name=c.name||r.name}catch(b){console.log("Mini browser window already opened and trying to change name")}a&&(c.location?c.location=a:c.src=a),r.win&&console.log({status:"IC_CLICK_OPEN_MB_SUCCESS"})}},this.initXO=function(){h()&&r.showMiniB&&(r.win=p())}}]);var witbookerControllers=angular.module("witbooker.controllers",[]);witbookerControllers.controller("StepOne",["$scope","$stateParams","Api","$rootScope","util","$location","$translate","constants","events","tmhDynamicLocale","$filter","$state","$http","$window","md5","$modal",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){function q(b){function c(a,b,d){return a&&!a.hasOwnProperty("establishments")?"undefined"!=typeof a.contactInfo.latitude&&"undefined"!=typeof a.contactInfo.longitude&&(d.showMapButton||(d.showMapButton=!0),b[a.ticker]={establishment:a,lat:a.contactInfo.latitude,lon:a.contactInfo.longitude}):angular.forEach(a.establishments,function(a,e){c(a,b,d)}),b}var f=b.establishment;d.establishment=f,d.representation=b.representation,d.isChain=a.isChain=f&&f.hasOwnProperty("establishments")&&f.establishments.length>0,a.showMapButton=!1,a.util=e,a.pins=c(f,{},a),d.showExtraDesc=function(b,c,d){a.interceptClick(d),b.visualState=b.hasOwnProperty("visualState")?b.visualState:{showPanel:!0},b.visualState.showPanel=b.visualState.showPanel&&b.visualState.panelType!=c?b.visualState.showPanel:!b.visualState.showPanel,b.visualState.panelType=c},a.toggleAccordion=function(a){a.isOpen=a.hasOwnProperty("isOpen")?!a.isOpen:!0},r(d.establishment)}function r(a){var b=d.witbookerParams.representation.collapsedAccordionsConfiguration.split(":"),c=d.witbookerParams.representation.collapsedAccordionsConfiguration;d.witbookerParams.representation.showEstablishmentAccordionHeader="1"==b[0]||a.hasOwnProperty("establishments"),d.witbookerParams.representation.uncollapseAccommodation=!a.hasOwnProperty("establishments")&&("1:1"==c||"1:2"==c||"0:1"==c||"0:2"==c)||a.hasOwnProperty("establishments")&&("1:2"==c||"1:1"==c||"0:2"==c),d.witbookerParams.representation.uncollapseIventoryLIne="2"==b[1],e.setEstablishmentsProperties(a,{isOpen:d.witbookerParams.representation.uncollapseAccommodation}),e.setAccommodationsIsOpenProperty(a,d.witbookerParams.representation.maxLineNumbersBeforeCollapse,d.witbookerParams.representation.uncollapseIventoryLIne)}if(l&&l.params&&l.params.hasOwnProperty("error")&&("paypalError"===l.params.error||"sipayError"===l.params.error)){var s,t,u;u=l.params.error,s=["$scope","$modalInstance",function(a,b){a.closeInfo=function(){b.close()}}],a.message={body:"trans.error."+u},t=p.open({templateUrl:h.assetsDir+"partials/step_one/misc/genericModal.html",controller:s,scope:a})}a.currentState=l.current.name,a.$on(i.TRANSITION_TO_STEP2,function(a,b){var c=STEP2_URL.replace(new RegExp("TICKERPLACEHOLDER","g"),b.establishment).replace("LANGUAGEPLACEHOLDER",d.witbookerParams.representation.locale);"https:"!==window.location.protocol?(c=e.attachGetParams(c,{witif:0}),window.parent.location.href=c):b.establishment!==d.establishment.ticker?window.location.href=c:l.transitionTo("stepTwo",b)}),a.$on(i.REMOVED_FROM_CART,function(a,b){e.updateChildrenAndParentInventories(d.witbookerParams.regularParams.startDate,d.witbookerParams.regularParams.endDate,d.establishment,b,"+1",!0,function(a){a&&(angular.extend(d.affectedAccommodations,a),d.affectedAccommodations.counter=d.affectedAccommodations.counter?d.affectedAccommodations.counter+1:1)})}),a.viewButtoms=function(){a.radioModel="map","stepOne.list"==l.current.name&&(a.radioModel="list")},a.changeLanguage=function(a){g.use(a)},a.constants=h,a.interceptClick=function(a){a&&("A"==a.target.nodeName&&a.target.hasOwnProperty("href")&&window.open(a.target.href),a.preventDefault(),a.stopPropagation())};q(data);d.updateSessionAsync=function(a,b){m.post(UPDATE_SESSION_URL,a).success(function(){b()}).error(function(){})}}]),witbookerControllers.controller("StepTwo",["$scope","$stateParams","Api","$rootScope","util","$location","$translate","constants","events","tmhDynamicLocale","$filter","$state","$http","$window","md5","$modal","$interval","sipay",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){a.currentState=l.current.name;var s=l.params.establishment,t=new Date;a.year=t.getFullYear(),a.util=e,a.customerData={name:void 0,lastName:void 0,email:void 0,confirmationMail:void 0,address:void 0,country:void 0,phone:void 0,comments:void 0,receiveOffers:void 0,passport:void 0},a.paymentData={creditCardData:{ccholder:void 0,cckind:void 0,ccnumber:void 0,ccsecuritycode:void 0,ccvalidtomonth:void 0,ccvalidtoyear:void 0},ccvalidtomonth:void 0,acceptconditions:!1,tpv1:void 0,paymentType:void 0},a.activateWithDummyData=function(b){var c=!1;return"hoteldemo.com.v6"==s&&(35===b.keyCode&&(b.preventDefault(),b.shiftKey&&(c=a.fullWithDummieData(!0))),36===b.keyCode&&(b.preventDefault(),b.shiftKey&&(c=a.fullWithDummieData(!1)))),c},a.$on(i.REMOVED_FROM_CART,function(b,c){e.updateChildrenAndParentInventories(d.witbookerParams.regularParams.startDate,d.witbookerParams.regularParams.endDate,d.establishment,c,"+1",!0,function(a){a&&(angular.extend(d.affectedAccommodations,a),d.affectedAccommodations.counter=d.affectedAccommodations.counter?d.affectedAccommodations.counter+1:1)}),d.cart.reservations&&d.cart.reservations.length<=0&&a.goToStepOne()}),a.$on(i.SUBMIT_PAYMENT_DATA_FORM,function(b,c){a.form.$invalid||(c.paymentType==h.payment.type.paypal_ec?paypal.checkout.initXO():c.paymentType==h.payment.type.tctoken?r.initXO():e.addLoading(".mainStepContainer"),a.paymentData.paymentType=c.paymentType,m.post(STEP2_PROCESS_RESERVATION_URL,{customerData:a.customerData,paymentData:a.paymentData,establishment:{ticker:d.establishment.ticker}}).success(function(a){if(a.id){d.cart={reservations:[],processedReservations:{}};var b;b=c.paymentType==h.payment.type.pointOfSale?e.generateStep3URL(STEP3_TPV_URL,d.establishment.ticker,d.witbookerParams.representation.locale,a.id):e.generateStep3URL(STEP3_CONFIRMATION_URL,d.establishment.ticker,d.witbookerParams.representation.locale,a.id),c.paymentType!=h.payment.type.paypal_ec&&c.paymentType!=h.payment.type.tctoken&&(b=e.attachGetParams(b,e.createLegacyParamsObject(d.witbookerParams.representation)),n.location.href=b)}else{if(c.paymentType==h.payment.type.paypal_ec){var f=STEP2_URL.replace(new RegExp("TICKERPLACEHOLDER","g"),d.establishment.ticker).replace("LANGUAGEPLACEHOLDER",d.witbookerParams.representation.locale);m.post(STEP2_PAYPAL_EXPRESS_CHECKOUT,{ticker:d.establishment.ticker,cancelUrl:f}).success(function(a){function b(){c.closed&&(e.removeLoading(".mainStepContainer"),clearInterval(d))}paypal.checkout.startFlow(a.paypalRedirectUrl);var c=paypal.checkout.win,d=setInterval(b,500)}).error(function(a){e.removeLoading(".mainStepContainer"),alert("Unexpected Error")})}if(c.paymentType==h.payment.type.tctoken){var g=STEP2_SIPAY.replace(new RegExp("TICKERPLACEHOLDER","g"),d.establishment.ticker).replace("LANGUAGEPLACEHOLDER",d.witbookerParams.representation.locale);r.startFlow(g)}}}).error(function(){e.removeLoading(".mainStepContainer")}))}),d.intervalCount=0;m.get(SHOPPING_CART_DATA_URL,{params:{hotelTicker:s,includeServices:!0}}).success(function(b){b&&"[object Array]"===Object.prototype.toString.call(b.reservations)&&b.reservations.length>0?(d.reservationData=b.reservations,d.services=b.services,d.$broadcast(i.RESERVATION_DATA_UPDATE,b.reservations)):a.goToStepOne()}).error(function(){}),a.fullWithDummieData=function(b){return a.customerData={name:"Pepe",lastName:"Trueno",email:"m.carreno@witbooking.com",confirmationMail:"m.carreno@witbooking.com",address:"Aribau 240",country:{id:"AD",name:"Afganiston"},phone:"666777888",comments:"Test de reserva de witbooking",receiveOffers:"",passport:"77777777A"},a.paymentData={creditCardData:{ccholder:"Pepe Trueno",cckind:{id:"Visa",name:"Visa"},ccnumber:"4111111111111111",ccsecuritycode:"666",ccvalidtomonth:"12",ccvalidtoyear:"21"},acceptconditions:!0,tpv1:"",paymentType:null},b},fullWithDummieData=a.fullWithDummieData,a.goToStepOne=function(){l.transitionTo("stepOne.list",{allreservationsinvalid:!1})},d.$on(i.GO_TO_STEP1,function(a,b){l.transitionTo("stepOne.list",{allreservationsinvalid:!1})})}]);var fullWithDummieData;angular.module("witbooker.filters",[]).filter("interpolate",["version",function(a){return function(b){return String(b).replace(/\%VERSION\%/gm,a)}}]).filter("orderObjectBy",function(){return function(a,b){if(!angular.isObject(a))return a;var c=[],d=null;for(d in a)a.hasOwnProperty(d)&&c.push(a[d]);return c.sort(function(a,c){return a=parseInt(a[b],10),c=parseInt(c[b],10),a-c}),c}}).filter("currencyConverter",["currencySettings","$state","$rootScope",function(a,b,c){return function(d,e){var f=-1!=b.current.name.indexOf("stepOne")?c.witbookerParams.representation.step1WithoutTaxes:1,g=1;if(e){var h=e.additionalProperties.defaultCurrency,g=1/a.rates[h]*a.rates[a.currentCurrency];isNaN(g)&&(g=1)}else g=a.conversionRate;return d*g/f}}]).filter("integerDigits",["util",function(a){return function(b){return a.getIntegerDigits(b)}}]).filter("fractionalDigits",["util",function(a){return function(b){return a.getFractionalDigits(b)}}]),angular.module("witbooker.directives",[]).directive("customMarkup",["$rootScope",function(a){return{restrict:"AEC",scope:{markups:"=",position:"=",phase:"="},link:function(b,c,d){if(!a.customMarkupAdded[b.phase]||!a.customMarkupAdded[b.phase][b.position]){var e="";angular.forEach(b.markups,function(a,c){a.position===b.position&&(e+=a.code)}),c.html(e),a.customMarkupAdded[b.phase]||(a.customMarkupAdded[b.phase]={}),a.customMarkupAdded[b.phase][b.position]||(a.customMarkupAdded[b.phase][b.position]=!1)}}}}]).directive("witbookingAppVersion",["version",function(a){return function(b,c,d){c.text(a)}}]).directive("witbookingFrontEndMessages",["constants","util","$sce",function(a,b,c){var d={};return d[a.messages.type.success]="success",d[a.messages.type.notice]="warning",d[a.messages.type.info]="info",d[a.messages.type.error]="danger",{restrict:"AEC",scope:{messages:"=",establishment:"="},link:function(a,c){a.messageAlertClassDict=d,a.closeAlert=function(b){a.messages.splice(b,1)},a.$watch("establishment.allFiltered",function(){angular.forEach(a.messages,function(c,d){if(c.show=!0,c.style="",("BELOW_PERSONAL_INFO_STEP_2"==c.position||"TOP_METHOD_PAYMENT_STEP_2"==c.position)&&(c.style="messagesTwo"),c.unavailable&&!a.establishment.allFiltered&&(c.show=!1),c.hidden&&(c.show=!1),c.start&&c.end){var e=b.parseDate(c.start),f=b.parseDate(c.end),g=new Date;(e>g||g>f)&&(c.show=!1)}})})},templateUrl:a.assetsDir+"partials/step_one/messages.html"}}]).directive("witbookingModalMessages",["constants","util","$modal","$sce",function(a,b,c,d){return{restrict:"AEC",scope:{messages:"=",establishment:"="},link:function(e,f){var g=!1,h=function(){angular.forEach(e.messages,function(a,c){if(a.show=!0,a.style="",("BELOW_PERSONAL_INFO_STEP_2"===a.position||"TOP_METHOD_PAYMENT_STEP_2"===a.position)&&(a.style="messagesTwo"),a.unavailable&&!e.establishment.allFiltered&&(a.show=!1),a.hidden&&(a.show=!1),a.start&&a.end){var d=b.parseDate(a.start),f=b.parseDate(a.end),h=new Date;(d>h||h>f)&&(a.show=!1)}g=g||a.show}),g&&i()},i=function(){var b,f;b=["$scope","$modalInstance",function(a,b){a.ok=function(){b.close()}}],angular.forEach(e.messages,function(a,b){a.descriptionHtml=a.descriptionHtml?a.descriptionHtml:d.trustAsHtml(a.description)}),f=c.open({templateUrl:a.assetsDir+"partials/step_one/misc/modalMessage.html",controller:b,scope:e}),f.result.then(function(){e.messages=[]},function(){e.messages=[]})};e.$watch("establishment.allFiltered",function(a,b){a!==b&&h()}),e.$watch("messages.length",function(){e.messages&&e.messages.length>0&&(angular.forEach(e.messages,function(a,b){a.descriptionHtml=a.descriptionHtml?a.descriptionHtml:d.trustAsHtml(a.description),a.show=!0}),h())})},template:""}}]).directive("witbookingPromotions",["constants","util","$rootScope",function(a,b,c){return{restrict:"AEC",scope:{discounts:"=",toggleAccordion:"="},link:function(a,d){a.discountL=[],a.util=b,c.$watch("witbookerParams.representation.activePromoCodes",function(){a.givenDiscounts=c.witbookerParams.representation.activePromoCodes})},templateUrl:a.assetsDir+"partials/step_one/promotions_accordion.html"}}]).directive("witbookingEstablishment",["constants","$rootScope",function(a,b){return{restrict:"AEC",scope:{establishment:"=",representation:"=",witbookerParams:"=",util:"=",showExtraDesc:"="},link:function(b,c){b.constants=a,b.establishment.media&&b.establishment.media.sort(function(a,b){return a.order-b.order}),b.errorType=a.filters.closed,angular.forEach(b.establishment.inventoryLinesGrouped,function(c,d){angular.forEach(c.inventoryLine,function(c,d){for(var e in c.errorMessage){var f=c.errorMessage[e];if(f.failedFilter==a.filters.closed||f.failedFilter==a.filters.availability||f.failedFilter==a.filters.reservationClosed){b.errorType=a.filters.closed;break}b.errorType=a.filters.restricted}})})},templateUrl:a.assetsDir+"partials/step_one/establishment/hotel.html"}}]).directive("popoverTemplatePopup",["$http","$templateCache","$compile","$timeout","constants",function(a,b,c,d,e){return{restrict:"AEC",replace:!0,scope:{title:"@",content:"@",placement:"@",animation:"&",isOpen:"&",compileScope:"&"},templateUrl:e.assetsDir+"partials/step_one/misc/popover.html",link:function(f,g,h){f.$watch("content",function(h){h&&(h==e.assetsDir+"partials/step_one/misc/reservation_button_popover.html"&&(f.background=e.popover.reservationButton.background),h==e.assetsDir+"partials/step_one/misc/discount_popover.html"&&(f.background=e.popover.discount.background),a.get(h,{cache:b}).then(function(a){var b=angular.element(g[0].querySelector(".popover-content"));b.children().remove(),b.append(c(a.data.trim())(f.$parent)),d(function(){f.$parent.$digest()})}))})}}}]).directive("popoverTemplate",["$tooltip",function(a){return a("popoverTemplate","popover","mouseenter")}]).directive("witbookingAccommodation",["constants","util","$rootScope",function(a,b,c){return{restrict:"AEC",scope:{accommodation:"=",representation:"=",witbookerParams:"=",establishment:"=",showExtraDesc:"="},link:function(d,e){d.util=b,d.constants=a;var f=c.$watch("affectedAccommodations",function(a,b,c){null!=a&&a.hasOwnProperty(d.accommodation.accommodation.ticker)&&(a[d.accommodation.accommodation.ticker]?(d.accommodation.accommodation.hiddenRate=d.accommodation.accommodation.cheapestRate,d.accommodation.accommodation.cheapestRate=null):d.accommodation.accommodation.cheapestRate=d.accommodation.accommodation.cheapestRate?d.accommodation.accommodation.cheapestRate:d.accommodation.accommodation.hiddenRate)},!0);d.$on("$destroy",function(){f()}),d.errorType=a.filters.closed,angular.forEach(d.accommodation.inventoryLine,function(b,c){for(var e in b.errorMessage){var f=b.errorMessage[e];if(f.failedFilter==a.filters.closed||f.failedFilter==a.filters.availability||f.failedFilter==a.filters.reservationClosed){d.errorType=a.filters.closed;break}d.errorType=a.filters.restricted}})},templateUrl:a.assetsDir+"partials/step_one/establishment/accommodation.html"}}]).directive("witbookingInventoryLine",["constants","util","$compile","$templateCache","$timeout","$rootScope","$window","$http","events","$modal",function(a,b,c,d,e,f,g,h,i,j){return{restrict:"AEC",scope:{representation:"=",witbookerParams:"=",establishment:"=",accommodation:"=",line:"=",showExtraDesc:"="},link:function(c,d,g){c.constants=a,c.inventoryLine=c.line,c.$watch("inventoryLine.availability",function(b,c,d){d.showRoomsLeftMessage=d.inventoryLine.availability<=f.witbookerParams.representation.numberOfRoomsLeftLimit;var e=function(a,b){for(var c=[],d=a;b>=d;d++)c.push({id:d,availability:d});return c};if(d.unitSelectorOptions=e(1,Math.min(d.inventoryLine.availability,f.witbookerParams.representation.maxBookableRooms)),d.inventoryLine.reservation={units:d.unitSelectorOptions[0],totalAmount:0,unitAmount:0},d.inventoryLine.errorMessage){d.inventoryLine.displayErrorMessages=[];var g=!1;angular.forEach(d.inventoryLine.errorMessage,function(b,c){if(!g)if(b.failedFilter==a.filters.closed||b.failedFilter==a.filters.availability||b.failedFilter==a.filters.reservationClosed)d.inventoryLine.displayErrorMessages=[{errorType:a.filters.closed,value:null}],g=!0,d.isLocked=!0;else if(b.failedFilter==a.filters.checkInCheckOut){if(!b.value.checkInDays[f.witbookerParams.regularParams.startDate.getDay()]){for(var e=[],h=0;h<b.value.checkInDays.length;h++)b.value.checkInDays[h]&&e.push(new Date(0,0,h));d.inventoryLine.displayErrorMessages.push({errorType:a.filters.checkIn,value:e})}if(!b.value.checkOutDays[f.witbookerParams.regularParams.endDate.getDay()]){for(var e=[],h=0;h<b.value.checkOutDays.length;h++)b.value.checkOutDays[h]&&e.push(new Date(0,0,h));d.inventoryLine.displayErrorMessages.push({errorType:a.filters.checkOut,value:e})}}else d.inventoryLine.displayErrorMessages.push({errorType:b.failedFilter,otherError:!0,value:b.value})})}}),c.util=b,c.constants=a,c.redirectToStep2=function(){$("#disableClick").addClass("loading");var d={id:c.inventoryLine.id,adults:f.witbookerParams.regularParams.occupants.adults,children:f.witbookerParams.regularParams.occupants.children,babies:f.witbookerParams.regularParams.occupants.babies,datein:b.formatDate(f.witbookerParams.regularParams.startDate,a.dateFormat),dateout:b.formatDate(f.witbookerParams.regularParams.endDate,a.dateFormat),selectnumrooms:c.inventoryLine.reservation.units.availability,prom:"undefined"!=typeof f.witbookerParams.regularParams.discountPromoCodes&&f.witbookerParams.representation.activePromoCodes.length>0?f.witbookerParams.representation.activePromoCodes.join(","):"",setconversion:f.witbookerParams.representation.currency,channel:f.witbookerParams.representation.channel?f.witbookerParams.representation.channel:"",tracking_id:f.witbookerParams.representation.tracking_id?f.witbookerParams.representation.tracking_id:""};f.witbookerParams.representation.view&&(d.view=f.witbookerParams.representation.view),f.witbookerParams.representation.iframeMode&&(d.witif=f.witbookerParams.representation.iframeMode?1:0),f.witbookerParams.representation.iframeResizeDomain&&(d.d=f.witbookerParams.representation.iframeResizeDomain),f.witbookerParams.representation.witaffiliate&&(d.witaffiliate=f.witbookerParams.representation.witaffiliate),f.witbookerParams.representation.affiliate&&(d.affiliate=f.witbookerParams.representation.affiliate),"undefined"!=typeof f.witbookerParams.representation.iframeMode&&f.witbookerParams.representation.iframeMode&&(d.witif=1);var g=b.generateLegacyBookingUrl(c.establishment,f.witbookerParams.representation.locale,d),k={inventoryLine:c.inventoryLine,accommodation:c.accommodation.accommodation,quantity:c.inventoryLine.reservation.units.availability,startDate:f.witbookerParams.regularParams.startDate,endDate:f.witbookerParams.regularParams.endDate,establishment:{ticker:c.establishment.ticker}},l=c.inventoryLine.condition.paymentTypes,m=!0;return angular.forEach(f.cart.reservations,function(d,e){if(l=b.intersectSimpleArrays(l,d.inventoryLine.condition.paymentTypes,function(a){return a.ticker}),!l||l.length<=0){m=!1,c.message={body:"trans.step1.incompatiblePaymentTypes"};var f=["$scope","$modalInstance",function(a,b){a.closeInfo=function(){b.close()}}];j.open({templateUrl:a.assetsDir+"partials/step_one/misc/genericModal.html",controller:f,scope:c})}else;}),m?void h.post(SHOPPING_CART_URL,{inventoryLine:c.inventoryLine.ticker,inventoryID:c.inventoryLine.id,quantity:c.inventoryLine.reservation.units.availability,startDate:b.formatDate(f.witbookerParams.regularParams.startDate,a.dateFormat),endDate:b.formatDate(f.witbookerParams.regularParams.endDate,a.dateFormat),establishment:{ticker:c.establishment.ticker},parentEstablishment:{ticker:f.establishment.ticker},next:g}).success(function(a){$("#disableClick").removeClass("loading"),k.id=a.id,f.$broadcast(i.ADDED_TO_CART,k,g),e(function(){var a=$(".reservationsList:last");a.hide(),"parentIFrame"in window?(window.parentIFrame.scrollTo(0,0),a.slideDown()):$("body").animate({scrollTop:0},700,function(){a.slideDown()})})}).error(function(){}):void $("#disableClick").removeClass("loading")}},templateUrl:a.assetsDir+"partials/step_one/establishment/inventoryLine.html"}}]).directive("witbookingBookingForm",["constants","util","Api","$rootScope","events","$filter","$parse","$state","$modal",function(a,b,c,d,e,f,g,h,i){return{restrict:"AEC",scope:{representation:"=",witbookerParams:"="},link:function(f,h,j){f.extraFilters={};var k=function(a,b){for(var c=[],d=a;b>=d;d++)c.push({id:d,availability:d});return c};d.externalData;var l=d.$watch("externalData",function(){if("undefined"!=typeof d.externalData&&"getAvailability"==d.externalData.actionType&&f.getAvailabilityExternalCall(d.externalData),"undefined"!=typeof d.externalData&&"getAvailabilityChart"==d.externalData.actionType){f.message={body:"trans.step2.modalCalendar"};var b=["$scope","$modalInstance",function(a,b){a.closeInfo=function(){return b.close(),!1},a.follow=function(){b.close(),f.getAvailabilityExternalCallChart(d.externalData)}}];i.open({templateUrl:a.assetsDir+"partials/step_two/misc/modalOkClose.html",controller:b,scope:f})}}),m=d.$on("$stateChangeSuccess",function(a,b,c,d,e){"stepTwo"==d.name&&"true"==c.allreservationsinvalid&&(f.getAvailability(),m())});f.$on("$destroy",function(){l()}),f.hideAgeIndicator=!1,d.witbookerParams.regularParams.occupants.restriction==a.occupant.restriction.TAKE_ALL_PEOPLE&&(f.hideAgeIndicator=!0),f.seniorSelectorOptions=k(0,witbookerParams.representation.maxSeniors),f.adultSelectorOptions=k(1,witbookerParams.representation.maxAdults),f.childSelectorOptions=k(0,witbookerParams.representation.maxChildren),f.teenagerSelectorOptions=k(0,witbookerParams.representation.maxTeenagers),f.babySelectorOptions=k(0,witbookerParams.representation.maxBabies);var n=function(a,b){for(var c=0;c<a.length;c++)if(a[c].availability==d.witbookerParams.regularParams.occupants[b])return a[c];return a[0]};f.seniors=n(f.seniorSelectorOptions,"seniors"),f.adults=n(f.adultSelectorOptions,"adults"),f.teenagers=n(f.teenagerSelectorOptions,"teenagers"),f.children=n(f.childSelectorOptions,"children"),f.babies=n(f.babySelectorOptions,"babies"),(-1==d.witbookerParams.regularParams.occupants.adults||d.witbookerParams.representation.allowsDisablingOccupationFilter)&&(f.adultSelectorOptions.push({id:"*",availability:"*"}),-1==d.witbookerParams.regularParams.occupants.adults&&(f.adults=f.adultSelectorOptions[f.adultSelectorOptions.length-1])),f.hideAdultSelector=!1,f.hideChildSelector=!1,f.hideBabySelector=!1,f.counterEntryDate=0,f.counterExitDate=0,d.witbookerParams.representation.maxAdults<=0&&(f.hideAdultSelector=!0,f.adults=f.adultSelectorOptions[0]),(d.witbookerParams.representation.maxChildren<=0||d.witbookerParams.regularParams.occupants.restriction==a.occupant.restriction.TAKE_ALL_PEOPLE)&&(f.hideChildSelector=!0,f.children=f.childSelectorOptions[0]),(d.witbookerParams.representation.maxBabies<=0||d.witbookerParams.regularParams.occupants.restriction!=a.occupant.restriction.TAKE_ADULT_CHILD_BABY&&d.witbookerParams.regularParams.occupants.restriction!=a.occupant.restriction.TAKE_ADULT_TEENAGER_CHILD_BABY&&d.witbookerParams.regularParams.occupants.restriction!=a.occupant.restriction.TAKE_SENIOR_ADULT_TEENAGER_CHILD_BABY)&&(f.hideBabySelector=!0,f.babies=f.babySelectorOptions[0]),(d.witbookerParams.representation.maxTeenagers<=0||d.witbookerParams.regularParams.occupants.restriction!=a.occupant.restriction.TAKE_ADULT_TEENAGER_CHILD&&d.witbookerParams.regularParams.occupants.restriction!=a.occupant.restriction.TAKE_ADULT_TEENAGER_CHILD_BABY&&d.witbookerParams.regularParams.occupants.restriction!=a.occupant.restriction.TAKE_SENIOR_ADULT_TEENAGER_CHILD_BABY)&&(f.hideTeenagerSelector=!0,f.teenagers=f.teenagerSelectorOptions[0]),(d.witbookerParams.representation.maxSeniors<=0||d.witbookerParams.regularParams.occupants.restriction!=a.occupant.restriction.TAKE_SENIOR_ADULT_TEENAGER_CHILD_BABY)&&(f.hideSeniorSelector=!0,f.seniors=f.seniorSelectorOptions[0]),f.adultMinAge=f.hideTeenagerSelector?witbookerParams.representation.childrenMaxAge+1:witbookerParams.representation.teenagerMaxAge+1,d.witbookerParams.regularParams.occupants.restriction==a.occupant.restriction.NONE&&(f.hideAdultSelector=!0,f.hideChildSelector=!0,f.hideBabySelector=!0,f.hideTeenagerSelector=!0,f.hideSeniorSelector=!0),d.witbookerParams.representation.filterGuestsByAge?(f.hideBabySelector=!0,f.hideTeenagerSelector=!0,f.hideSeniorSelector=!0):f.witbookerParams.regularParams.occupants.guestAges=[];var o=function(a,b){var c=[];c.push({id:a,text:"<"+a}),a++;for(var d=a;b>=d;d++)c.push({id:d,text:d});return c};if(d.witbookerParams.representation.filterGuestsByAge){var p=d.witbookerParams.representation.teenagerMaxAge,q=d.witbookerParams.representation.babyMinAge;f.guestAgesSelectorOptions=o(q,p),f.childrenFilterMinAge=q,f.childrenFilterMaxAge=p}d.witbookerParams.regularParams,d.witbookerParams.representation;d.witbookerParams.representation.filterGuestsByAge&&d.witbookerParams.regularParams.occupants.guestAges.length>0&&(f.children=f.childSelectorOptions[d.witbookerParams.regularParams.occupants.guestAges.length]),f.entryDate=b.formatDate(d.witbookerParams.regularParams.startDate,a.dateFormat),f.exitDate=b.formatDate(d.witbookerParams.regularParams.endDate,a.dateFormat);var r=g(h.find("#datepickerEntryDate").attr("ng-model")),s=g(h.find("#datepickerExitDate").attr("ng-model"));$(function(){$("#datepickerEntryDate").datepicker({regional:d.witbookerParams.representation.locale,dateFormat:"dd-mm-yy",minDate:0,onSelect:function(a,b){f.$apply(function(b){r.assign(b,a)})}}),$("#datepickerExitDate").datepicker({regional:d.witbookerParams.representation.locale,dateFormat:"dd-mm-yy",minDate:1,maxDate:d.witbookerParams.representation.maxBookableNights,onSelect:function(a,b){f.$apply(function(b){s.assign(b,a)})}}),"en"==d.witbookerParams.representation.locale?($("#datepickerEntryDate").datepicker("option",$.datepicker.regional[""]),$("#datepickerExitDate").datepicker("option",$.datepicker.regional[""])):($("#datepickerEntryDate").datepicker("option",$.datepicker.regional[d.witbookerParams.representation.locale]),$("#datepickerExitDate").datepicker("option",$.datepicker.regional[d.witbookerParams.representation.locale])),$("#datepickerEntryDate").datepicker("option","dateFormat","dd-mm-yy"),$("#datepickerExitDate").datepicker("option","dateFormat","dd-mm-yy")}),f.$watch("entryDate",function(){var c=b.parseDate(f.exitDate),e=b.parseDate(f.entryDate);e>=c&&(c=new Date(e.getTime()),c.setDate(c.getDate()+1),s.assign(f,b.formatDate(c,a.dateFormat)));var g=d.witbookerParams.representation.maxBookableNights,h=new Date(e.getTime());h.setDate(h.getDate()+1),$("#datepickerExitDate").datepicker("option","minDate",h);var i=new Date(e.getTime());i.setDate(i.getDate()+g),$("#datepickerExitDate").datepicker("option","maxDate",i),f.counterEntryDate>0&&$(".sendBookingForm").addClass("formChanged"),f.counterEntryDate++}),f.$watch("exitDate",function(){var c=b.parseDate(f.exitDate),d=b.parseDate(f.entryDate);d>=c&&(d=new Date(c.getTime()),d.setDate(d.getDate()-1),r.assign(f,b.formatDate(d,a.dateFormat))),f.counterExitDate>0&&($(".sendBookingForm").addClass("formChanged"),"undefined"!=typeof $(".sendBookingForm").data("disabledFormChanged")&&$(".sendBookingForm").data("disabledFormChanged")&&($(".sendBookingForm").removeClass("formChanged"),$(".sendBookingForm").data("disabledFormChanged",!1))),f.counterExitDate++}),f.formChanged=function(a){$(".sendBookingForm").addClass("formChanged")},f.formKidsChanged=function(){for(var a=0;a<f.children.availability;a++)"undefined"==typeof d.witbookerParams.regularParams.occupants.guestAges[a]&&(d.witbookerParams.regularParams.occupants.guestAges[a]=0);d.witbookerParams.regularParams.occupants.guestAges.splice(f.children.availability,Number.MAX_VALUE)},f.getAvailabilityExternalCall=function(a){$(".sendBookingForm").removeClass("formChanged");var f=$("#disableClick");f.addClass("loading"),d.witbookerParams.regularParams.startDate=b.parseDate(a.startDate),d.witbookerParams.regularParams.endDate=b.parseDate(a.endDate),d.witbookerParams.regularParams.occupants.adults=a.adults.availability?a.adults.availability:0,d.witbookerParams.regularParams.occupants.children=a.children.availability?a.children.availability:0,d.witbookerParams.regularParams.occupants.babies=a.babies.availability?a.babies.availability:0,d.witbookerParams.regularParams.occupants.teenagers=a.teenager.availability?a.teenagers.availability:0,d.witbookerParams.regularParams.occupants.seniors=a.senior.availability?a.seniors.availability:0,a.promoCode&&a.promoCode.length>0&&(d.witbookerParams.regularParams.inventoryPromoCodes=a.promoCode,d.witbookerParams.regularParams.discountPromoCodes=a.promoCode);var g=angular.copy(d.witbookerParams);g.regularParams.startDate=a.startDate,g.regularParams.endDate=a.endDate;var h=c.ARI.post(g,function(){d.$broadcast(e.UPDATE_AVAILABILITY,h),f.removeClass("loading")})},f.getAvailabilityExternalCallChart=function(i){$(".sendBookingForm").data("disabledFormChanged",!0);var j=$("#disableClick");j.addClass("loading");var k=(d.witbookerParams.regularParams.endDate-d.witbookerParams.regularParams.startDate)/864e5;d.witbookerParams.regularParams.startDate=b.parseDate(i.startDate),d.witbookerParams.regularParams.endDate=b.parseDate(i.startDate),d.witbookerParams.regularParams.endDate.setDate(b.parseDate(i.startDate).getDate()+k);var l=angular.copy(d.witbookerParams);l.regularParams.startDate=i.startDate,l.regularParams.endDate=b.formatDate(d.witbookerParams.regularParams.endDate,a.dateFormat);var m=g(h.find("#datepickerEntryDate").attr("ng-model")),n=g(h.find("#datepickerExitDate").attr("ng-model"));m.assign(f,l.regularParams.startDate),n.assign(f,l.regularParams.endDate);var o=c.ARI.post(l,function(){d.$broadcast(e.UPDATE_AVAILABILITY,o),j.removeClass("loading")})},f.util=b,f.getAvailability=function(){$(".sendBookingForm").removeClass("formChanged");var a=$("#disableClick");a.addClass("loading"),d.witbookerParams.regularParams.startDate=b.parseDate(this.entryDate),
d.witbookerParams.regularParams.endDate=b.parseDate(this.exitDate),d.witbookerParams.regularParams.occupants.adults=this.adults.availability,d.witbookerParams.regularParams.occupants.children=this.children.availability,d.witbookerParams.regularParams.occupants.babies=this.babies.availability,d.witbookerParams.regularParams.occupants.teenagers=this.teenagers.availability,d.witbookerParams.regularParams.occupants.seniors=this.seniors.availability;for(var f=0;f<d.witbookerParams.regularParams.occupants.guestAges.length;f++)d.witbookerParams.regularParams.occupants.guestAges[f]=parseInt(d.witbookerParams.regularParams.occupants.guestAges[f],10);this.promoCode&&this.promoCode.split(",").length>0&&(d.witbookerParams.regularParams.inventoryPromoCodes=b.removeDuplicatesFromSimpleArray(d.witbookerParams.representation.activePromoCodes.concat(this.promoCode.split(","))),d.witbookerParams.regularParams.discountPromoCodes=b.removeDuplicatesFromSimpleArray(d.witbookerParams.representation.activePromoCodes.concat(this.promoCode.split(",")))),d.witbookerParams.regularParams.newPromoCodes=this.promoCode?this.promoCode.split(","):[];var g=angular.copy(d.witbookerParams);g.regularParams.startDate=this.entryDate,g.regularParams.endDate=this.exitDate;var h=c.ARI.post(g,function(){d.$broadcast(e.UPDATE_AVAILABILITY,h),a.removeClass("loading")})},f.cleanFilters=function(){d.witbookerParams.regularParams.extra={},d.witbookerParams.representation.activeExtraFilters={},d.updateSessionAsync({regularParams:{extra:{il_like:[],il_equal:[]}},representation:{ticker:d.witbookerParams.representation.ticker}},function(){f.getAvailability()})},f.promotionCodeOpen=d.witbookerParams.representation.showPromoCodeInputField},templateUrl:a.assetsDir+"partials/step_one/booking_form.html"}}]).directive("witbookingInfoPanel",["$compile","$http","$templateCache","constants",function(a,b,c,d){var e=function(a){if(!a)return null;var e,f=d.assetsDir+"partials/step_one/misc/",g={};g[d.panel.type.carousel]="info_panel_carousel.html",g[d.panel.type.description]="info_panel_text.html";var h=f+g[a];return e=b.get(h,{cache:c})},f=function(b,c,f){b.constants=d,b.$watch("type",function(){if(b.type){var d=e(b.type);d.success(function(d){c.empty().append(a(d)(b))});d.error(function(){console.log("error")})}})};return{restrict:"AEC",scope:{type:"=",establishment:"=",title:"="},link:f}}]).directive("witbookingCarousel",["$compile","$http","$templateCache","constants","util","$rootScope","events",function(a,b,c,d,e,f,g){return{transclude:!0,scope:{type:"=",establishment:"=",title:"="},controller:["$scope",function(a){var b=function(){a.constants=d,a.myInterval=5e8;var b=a.slides=[],c=!a.$parent.establishment.hasOwnProperty("inventoryLinesGrouped"),g=c?"accommodation":"hotel",h={width:"750",height:"500",png:!1};h=null,angular.forEach(a.$parent.establishment.media,function(c,d){b.push({image:e.generateImgUrl(a.$parent.$parent.$parent.establishment,a.$parent.establishment,g,c.path,h),title:c.name,text:c.description,close:f.showExtraDesc,elementType:a.$parent.establishment})})};b();var c=a.$on(g.CHANGE_LANGUAGE_DONE,function(){b()});a.$on("$destroy",function(){c()})}],templateUrl:d.assetsDir+"partials/step_one/misc/info_panel_carousel.html"}}]).directive("witbookingInfoPanelStatic",["$compile","$http","$templateCache","constants","$rootScope",function(a,b,c,d,e){return{require:"^?witCarousel",restrict:"AEC",transclude:!0,scope:{type:"=",establishment:"=",rootEstablishment:"=",title:"="},link:function(a,b,c){a.constants=d,a.close=e.showExtraDesc,a.elementType=a.establishment,a.isAdditionalInfoVisible=!1,a.toggleAdditionalInfo=function(){a.isAdditionalInfoVisible=!a.isAdditionalInfoVisible}},templateUrl:d.assetsDir+"partials/step_one/misc/info_panel.html"}}]).directive("witbookingMap",["$compile","$http","$templateCache","$window","$timeout","constants","$rootScope","$translate",function(a,b,c,d,e,f,g,h){return{restrict:"AEC",transclude:!0,scope:{type:"=",establishment:"=",title:"=",pins:"=",mapid:"="},link:function(a,b){var c=function(){var b={},c=new google.maps.LatLngBounds,d=function(){var d,e=new google.maps.Map(document.getElementById("map-canvas-"+a.mapid),b),f=new google.maps.InfoWindow,i=a.pins?a.pins:[{establishment:a.establishment,lat:a.establishment.contactInfo.latitude,lon:a.establishment.contactInfo.longitude}];if(angular.forEach(i,function(a,b){var i=new google.maps.LatLng(a.lat,a.lon);c.extend(i),d=new google.maps.Marker({position:i,map:e,title:a.establishment.name}),google.maps.event.addListener(d,"click",function(b){return function(){var c=document.createElement("div"),d=a.establishment.ticker?a.establishment.ticker:"",i=a.establishment.contactInfo.address?a.establishment.contactInfo.address:"",j=a.establishment.contactInfo.city?a.establishment.contactInfo.city:"",k=a.establishment.contactInfo.country?a.establishment.contactInfo.country:"",l=a.establishment.cheapestRate?h.instant("trans.step1.map.from")+" "+(a.establishment.cheapestRate?a.establishment.cheapestRate.toString().match(/^\d+(?:\.\d{0,2})?/):"")+" "+g.witbookerParams.representation.currency:"";f.setContent('<div class="info_content" style="min-width: 200px"><h3>'+a.establishment.name+"</h3><p>"+i+"</p><p>"+j+","+k+"</p><p><b>"+l+"</b></p><button onclick=\"$('#listStepOne').click();$('#"+d.trim()+'\').animate({ scrollTop: 0 }, 600);" title="'+h.instant("trans.step1.map.reservationButton")+'" class="btn btn-success"><span>'+h.instant("trans.step1.map.reservationButton")+'</span>&nbsp;<i class="sprite bookCart" alt="cart"></i></button></div>'),google.maps.event.addDomListener(c,"click",function(a){return function(){}}(b)),f.open(e,b)}}(d))}),Object.keys(i).length>1)e.fitBounds(c);else{var j=new google.maps.LatLng(i[Object.keys(i)[0]].lat,i[Object.keys(i)[0]].lon);e.setCenter(j),e.setZoom(15)}};e(function(){e(function(){d()},0)},0)};d.initialize=c,a.loadScript=function(){var a=document.createElement("script");a.type="text/javascript",a.src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false&callback=initialize",document.body.appendChild(a)},"undefined"!=typeof google&&"undefined"!=typeof google.maps?c():a.loadScript()},templateUrl:f.assetsDir+"partials/step_one/establishment/map.html"}}]).directive("witbookingChart",["Api","util","constants","$timeout","$rootScope","$filter","$translate","events",function(a,b,c,d,e,f,g,h){return{restrict:"AEC",scope:{establishment:"=",inventoryLine:"=",chartid:"="},link:function(i,j){i.close=e.showExtraDesc,i.elementType=i.establishment,i.constants=c,i.isLoading=!0;var k=function(){var c=a.Chart.get({ticker:i.establishment.ticker,inventory:i.inventoryLine.ticker,numberOfMonths:12,currency:e.witbookerParams.representation.currency},function(){i.isLoading=!1;var a,h=[],j={},k={};i.priceTranslated=g.instant("trans.step1.price"),angular.forEach(c.rate,function(c,d){var e=b.parseDate(c.startDate),h=b.parseDate(c.endDate),l=[];do{"undefined"==typeof j[e.getMonth()+"-"+e.getFullYear()]&&(j[e.getMonth()+"-"+e.getFullYear()]=[["Día","Precio"]]),"undefined"==typeof k[e.getMonth()+"-"+e.getFullYear()]&&(k[e.getMonth()+"-"+e.getFullYear()]={minValue:0,maxValue:-1},a=k[e.getMonth()+"-"+e.getFullYear()]),a.maxValue=a.maxValue<c.value?c.value:a.maxValue;var m=f("date")(e,"dd MMMM yyyy").toUpperCase()+"\n"+(0==c.value?g.instant("trans.closed").toUpperCase():i.priceTranslated+" : "+f("number")(c.value,2)+"€");if(l=[""+e.getDate(),0==c.value?a.maxValue:c.value,m,0==c.value?"silver":"",f("date")(e,"dd-MM-yyyy")],j[e.getMonth()+"-"+e.getFullYear()].push(l),e.getTime()==h.getTime())break;e.setDate(e.getDate()+1)}while(e.getTime()<=h.getTime())});var l=e.witbookerParams.regularParams,m=(e.witbookerParams.representation,0);angular.forEach(j,function(a,b){var c=b.split("-")[0],d=b.split("-")[1];l.startDate.getMonth()==c-1&&(m=h.length-1);var g=new Date(0,parseInt(c)+1,0);h.push({date:{month:"",year:d,monthname:f("date")(g,"MMMM")},values:a,coin:e.witbookerParams.representation.currencySymbol,minValue:k[b].minValue,maxValue:k[b].maxValue})}),c={current:m,data:h},d(function(){d(function(){c.wrapper=document.getElementById("chart-canvas-"+i.chartid),c.wrapper.innerHTML="",witPlotter(c)},0)},0)})};k();var l=i.$on(h.CHANGE_LANGUAGE_DONE,function(){k()});i.$on("$destroy",function(){l()})},templateUrl:c.assetsDir+"partials/step_one/misc/chart.html"}}]).directive("witbookingCart",["util","constants","$timeout","$rootScope","events","$http","$modal","$state",function(a,b,c,d,e,f,g,h){return{restrict:"AEC",scope:{type:"=",establishment:"=",title:"=",size:"="},link:function(c,h){c.constants=b,c.util=a,c.cart=d.cart,c.services={},c.witbookerParams=d.witbookerParams,c.goToStepOne=function(){d.$broadcast(e.GO_TO_STEP1,{establishment:d.establishment.ticker})},c.goToStepTwo=function(){d.$broadcast(e.TRANSITION_TO_STEP2,{establishment:d.establishment.ticker})},c.extrasFolded=d.witbookerParams.representation.extrasFolded;var i=d.$on(e.UPDATE_SERVICE_RATE,function(a,b){b.reservation.hasOwnProperty("serviceRate")||(b.reservation.serviceRate=0),b.reservation.serviceRate+=b.amount,c.cart.total+=b.amount});c.removeReservation=function(a){var b=c.cart.reservations[a];f.post(REMOVE_SHOPPING_CART_URL,{id:b.id,establishment:{ticker:b.establishment.ticker},origin:"java"}).success(function(f){b.serviceRate=b.serviceRate?b.serviceRate:0,c.cart.total-=b.rate+b.serviceRate,c.cart.reservations.splice(a,1),d.$broadcast(e.REMOVED_FROM_CART,b)}).error(function(){})};var j=(c.$on(e.ADDED_TO_CART,function(a,b,f){c.cart=d.cart,c.cart.total="undefined"==typeof c.cart.total?0:c.cart.total;var g=!1,h=0,i=null;angular.forEach(c.cart.reservations,function(a,c){g||a.id!=b.id||(g=!0,a.inventoryLine.services=b.inventoryLine.services,a.inventoryLine.condition=b.inventoryLine.condition,h=a.rate,i=a)}),b.rate=b.inventoryLine.totalRate*b.quantity,b.originalRate=b.inventoryLine.originalRate*b.quantity,g?(i.rate=b.rate,i.originalRate=b.originalRate,c.cart.total+=-h+b.rate):(d.cart.reservations.push(b),c.cart.total+=b.rate),d.$broadcast(e.UPDATE_INVENTORIES_BY_CART,b,f)}),function(f,h,i){c.services=d.services;var j=[];if("undefined"==typeof d.cart&&(d.cart={},d.cart.reservations=[]),angular.forEach(d.reservationData,function(b,c){b.startDate="[object Date]"!=Object.prototype.toString.call(b.startDate)?a.parseDate(b.startDate):b.startDate,b.endDate="[object Date]"!=Object.prototype.toString.call(b.endDate)?a.parseDate(b.endDate):b.endDate,0==b.inventoryLine.errorMessage.length?d.$broadcast(e.ADDED_TO_CART,b):j.push(b)}),j.length>0){c.deletedReservations=j,("undefined"==typeof d.reservationData||null==d.reservationData||0==d.reservationData.length||d.reservationData.length==c.deletedReservations.length)&&(c.allReservationsInvalid=!0);var k=function(){if(c.allReservationsInvalid){console.log("handled");var a=STEP1_URL.replace(new RegExp("TICKERPLACEHOLDER","g"),d.witbookerParams.representation.ticker).replace("LANGUAGEPLACEHOLDER",d.witbookerParams.representation.locale);window.location=a}},l=["$scope","$modalInstance",function(a,b){a.ok=function(){b.close()}}],m=g.open({templateUrl:b.assetsDir+"partials/step_one/misc/cartNotification.html",controller:l,scope:c});m.result.then(function(a){k()},function(){k()})}}),k=d.$on(e.RESERVATION_DATA_UPDATE,j);d.cartInfoProcessed||(j(),d.cartInfoProcessed=!0),c.$on("$destroy",function(){d.reservationData=[],k(),i()}),c.openInfo=function(a){c.info=a;var d=["$scope","$modalInstance",function(a,b){a.closeInfo=function(){b.close()}}];g.open({templateUrl:b.assetsDir+"partials/step_one/misc/cartInfo.html",controller:d,scope:c})}},templateUrl:b.assetsDir+"partials/step_one/shopping_cart.html"}}]).directive("witbookingDiscounts",["constants",function(a){return{restrict:"AEC",scope:{discounts:"="},link:function(a,b){},templateUrl:a.assetsDir+"partials/step_one/misc/info_discounts.html"}}]).directive("witbookingLocalization",["util","constants","$timeout","$translate","$rootScope","events","Api","$http","currencySettings",function(a,b,c,d,e,f,g,h,i){return{restrict:"AEC",scope:{languages:"=",currencies:"=",witbookerParams:"="},link:function(c,g){c.constants=b,c.changeLanguage=function(a,b){$("#disableClick").addClass("loading"),d.use(a),e.witbookerParams.representation.locale=a,e.$broadcast(f.CHANGE_LANGUAGE,a,b)},c.changeCurrency=function(b,c){$("#disableClick").addClass("loading");var d=e.witbookerParams.representation.currency;e.witbookerParams.representation.currency=b,e.witbookerParams.representation.currencySymbol=c,e.$broadcast(f.CHANGE_CURRENCY,{defaultCurrency:e.witbookerParams.representation.defaultCurrency,previousCurrency:d,newCurrency:b}),$("#disableClick").removeClass("loading");var g=a.attachGetParams(CURRENCY_CONVERSION_RATE,{previousCurrency:d,newCurrency:b,defaultCurrency:i.defaultCurrency,hotelTicker:e.establishment.ticker});h.get(g,{}).success(function(a){a.error&&console.log("There was an error in the conversion service")}).error(function(){})}},templateUrl:b.assetsDir+"partials/localized_menu.html"}}]).directive("fallbackSrc",function(){var a={link:function(a,b){b.bind("error",function(){angular.element(this).attr("src","/WitBooker/img/NoPhoto.jpg")})}};return a}).directive("witbookingAvailability",["$compile","$http","$templateCache","constants","util","$rootScope",function(a,b,c,d,e,f){return{scope:{establishment:"=",witbookerParams:"="},link:function(a,b){},templateUrl:d.assetsDir+"partials/step_one/availability.html"}}]).directive("witbookingErrorAlert",["$compile","$http","$templateCache","constants","util","$rootScope",function(a,b,c,d,e,f){return{scope:{errorMessage:"="},link:function(a,b){var c=a.errorMessage;(c.failedFilter==d.filters.occupationType||c.failedFilter.toLowerCase()==(d.filters.filterPrefix+d.filters.occupationType).toLowerCase())&&(a.constants=d,a.alert={errorType:d.filters.occupationType,value:{adults:c.value.occupants.adults,children:c.value.occupants.children,babies:c.value.occupants.babies},alertType:"warning",show:!0,close:function(){a.alert.show=!1}})},templateUrl:d.assetsDir+"partials/step_one/errorAlert.html"}}]).directive("witbookingService",["$compile","$http","$templateCache","constants","util","$rootScope","events","$modal",function(a,b,c,d,e,f,g,h){return{scope:{service:"=",reservation:"=",inventoryLine:"=",establishment:"="},link:function(a,c){a.util=e,a.isSelected=!1,"undefined"!=typeof a.reservation.establishment&&a.service.media.length>0&&(a.service.image=e.generateImgUrl(a.reservation.establishment,a.service,"extra",a.service.media[0].path,{width:"150"}),a.service.thumbnail=e.generateImgUrl(a.reservation.establishment,a.service,"extra",a.service.media[0].path,{width:"62"})),a.constants=d;var i=e.getIntegerDigits(a.reservation.endDate-a.reservation.startDate)/864e5;if("undefined"==typeof a.inventoryLine.selectedServices&&(a.inventoryLine.selectedServices={quantity:0}),a.updateReservation=function(a,c){b.post(UPDATE_CART_DATA_URL,{id:a.id,establishment:{ticker:a.establishment.ticker},service:[{ticker:c.ticker,availability:a.inventoryLine.selectedServices[c.ticker].units?a.inventoryLine.selectedServices[c.ticker].units.availability:-1,selected:a.inventoryLine.selectedServices[c.ticker].selected?a.inventoryLine.selectedServices[c.ticker].selected:!1}]}).success(function(a){console.log("SERVICE UPDATED "),console.log(a)}).error(function(a){console.log("SERVICE UPDATED FAIL "),console.log(a)})},a.service.type==d.serviceType.units){a.$watch("inventoryLine.selectedServices[service.ticker].units.availability",function(b,c){c!==b&&(a.inventoryLine.selectedServices[a.service.ticker].updated=!1,j(b,c,!0))});var j=function(b,c,h){a.rate=0,a.isSelected=a.inventoryLine.selectedServices[a.service.ticker].units.availability>0,a.inventoryLine.selectedServices[a.service.ticker].selected=a.isSelected,a.selectedMultiplier=a.isSelected?1:0;var j=e.calculateServiceRate(a.service,a.reservation.inventoryLine.capacity,a.reservation.quantity,c,i,d),k=e.calculateServiceRate(a.service,a.reservation.inventoryLine.capacity,a.reservation.quantity,b,i,d);a.rate=k,f.$broadcast(g.UPDATE_SERVICE_RATE,{reservation:a.reservation,amount:k-j}),(!a.inventoryLine.selectedServices[a.service.ticker].updated||h)&&c!=b&&a.updateReservation(a.reservation,a.service)};a.$on(g.UPDATE_SERVICE_QUANTITY,function(b,c,d){a.inventoryLine.selectedServices[a.service.ticker].updated=!1,j(c,d,!0)});var k=function(a,b){for(var c=[],d=a;b>=d;d++)c.push({id:d,availability:d});return c};a.unitSelectorOptions=k(0,a.service.maxUnits),a.inventoryLine.selectedServices.hasOwnProperty(a.service.ticker)||(a.inventoryLine.selectedServices[a.service.ticker]={service:a.service,units:null,selected:!1}),(null==a.inventoryLine.selectedServices[a.service.ticker].units||0==a.inventoryLine.selectedServices[a.service.ticker].units.availability)&&(a.inventoryLine.selectedServices[a.service.ticker].units=a.unitSelectorOptions[0]);for(var l=0;l<a.unitSelectorOptions.length;l++){if(a.reservation.selectedServices&&a.reservation.selectedServices.hasOwnProperty(a.service.ticker)&&null!=a.reservation.selectedServices[a.service.ticker].availability&&a.unitSelectorOptions[l].availability==a.reservation.selectedServices[a.service.ticker].availability){a.inventoryLine.selectedServices[a.service.ticker].units=a.unitSelectorOptions[l];break}if(null!=a.inventoryLine.selectedServices[a.service.ticker].units&&0!=a.unitSelectorOptions[l].availability&&a.unitSelectorOptions[l].availability==a.inventoryLine.selectedServices[a.service.ticker].units.availability){a.inventoryLine.selectedServices[a.service.ticker].units=a.unitSelectorOptions[l];break}}f.servicesProcessed.hasOwnProperty([a.reservation.id+a.service.ticker])||a.$broadcast(g.UPDATE_SERVICE_QUANTITY,a.inventoryLine.selectedServices[a.service.ticker].units.availability,0),f.servicesProcessed[a.reservation.id+a.service.ticker]={processed:!0},a.inventoryLine.selectedServices[a.service.ticker].updated=!0,a.rate=e.calculateServiceRate(a.service,a.reservation.inventoryLine.capacity,a.reservation.quantity,a.inventoryLine.selectedServices[a.service.ticker].units.availability,i,d),a.isSelected=a.inventoryLine.selectedServices[a.service.ticker].units.availability>0}else{a.$watch("inventoryLine.selectedServices[service.ticker].selected",function(b,c){c!=b&&(a.inventoryLine.selectedServices[a.service.ticker].updated=!1,j(b,c,!0))}),a.$on(g.UPDATE_SERVICE_SELECTION,function(b,c,d){a.inventoryLine.selectedServices[a.service.ticker].updated=!1,j(c,d,!0)}),a.inventoryLine.selectedServices.hasOwnProperty(a.service.ticker)||(a.inventoryLine.selectedServices[a.service.ticker]={selected:!1}),a.reservation.selectedServices&&a.reservation.selectedServices.hasOwnProperty(a.service.ticker)&&(a.inventoryLine.selectedServices[a.service.ticker].selected=a.reservation.selectedServices[a.service.ticker].selected),1==a.service.obligatory&&(a.inventoryLine.selectedServices[a.service.ticker]={selected:!0});var j=function(b,c,h){if(c==b&&0==a.service.obligatory)return void(a.rate=null==a.rate?0:a.rate);a.selectedMultiplier=a.inventoryLine.selectedServices[a.service.ticker].selected?1:0,a.isSelected=a.inventoryLine.selectedServices[a.service.ticker].selected;var j=e.calculateServiceRate(a.service,a.reservation.inventoryLine.capacity,a.reservation.quantity,0,i,d);j=a.isSelected?j:-j,a.rate=a.isSelected?j:0,f.$broadcast(g.UPDATE_SERVICE_RATE,{reservation:a.reservation,amount:j}),(!a.inventoryLine.selectedServices[a.service.ticker].updated||h)&&c!=b&&a.updateReservation(a.reservation,a.service)};a.inventoryLine.selectedServices[a.service.ticker].updated=!0,a.isSelected=a.inventoryLine.selectedServices[a.service.ticker].selected,a.isSelected?a.rate=e.calculateServiceRate(a.service,a.reservation.inventoryLine.capacity,a.reservation.quantity,0,i,d):a.rate=0,f.servicesProcessed.hasOwnProperty([a.reservation.id+a.service.ticker])||a.$broadcast(g.UPDATE_SERVICE_SELECTION,a.inventoryLine.selectedServices[a.service.ticker].selected,!1),f.servicesProcessed[a.reservation.id+a.service.ticker]={processed:!0}}a.dailyMultiplier=a.service.daily?i:1,a.openInfo=function(b){a.info=b,a.currency=f.witbookerParams.representation.currency;var c=["$scope","$modalInstance",function(a,b){a.closeInfo=function(){b.close()}}];h.open({templateUrl:d.assetsDir+"partials/step_one/misc/cartInfo.html",controller:c,scope:a})}},templateUrl:d.assetsDir+"partials/step_two/service_row.html"}}]).directive("witbookingFooter",["$compile","$http","$templateCache","constants","util","$rootScope","events",function(a,b,c,d,e,f,g){return{scope:{establishment:"=",witbookerParams:"="},link:function(a,b){var c=new Date;a.year=c.getFullYear(),a.releaseVersion=f.witbookerParams.representation.releaseVersion,a.iframeMode=f.witbookerParams.representation.iframeMode,a.showPromoCodeInputOnIframeMode=f.witbookerParams.representation.showPromoCodeInputOnIframeMode,a.$on(g.CHANGE_LANGUAGE,function(a,b,c){jQuery("#cookie-bar").remove(),jQuery.witCookiesLaw({language:f.witbookerParams.representation.language.code,url:{es:"/WitBooker/booking/cookies/cookie_es?ticker="+f.witbookerParams.representation.ticker,en:"/WitBooker/booking/cookies/cookie_en?ticker="+f.witbookerParams.representation.ticker}})}),jQuery("#cookie-bar").remove(),jQuery.witCookiesLaw({language:"undefined"!=typeof f.witbookerParams.representation.language.code?f.witbookerParams.representation.language.code:"es",url:{es:"/WitBooker/booking/cookies/cookie_es?ticker="+f.witbookerParams.representation.ticker,en:"/WitBooker/booking/cookies/cookie_en?ticker="+f.witbookerParams.representation.ticker}})},templateUrl:d.assetsDir+"partials/step_one/footer.html"}}]).directive("witbookingIframePromoCode",["constants","util","$rootScope","events",function(a,b,c,d){return{scope:{},link:function(a){a.iframePromoCode="",a.queryAvailability=function(){b.setGetParameter("promotionalcode",a.iframePromoCode)}},template:'<div class="input-group iframePromoCodeGroup" ><input type="text" class="form-control" ng-model="iframePromoCode"  placeholder="{{\'trans.promoCode\'|translate}}" ><span class="input-group-btn"><button class="btn btn-default" type="button" style="height: 34px" translate ng-click="queryAvailability()">trans.step2.validate</button></span></div>'}}]).directive("witbookingTrackingPixels",["constants","util","$rootScope","events",function(a,b,c,d){return{scope:{},link:function(a){a.isTripAdvisorActive="TripAdvisor"==c.witbookerParams.representation.channel?!0:!1},templateUrl:a.assetsDir+"partials/step_one/misc/tracking_pixels.html"}}]).directive("witbookingCustomerDataForm",["$compile","$http","$templateCache","constants","util","$rootScope",function(a,b,c,d,e,f){return{scope:{errorMessage:"=",customerData:"=",establishment:"=",form:"="},link:function(a,b){a.inventoryLinePaymentType=d.payment.type.creditCardOrTransfer,a.bookingFormCountry=f.witbookerParams.representation.bookingFormCountry,a.bookingFormPhone=f.witbookerParams.representation.bookingFormPhone,a.bookingFormDni=f.witbookerParams.representation.bookingFormDni,a.bookingFormAddress=f.witbookerParams.representation.bookingFormAddress,a.bookingFormRepeatEmail=f.witbookerParams.representation.bookingFormRepeatEmail,a.bookingFormArrivalTime=f.witbookerParams.representation.bookingFormArrivalTime,a.bookingFormNewsletter=f.witbookerParams.representation.bookingFormNewsletter,a.establishment=f.establishment,a.constants=d,a.countries=f.witbookerParams.representation.countries},templateUrl:d.assetsDir+"partials/step_two/customer_data_form.html"}}]).directive("witbookingPaymentDataForm",["$compile","$http","$templateCache","constants","util","$rootScope","events","$modal",function(a,b,c,d,e,f,g,h){return{scope:{errorMessage:"=",paymentData:"=",reservations:"=",establishment:"=",form:"="},link:function(a,b){a.establishment=f.establishment,a.constants=d,a.ptype,a.util=e;var c=function(b,c){a.goToStepOne=function(){f.$broadcast(g.GO_TO_STEP1,{establishment:f.establishment.ticker})};var d={};angular.forEach(a.reservations,function(a,b){if(0==b)angular.forEach(a.inventoryLine.condition.paymentTypes,function(a,b){d.hasOwnProperty(a.ticker)||(d[a.ticker]=[]),d[a.ticker].push(a)});else for(var c in d){var e=!1;angular.forEach(a.inventoryLine.condition.paymentTypes,function(a,b){c==a.ticker&&(d[a.ticker].push(a),e=!0)}),e||delete d[c]}}),a.availablePaymentTypes=[];for(var e in d)a.ptype||(a.ptype=e),a.availablePaymentTypes.push(e)},i=(f.$on(g.RESERVATION_DATA_UPDATE,c),f.$watch(function(){return a.reservations.length},c));a.$on("$destroy",function(){i()}),a.depositPercentage=0,a.depositAmount=0;var j=function(b){a.depositAmount=0,angular.forEach(a.reservations,function(c,d){var e=0;angular.forEach(c.inventoryLine.condition.paymentTypes,function(d,f){if(d.ticker==b){var g=c.serviceRate?c.serviceRate:0,h=c.inventoryLine.condition.earlyCharge&&c.inventoryLine.condition.earlyCharge>0?0:d.paymentPercentage/100*(g+c.rate),i=g+c.rate,j=c.inventoryLine.condition.payFirstNight&&c.inventoryLine.firstNightCost>0?c.inventoryLine.firstNightCost:0,k=c.inventoryLine.condition.earlyCharge&&c.inventoryLine.condition.earlyCharge>0?c.inventoryLine.condition.earlyCharge/100*i:0,l=c.inventoryLine.condition.minimumCharge&&c.inventoryLine.condition.minimumCharge>0&&c.inventoryLine.condition.minimumCharge<i?c.inventoryLine.condition.minimumCharge:0;e=Math.max(j,k,l),e=e>0?e:h,e*=c.quantity,a.depositAmount+=e}})})},k=f.$watch("cart.total",function(b,c){j(a.ptype),a.depositPercentage=a.depositAmount/f.cart.total*100,f.cart.depositPercentage=a.depositPercentage,f.cart.depositAmount=a.depositAmount});a.$on("$destroy",function(){k()}),a.$watch("ptype",function(b,c){b!==c&&(j(b),a.depositPercentage=a.depositAmount/f.cart.total*100,f.cart.depositPercentage=a.depositPercentage,f.cart.depositAmount=a.depositAmount)}),a.openInfo=function(){a.conditions={},angular.forEach(a.reservations,function(b,c){angular.forEach(b.inventoryLine.condition,function(c,d){"undefined"==typeof a.conditions[b.inventoryLine.condition.ticker]&&(a.conditions[b.inventoryLine.condition.ticker]=b.inventoryLine.condition)})});var b=["$scope","$modalInstance",function(a,b){a.closeInfo=function(){b.close()}}];a.isAdditionalInfoVisible=!1,a.toggleAdditionalInfo=function(){a.isAdditionalInfoVisible=!a.isAdditionalInfoVisible};h.open({templateUrl:d.assetsDir+"partials/step_one/misc/conditionsModal.html",controller:b,scope:a})},a.cart=f.cart,a.inventoryLinePaymentType=a.ptype,a.submitPaymentDataForm=function(){f.$broadcast(g.SUBMIT_PAYMENT_DATA_FORM,{paymentType:a.ptype})},a.witbookerParams=f.witbookerParams},templateUrl:d.assetsDir+"partials/step_two/payment_data_form.html"}}]).directive("witbookingPaymentTypeForm",["$compile","$http","$templateCache","constants","util","$rootScope","$sce",function(a,b,c,d,e,f,g){return{scope:{type:"=",paymentData:"=",form:"="},link:function(a,b){a.constants=d;for(var c=11,e=[],h=[],i=new Date,j=1;c>j;j++){var k=i.getFullYear().toString().substr(2,2);e.push({id:j,Value:k,Name:k}),i.setFullYear(i.getFullYear()+1)}a.years=e;for(var j=1;13>j;j++){var k=9>=j?"0"+j.toString():j.toString();h.push({Id:j,Value:k,Name:k})}a.months=h,a.creditCards=f.establishment.creditCardsAllowed;var l={Visa:/^4[0-9]{12}(?:[0-9]{3})?$/,Mastercard:/^5[1-5][0-9]{14}$/,American_Express:/^3[47][0-9]{13}$/,Carte_Bleu:/^[0-9]*$/,Diners:/^3(?:0[0-5]|[68][0-9])[0-9]{11}$/,JCB:/^(?:2131|1800|35\\d{3})\\d{11}$/};a.ccPattern=l[a.creditCards[0].id],a.changePattern=function(b){a.ccPattern=l[b.id],a.form.numbercard.$setViewValue(a.form.numbercard.$viewValue)},a.bookingFormCcv=f.witbookerParams.representation.bookingFormCcv,a.paymentData.creditCardData.cckind=a.creditCards[0],f.establishment.transferData&&(a.transferData=f.establishment.transferData),a.witbookerParams=f.witbookerParams;var m=f.$watch("sipayIframe",function(b,c){b&&(a.sipayIframe=g.trustAsResourceUrl(f.sipayIframe))});a.$on("$destroy",function(){m()})},templateUrl:d.assetsDir+"partials/step_two/payment/payment_type_form.html"}}]).directive("witbookingPaymentTypeHeader",["$compile","$http","$templateCache","constants","util","$rootScope",function(a,b,c,d,e,f){return{scope:{type:"="},link:function(a,b){a.constants=d},templateUrl:d.assetsDir+"partials/step_two/payment/payment_type_header.html"}}]),function(a){a.cookieBar=function(b,c){if("cookies"==b)var d="cookies";else if("set"==b)var d="set";else var d=!1;var e={message:"We use cookies to track usage and preferences.",acceptButton:!0,acceptText:"I Understand",declineButton:!1,declineText:"Disable Cookies",policyButton:!1,policyText:"Privacy Policy",policyURL:"/privacy-policy/",autoEnable:!0,expireDays:365,forceShow:!1,effect:"slide",element:"body",append:!1,fixed:!1,zindex:"",redirect:String(window.location.href),domain:String(window.location.hostname)},b=a.extend(e,b),f=new Date;f.setTime(f.getTime()+24*b.expireDays*60*60*1e3),f=f.toGMTString();var g,h,i="cb-enabled={value}; expires="+f+"; path=/",j="",k=document.cookie.split("; ");for(g=0;g<k.length;g++)h=k[g].split("="),"cb-enabled"==h[0]&&(j=h[1]);if(""==j&&b.autoEnable&&(j="enabled",document.cookie=i.replace("{value}","enabled")),"cookies"==d)return"enabled"==j||"accepted"==j?!0:!1;if("set"==d&&("accepted"==c||"declined"==c))return document.cookie=i.replace("{value}",c),"accepted"==c?!0:!1;var l=b.message.replace("{policy_url}",b.policyURL);if(b.acceptButton)var m='<a href="" class="cb-enable">'+b.acceptText+"</a>";else var m="";if(b.declineButton)var n='<a href="" class="cb-disable">'+b.declineText+"</a>";else var n="";if(b.policyButton)var o='<a href="'+b.policyURL+'" target="_blanck" class="cb-policy">'+b.policyText+"</a>";else var o="";if(b.fixed)var p=' class="fixed"';else var p="";if(""!=b.zindex)var q=' style="z-index:'+b.zindex+';"';else var q="";(b.forceShow||"enabled"==j||""==j)&&(b.append?a(b.element).append('<div id="cookie-bar"'+p+q+"><p>"+l+m+n+o+"</p></div>"):a(b.element).prepend('<div id="cookie-bar"'+p+q+"><p>"+l+m+n+o+"</p></div>")),a("#cookie-bar .cb-enable").click(function(){return document.cookie=i.replace("{value}","accepted"),"enabled"==j||"accepted"==j?("slide"==b.effect?a("#cookie-bar").slideUp(300,function(){a("#cookie-bar").remove()}):"fade"==b.effect?a("#cookie-bar").fadeOut(300,function(){a("#cookie-bar").remove()}):a("#cookie-bar").hide(0,function(){a("#cookie-bar").remove()}),!1):void(window.location=b.currentLocation)}),a("#cookie-bar .cb-disable").click(function(){var c=new Date;for(c.setTime(c.getTime()-864e6),c=c.toGMTString(),k=document.cookie.split("; "),g=0;g<k.length;g++)h=k[g].split("="),h[0].indexOf("_")>=0?document.cookie=h[0]+"=0; expires="+c+"; domain="+b.domain.replace("www","")+"; path=/":document.cookie=h[0]+"=0; expires="+c+"; path=/";return document.cookie=i.replace("{value}","declined"),"enabled"!=j||"accepted"==j?("slide"==b.effect?a("#cookie-bar").slideUp(300,function(){a("#cookie-bar").remove()}):"fade"==b.effect?a("#cookie-bar").fadeOut(300,function(){a("#cookie-bar").remove()}):a("#cookie-bar").hide(0,function(){a("#cookie-bar").remove()}),!1):void(window.location=b.currentLocation)})}}(jQuery),function(a){a.witCookiesLaw=function(b){var c={language:"es",effect:"fade",expireDays:365,policyButton:!0,mensajeTxt:"Las cookies nos permiten ofrecer nuestros servicios. Al utilizar nuestros servicios, aceptas el uso que hacemos de las cookies.",aceptarTxt:"Aceptar",masInfoTxt:"Más información",urlDefault:b.url.en},b=a.extend(c,b),d=b.urlDefault;switch(b.language){case"es":"undefined"!=typeof b.url.es&&(d=b.url.es);break;case"en":b.mensajeTxt="Cookies help us deliver our services. By using our services, you agree to our use of cookies.",b.aceptarTxt="Ok",b.masInfoTxt="Learn more";break;case"it":b.mensajeTxt="I cookie ci aiutano a fornire i nostri servizi. Utilizzando tali servizi, accetti l'utilizzo dei cookie.",b.aceptarTxt="Ok",b.masInfoTxt="Ulteriori informazioni","undefined"!=typeof b.url.it&&(d=b.url.it);break;case"fr":b.mensajeTxt="Les cookies assurent le bon fonctionnement de nos services. En utilisant ces derniers, vous acceptez l'utilisation des cookies.",b.aceptarTxt="Ok",b.masInfoTxt="En savoir plus",
"undefined"!=typeof b.url.fr&&(d=b.url.fr);break;case"ca":b.mensajeTxt="Les cookies ens permeten oferir els nostres serveis. En utilitzar els nostres serveis, acceptes l'ús que fem de les cookies.",b.aceptarTxt="Acceptar",b.masInfoTxt="Més informació","undefined"!=typeof b.url.fr&&(d=b.url.fr);break;case"de":b.mensajeTxt="Cookies helfen uns bei der Bereitstellung unserer Dienste. Durch die Nutzung unserer Dienste erklären Sie sich damit einverstanden, dass wir Cookies setzen.",b.aceptarTxt="Ok",b.masInfoTxt="Weitere Informationen","undefined"!=typeof b.url.de&&(d=b.url.de);break;case"nl":b.mensajeTxt="Cookies helpen ons bij het leveren van onze diensten. Door gebruik te maken van onze diensten, gaat u akkoord met ons gebruik van cookies.",b.aceptarTxt="Ok",b.masInfoTxt="Meer informatie","undefined"!=typeof b.url.nl&&(d=b.url.nl);break;case"ru":b.mensajeTxt="Печенье позволяют нам предлагать наши услуги. Пользуясь нашими услугами, Вы соглашаетесь с нашими использования куки.",b.aceptarTxt="Ok",b.masInfoTxt="Узнать больше","undefined"!=typeof b.url.ru&&(d=b.url.ru);break;case"pt":b.mensajeTxt="Os cookies ajudam-nos a oferecer os nossos serviços. Ao utilizar os nossos serviços, concorda com a nossa utilização de cookies.",b.aceptarTxt="Ok",b.masInfoTxt="Saiba mais","undefined"!=typeof b.url.pt&&(d=b.url.pt);break;default:b.mensajeTxt="Cookies help us deliver our services. By using our services, you agree to our use of cookies.",b.aceptarTxt="Ok",b.masInfoTxt="Learn more"}a.cookieBar({message:b.mensajeTxt,acceptText:b.aceptarTxt,policyButton:b.policyButton,policyText:b.masInfoTxt,policyURL:d,expireDays:b.expireDays,effect:b.effect})}}(jQuery),function(a,b){"object"==typeof exports?module.exports=b():"function"==typeof define&&define.amd?define(b):a.Spinner=b()}(this,function(){"use strict";function a(a,b){var c,d=document.createElement(a||"div");for(c in b)d[c]=b[c];return d}function b(a){for(var b=1,c=arguments.length;c>b;b++)a.appendChild(arguments[b]);return a}function c(a,b,c,d){var e=["opacity",b,~~(100*a),c,d].join("-"),f=.01+c/d*100,g=Math.max(1-(1-a)/b*(100-f),a),h=j.substring(0,j.indexOf("Animation")).toLowerCase(),i=h&&"-"+h+"-"||"";return l[e]||(m.insertRule("@"+i+"keyframes "+e+"{0%{opacity:"+g+"}"+f+"%{opacity:"+a+"}"+(f+.01)+"%{opacity:1}"+(f+b)%100+"%{opacity:"+a+"}100%{opacity:"+g+"}}",m.cssRules.length),l[e]=1),e}function d(a,b){var c,d,e=a.style;for(b=b.charAt(0).toUpperCase()+b.slice(1),d=0;d<k.length;d++)if(c=k[d]+b,void 0!==e[c])return c;return void 0!==e[b]?b:void 0}function e(a,b){for(var c in b)a.style[d(a,c)||c]=b[c];return a}function f(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)void 0===a[d]&&(a[d]=c[d])}return a}function g(a,b){return"string"==typeof a?a:a[b%a.length]}function h(a){this.opts=f(a||{},h.defaults,n)}function i(){function c(b,c){return a("<"+b+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',c)}m.addRule(".spin-vml","behavior:url(#default#VML)"),h.prototype.lines=function(a,d){function f(){return e(c("group",{coordsize:k+" "+k,coordorigin:-j+" "+-j}),{width:k,height:k})}function h(a,h,i){b(m,b(e(f(),{rotation:360/d.lines*a+"deg",left:~~h}),b(e(c("roundrect",{arcsize:d.corners}),{width:j,height:d.width,left:d.radius,top:-d.width>>1,filter:i}),c("fill",{color:g(d.color,a),opacity:d.opacity}),c("stroke",{opacity:0}))))}var i,j=d.length+d.width,k=2*j,l=2*-(d.width+d.length)+"px",m=e(f(),{position:"absolute",top:l,left:l});if(d.shadow)for(i=1;i<=d.lines;i++)h(i,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(i=1;i<=d.lines;i++)h(i);return b(a,m)},h.prototype.opacity=function(a,b,c,d){var e=a.firstChild;d=d.shadow&&d.lines||0,e&&b+d<e.childNodes.length&&(e=e.childNodes[b+d],e=e&&e.firstChild,e=e&&e.firstChild,e&&(e.opacity=c))}}var j,k=["webkit","Moz","ms","O"],l={},m=function(){var c=a("style",{type:"text/css"});return b(document.getElementsByTagName("head")[0],c),c.sheet||c.styleSheet}(),n={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",direction:1,speed:1,trail:100,opacity:.25,fps:20,zIndex:2e9,className:"spinner",top:"50%",left:"50%",position:"absolute"};h.defaults={},f(h.prototype,{spin:function(b){this.stop();var c=this,d=c.opts,f=c.el=e(a(0,{className:d.className}),{position:d.position,width:0,zIndex:d.zIndex});d.radius+d.length+d.width;if(e(f,{left:d.left,top:d.top}),b&&b.insertBefore(f,b.firstChild||null),f.setAttribute("role","progressbar"),c.lines(f,c.opts),!j){var g,h=0,i=(d.lines-1)*(1-d.direction)/2,k=d.fps,l=k/d.speed,m=(1-d.opacity)/(l*d.trail/100),n=l/d.lines;!function o(){h++;for(var a=0;a<d.lines;a++)g=Math.max(1-(h+(d.lines-a)*n)%l*m,d.opacity),c.opacity(f,a*d.direction+i,g,d);c.timeout=c.el&&setTimeout(o,~~(1e3/k))}()}return c},stop:function(){var a=this.el;return a&&(clearTimeout(this.timeout),a.parentNode&&a.parentNode.removeChild(a),this.el=void 0),this},lines:function(d,f){function h(b,c){return e(a(),{position:"absolute",width:f.length+f.width+"px",height:f.width+"px",background:b,boxShadow:c,transformOrigin:"left",transform:"rotate("+~~(360/f.lines*k+f.rotate)+"deg) translate("+f.radius+"px,0)",borderRadius:(f.corners*f.width>>1)+"px"})}for(var i,k=0,l=(f.lines-1)*(1-f.direction)/2;k<f.lines;k++)i=e(a(),{position:"absolute",top:1+~(f.width/2)+"px",transform:f.hwaccel?"translate3d(0,0,0)":"",opacity:f.opacity,animation:j&&c(f.opacity,f.trail,l+k*f.direction,f.lines)+" "+1/f.speed+"s linear infinite"}),f.shadow&&b(i,e(h("#000","0 0 4px #000"),{top:"2px"})),b(d,b(i,h(g(f.color,k),"0 0 1px rgba(0,0,0,.1)")));return d},opacity:function(a,b,c){b<a.childNodes.length&&(a.childNodes[b].style.opacity=c)}});var o=e(a("group"),{behavior:"url(#default#VML)"});return!d(o,"transform")&&o.adj?i():j=d(o,"animation"),h}),angular.module("ngCacheBuster",[]).config(["$httpProvider",function(a){return a.interceptors.push("httpRequestInterceptorCacheBuster")}]).provider("httpRequestInterceptorCacheBuster",function(){this.matchlist=[/.*partials.*/,/.*views.*/],this.logRequests=!1,this.black=!1,this.setMatchlist=function(a,b){this.black="undefined"!=typeof b?b:!1,this.matchlist=a},this.setLogRequests=function(a){this.logRequests=a},this.$get=["$q","$log",function(a,b){var c=this.matchlist,d=this.logRequests,e=this.black;return d&&b.log("Blacklist? ",e),{request:function(f){for(var g=!e,h=0;h<c.length;h++)if(f.url.match(c[h])){g=e;break}if(g){var i=new Date;f.url=f.url.replace(/[?|&]cacheBuster=\d+/,""),f.url+=-1===f.url.indexOf("?")?"?":"&",f.url+="cacheBuster="+i.getTime()}if(d){var j="request.url ="+f.url;g?b.warn(j):b.info(j)}return f||a.when(f)}}}]});